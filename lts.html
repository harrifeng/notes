<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-03-27 Thu 10:58 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>lts</title>
<meta name="author" content="harrifeng@outlook.com" />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="src/readtheorg_theme/css/readtheorg.css"/>
<script type="text/javascript" src="src/lib/js/jquery.min.js"></script>
<script type="text/javascript" src="src/lib/js/bootstrap.min.js"></script>
<script type="text/javascript" src="src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="src/readtheorg_theme/js/readtheorg.js"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">lts</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgd18478a">1. Chapter 1: From JavaScript to TypeScript</a>
<ul>
<li><a href="#org232e99d">1.1. History of JavaScript</a></li>
<li><a href="#orgd8986d5">1.2. Vanilla JavaScript's Pitfalls</a>
<ul>
<li><a href="#orgaae8232">1.2.1. Costly Freedom</a></li>
<li><a href="#orgd26559b">1.2.2. Losse Documentation</a></li>
<li><a href="#orgdc0fbda">1.2.3. Weaker Developer Tooling</a></li>
</ul>
</li>
<li><a href="#org11a82a7">1.3. Typescript!</a></li>
<li><a href="#org4c0f737">1.4. Getting Started in the TypeScript Playground</a>
<ul>
<li><a href="#orgc63e706">1.4.1. TypeScript in Action</a></li>
<li><a href="#org808ca24">1.4.2. Freedom Through Restriction</a></li>
<li><a href="#org1c8e8af">1.4.3. Precise Documentation</a></li>
<li><a href="#org8d5b433">1.4.4. Stronger Developer Tooling</a></li>
<li><a href="#org8305851">1.4.5. Compiling Syntax</a></li>
</ul>
</li>
<li><a href="#orgdd429e3">1.5. Getting Started Locally</a>
<ul>
<li><a href="#org2c69159">1.5.1. Running Locally</a></li>
<li><a href="#orga83325b">1.5.2. Editor Features</a></li>
</ul>
</li>
<li><a href="#org30d913a">1.6. What TypeScript is Not</a>
<ul>
<li><a href="#org99aa33b">1.6.1. A Remedy for Bad Code</a></li>
<li><a href="#org1850ef4">1.6.2. Extensions to JavaScript(Mostly)</a></li>
<li><a href="#orgd240324">1.6.3. SLower Than JavaScript</a></li>
<li><a href="#org6e2f265">1.6.4. Finished Evolving</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org6c41740">2. Chapter 2: The Type System</a>
<ul>
<li><a href="#orgf54d5a3">2.1. What's in a Type?</a>
<ul>
<li><a href="#orgf655f99">2.1.1. Type Systems</a></li>
<li><a href="#org651855f">2.1.2. Kinds of Errors</a></li>
</ul>
</li>
<li><a href="#org75d8a4f">2.2. Assignability</a>
<ul>
<li><a href="#org3989188">2.2.1. Understanding Assignability Errors</a></li>
</ul>
</li>
<li><a href="#org995dbe6">2.3. Type Annotations</a>
<ul>
<li><a href="#org0e92385">2.3.1. Unnecessary Type Annotaions</a></li>
</ul>
</li>
<li><a href="#org2057475">2.4. Type Shapes</a>
<ul>
<li><a href="#org5bd02d4">2.4.1. Modules</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orge4428b5">3. Chapter 3: Unions and Literals</a>
<ul>
<li><a href="#org704454c">3.1. Union Types</a>
<ul>
<li><a href="#org98d5094">3.1.1. Declaring Union Types</a></li>
<li><a href="#orgf5ba7e8">3.1.2. Union Preperties</a></li>
</ul>
</li>
<li><a href="#org1349f82">3.2. Narrowing</a>
<ul>
<li><a href="#org3e29043">3.2.1. Assignment Narrowing</a></li>
<li><a href="#org62141ad">3.2.2. Conditional Checks</a></li>
<li><a href="#orge24943e">3.2.3. Typeof Checks</a></li>
</ul>
</li>
<li><a href="#orgd66e898">3.3. Literal Types</a>
<ul>
<li><a href="#org0c8bd20">3.3.1. Literal Assignability</a></li>
</ul>
</li>
<li><a href="#org4d7094e">3.4. Strict Null Checking</a>
<ul>
<li><a href="#org5263d19">3.4.1. The Billion-Dollar Mistake</a></li>
<li><a href="#org3611fda">3.4.2. Truthiness Narrowing</a></li>
<li><a href="#org87df15e">3.4.3. Variables Without Initial Values</a></li>
</ul>
</li>
<li><a href="#orgae05808">3.5. Type Aliases</a>
<ul>
<li><a href="#orge5fe355">3.5.1. Type Aliases Are Not JavaScript</a></li>
<li><a href="#orgaacdd68">3.5.2. Combining Type Aliases</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org10467d1">4. Chapter 4: Objects</a>
<ul>
<li><a href="#org8bb2f5e">4.1. Object Types</a>
<ul>
<li><a href="#org975b89b">4.1.1. Declaring Object Types</a></li>
<li><a href="#org9126c28">4.1.2. Aliased Object Types</a></li>
</ul>
</li>
<li><a href="#orgcbf2e93">4.2. Structural Typing</a>
<ul>
<li><a href="#org2d0034b">4.2.1. Usage Checking</a></li>
<li><a href="#org7441f17">4.2.2. Excess Property Checking</a></li>
<li><a href="#org7aa72ec">4.2.3. Nested Object Types</a></li>
<li><a href="#org3b7999a">4.2.4. Optional Properties</a></li>
</ul>
</li>
<li><a href="#org69524be">4.3. Unions of Object Types</a>
<ul>
<li><a href="#org81409bc">4.3.1. Inferred Object-Type Unions</a></li>
<li><a href="#org1cc6ac3">4.3.2. Explicit Object-Type Unions</a></li>
<li><a href="#orgc9a85e0">4.3.3. Narrowing Object Types</a></li>
<li><a href="#orgad64fb1">4.3.4. Discriminated Unions</a></li>
</ul>
</li>
<li><a href="#orgc1706d2">4.4. Intersection Types</a>
<ul>
<li><a href="#org3cb2459">4.4.1. Dangers of Intersection Types</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org33f3dff">5. Chapter 5: Functions</a>
<ul>
<li><a href="#org1857d3e">5.1. Function Parameters</a>
<ul>
<li><a href="#orgc279c65">5.1.1. Required Parameters</a></li>
<li><a href="#org2df0ffd">5.1.2. Optional Parameters</a></li>
<li><a href="#org05974fc">5.1.3. Default Parameters</a></li>
<li><a href="#orgfd17a1f">5.1.4. Rest Parameters</a></li>
</ul>
</li>
<li><a href="#orge054fa0">5.2. Return Types</a>
<ul>
<li><a href="#org6ee3455">5.2.1. Explicit Return Types</a></li>
</ul>
</li>
<li><a href="#orgb982fba">5.3. Function Types</a>
<ul>
<li><a href="#org5acad59">5.3.1. Function Type Parentheses</a></li>
<li><a href="#org1ad536e">5.3.2. Parameter Type Inferences</a></li>
<li><a href="#orgdc717e4">5.3.3. Function Type Aliases</a></li>
</ul>
</li>
<li><a href="#org5d21c91">5.4. More Return Types</a>
<ul>
<li><a href="#org4670b4b">5.4.1. Void Returns</a></li>
<li><a href="#org639e7b5">5.4.2. Never Returns</a></li>
</ul>
</li>
<li><a href="#org8bf5b5e">5.5. Function Overloads</a>
<ul>
<li><a href="#orgb3f0bde">5.5.1. Call-Signature Compatibility</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orga912e60">6. Chapter 6: Arrays</a>
<ul>
<li><a href="#orgb44d4b4">6.1. Array Types</a>
<ul>
<li><a href="#org1109f5d">6.1.1. Array and Function Types</a></li>
<li><a href="#org8ab0817">6.1.2. Union Type Arrays</a></li>
<li><a href="#org49e43d8">6.1.3. Evolving Any Arrays</a></li>
<li><a href="#orgc425901">6.1.4. Multidimensional Arrays</a></li>
</ul>
</li>
<li><a href="#orgffcaf25">6.2. Array Members</a>
<ul>
<li><a href="#orgab669fd">6.2.1. Caveat: Unsound Members</a></li>
</ul>
</li>
<li><a href="#orgdbc408b">6.3. Spreads and Rests</a>
<ul>
<li><a href="#org8a39350">6.3.1. Spreads</a></li>
<li><a href="#orga18d930">6.3.2. Spreading Rest Parameters</a></li>
</ul>
</li>
<li><a href="#org1b2c9ee">6.4. Tuples</a>
<ul>
<li><a href="#orgd77a9f6">6.4.1. Tuple Assignability</a></li>
<li><a href="#org79b9985">6.4.2. Tuple Inferences</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org718e7b3">7. Chapter 7: Interfaces</a>
<ul>
<li><a href="#org4099eeb">7.1. Type Aliases Versus Intrfaces</a></li>
<li><a href="#org0f9270c">7.2. Type of Proprties</a>
<ul>
<li><a href="#org62ece3d">7.2.1. Optional Properties</a></li>
<li><a href="#orgf1ec6b3">7.2.2. Read-Only Properties</a></li>
<li><a href="#org1f97a98">7.2.3. Functions and Methods</a></li>
<li><a href="#org9a98dc8">7.2.4. Call Signatures</a></li>
<li><a href="#org10cf8fe">7.2.5. Index Signatures</a></li>
<li><a href="#orgee471d5">7.2.6. Nested Interfaces</a></li>
</ul>
</li>
<li><a href="#org8c36bad">7.3. Interface Extensions</a>
<ul>
<li><a href="#orgaf74dde">7.3.1. Overridden Properties</a></li>
<li><a href="#org9cdd0f4">7.3.2. Extending Multiple Interfaces</a></li>
</ul>
</li>
<li><a href="#org722a274">7.4. Interface Merging</a>
<ul>
<li><a href="#orgdd0e722">7.4.1. Member Naming Conflicts</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgd18478a" class="outline-2">
<h2 id="orgd18478a"><span class="section-number-2">1.</span> Chapter 1: From JavaScript to TypeScript</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org232e99d" class="outline-3">
<h3 id="org232e99d"><span class="section-number-3">1.1.</span> History of JavaScript</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>javascript是Brendan Eich在1995年用十天时间发明的语言,由于时间仓促,javascript有很多奇怪的地方</li>
<li>从2015年开始,javascript的规范化组织ECMAScript(因为javascript是火狐浏览器的商标),就每年发布新版本,并
且保证向前兼容</li>
</ul>
</div>
</div>
<div id="outline-container-orgd8986d5" class="outline-3">
<h3 id="orgd8986d5"><span class="section-number-3">1.2.</span> Vanilla JavaScript's Pitfalls</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>开发者把没有使用任何框架的javascript叫做vanilla(因为香草味是最常见的味道)</li>
<li>实际上很少有项目使用vanilla javascript,因为原生javascript的陷阱实在是太多了,这也是为什么Typescript会诞生的原因</li>
</ul>
</div>
<div id="outline-container-orgaae8232" class="outline-4">
<h4 id="orgaae8232"><span class="section-number-4">1.2.1.</span> Costly Freedom</h4>
<div class="outline-text-4" id="text-1-2-1">
<ul class="org-ul">
<li>javascript太过于自由了,导致有很多的问题.
<ul class="org-ul">
<li><p>
比如下面的代码:
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">paintPainting</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">painter</span>, <span style="color: #715ab1;">painting</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span> painter
    .prepare<span style="color: #6c3163;">()</span>
    .paint<span style="color: #6c3163;">(</span>painting, painter.ownMaterials<span style="color: #6c3163;">)</span>
    .finish<span style="color: #6c3163;">()</span>;
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
<li>由于不经过编译器确认,那么一旦paint()函数改名字了,那么代码毫无感觉,直到代码运行到这个地方</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgd26559b" class="outline-4">
<h4 id="orgd26559b"><span class="section-number-4">1.2.2.</span> Losse Documentation</h4>
<div class="outline-text-4" id="text-1-2-2">
<ul class="org-ul">
<li>由于是动态语言,所以维持js代码的文档是非常困难的,因为:
<ul class="org-ul">
<li>很有可能JSDoc是错误的,因为它和代码是分离的</li>
<li>即便我们JSDoc是正确的,但是随着代码的重构,我们要经常性的去更改那些now-invalid JSDoc,这个是非常困难
也复杂的</li>
<li>描述复杂的对象会非常的复杂</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgdc0fbda" class="outline-4">
<h4 id="orgdc0fbda"><span class="section-number-4">1.2.3.</span> Weaker Developer Tooling</h4>
<div class="outline-text-4" id="text-1-2-3">
<ul class="org-ul">
<li>Js作为动态语言,天然的没有太多开发者支持工具,比如重命名成员和跳转到定义等</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org11a82a7" class="outline-3">
<h3 id="org11a82a7"><span class="section-number-3">1.3.</span> Typescript!</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>Typescript由C#,Pascal语言的作者 Anders Hejlsberg在2010年发明,并在2012年开源</li>
<li>我们可以把Typescript看成是如下四个东西:
<ul class="org-ul">
<li>programming language: 一个包含所有Js的syntax的语言,外加新的TypeScript-specific syntax用来定义和使用type</li>
<li>Type checker: 还可以把ts看成是一个程序,用来检查输入的js和ts代码是否正确</li>
<li>Compiler: 还可以把ts卡成是一个编译器,用来把ts代码编译成js代码</li>
<li>Language service: 还可以把ts看成是一个服务,提供给编辑器(比如vs code)来帮助开发者开发代码</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org4c0f737" class="outline-3">
<h3 id="org4c0f737"><span class="section-number-3">1.4.</span> Getting Started in the TypeScript Playground</h3>
<div class="outline-text-3" id="text-1-4">
<ul class="org-ul">
<li>TypeScript主页包含了一个在线的编辑器,叫TypeScript Playground,地址如下 <a href="https://www.typescriptlang.org/play">https://www.typescriptlang.org/play</a></li>
</ul>
</div>
<div id="outline-container-orgc63e706" class="outline-4">
<h4 id="orgc63e706"><span class="section-number-4">1.4.1.</span> TypeScript in Action</h4>
<div class="outline-text-4" id="text-1-4-1">
<ul class="org-ul">
<li><p>
我们先来看看一个代码片段
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">firstName</span> = <span style="color: #2d9574;">"Georgia"</span>;
<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">nameLangth</span> = firstName.length<span style="color: #3a81c3;">()</span>;
</pre>
</div></li>
<li>这段如果是js代码的话,在运行时会爆出问题,因为字符串没有length()函数</li>
<li><p>
我们把这段代码贴到Typescript Playground,我们会发现,ts作为language service会帮我们分析到
</p>
<pre class="example" id="orgd4d2032">
This expression is not callable.
  Type 'Number' has no call signatures. ts(2349)
</pre></li>
<li>在代码书写阶段就得到警告,好过运行的时候整个程序崩溃</li>
</ul>
</div>
</div>
<div id="outline-container-org808ca24" class="outline-4">
<h4 id="org808ca24"><span class="section-number-4">1.4.2.</span> Freedom Through Restriction</h4>
<div class="outline-text-4" id="text-1-4-2">
<ul class="org-ul">
<li>ts允许我们选定参数和变量能够使用的类型</li>
<li>ts还允许我们在函数的定义改变的时候,做出告警</li>
</ul>
</div>
</div>
<div id="outline-container-org1c8e8af" class="outline-4">
<h4 id="org1c8e8af"><span class="section-number-4">1.4.3.</span> Precise Documentation</h4>
<div class="outline-text-4" id="text-1-4-3">
<ul class="org-ul">
<li><p>
我们来看看ts版本的paintPainting,即便我们还没引入ts的内容,但是你也可以看出这就是代码本身就是documentation的范本
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">Painter</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #6c3163; font-weight: bold;">finish</span><span style="color: #6c3163;">()</span>: <span style="color: #3a81c3; font-weight: bold;">boolean</span>;
  ownMaterials: <span style="color: #ba2f59; font-weight: bold;">Material</span><span style="color: #6c3163;">[]</span>;
  <span style="color: #6c3163; font-weight: bold;">paint</span><span style="color: #6c3163;">(</span><span style="color: #715ab1;">painting</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>, <span style="color: #715ab1;">materials</span>: <span style="color: #ba2f59; font-weight: bold;">Material</span><span style="color: #2d9574;">[]</span><span style="color: #6c3163;">)</span>: <span style="color: #3a81c3; font-weight: bold;">boolean</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">paintPainting</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">painter</span>: <span style="color: #ba2f59; font-weight: bold;">Painter</span>, <span style="color: #715ab1;">painting</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span>: <span style="color: #3a81c3; font-weight: bold;">boolean</span><span style="color: #3a81c3;">{</span><span style="color: #2aa1ae; background-color: #ecf3ec;">/* </span><span style="color: #2aa1ae; background-color: #ecf3ec;">... */</span><span style="color: #3a81c3;">}</span>
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-org8d5b433" class="outline-4">
<h4 id="org8d5b433"><span class="section-number-4">1.4.4.</span> Stronger Developer Tooling</h4>
<div class="outline-text-4" id="text-1-4-4">
<ul class="org-ul">
<li>Typescript 自己就能为vs code 提供自动补全等功能</li>
</ul>
</div>
</div>
<div id="outline-container-org8305851" class="outline-4">
<h4 id="org8305851"><span class="section-number-4">1.4.5.</span> Compiling Syntax</h4>
<div class="outline-text-4" id="text-1-4-5">
<ul class="org-ul">
<li>Typescript不仅能把ts编译成js,还能把新版本的js编译成老版本的js</li>
<li>我们可以在Typescript playground页面的右侧看到编译好的js代码</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgdd429e3" class="outline-3">
<h3 id="orgdd429e3"><span class="section-number-3">1.5.</span> Getting Started Locally</h3>
<div class="outline-text-3" id="text-1-5">
<ul class="org-ul">
<li><p>
typescript是作为nodejs的一个module被安装的,如果要本地使用,记得全局安装
</p>
<div class="org-src-container">
<pre class="src src-shell">npm i -g typescript
</pre>
</div></li>
<li><p>
一旦全局安装typescript module成功之后,会有一个tsc的命令放在path
</p>
<div class="org-src-container">
<pre class="src src-shell">$ tsc --version
Version 5.0.4
</pre>
</div></li>
</ul>
</div>
<div id="outline-container-org2c69159" class="outline-4">
<h4 id="org2c69159"><span class="section-number-4">1.5.1.</span> Running Locally</h4>
<div class="outline-text-4" id="text-1-5-1">
<ul class="org-ul">
<li><p>
在一个空白的文件夹下面运行如下命令,就能在root目录创建一个新的tsconfig.json配置文件
</p>
<div class="org-src-container">
<pre class="src src-shell">$ tsc --init

Created a new tsconfig.json with:
                                                                                                              TS
  target: es2016
  module: commonjs
  strict: true
  esModuleInterop: true
  skipLibCheck: true
  forceConsistentCasingInFileNames: true


You can learn more at https://aka.ms/tsconfig
$ ls -al .
total 24
drwxr-xr-x   3 fenghaoran  staff     96 May  8 17:58 .
drwxr-xr-x  23 fenghaoran  staff    736 May  8 17:58 ..
-rw-r--r--   1 fenghaoran  staff  12288 May  8 17:58 tsconfig.json
</pre>
</div></li>
<li><p>
我们在这个文件夹里面创建一个文件index.ts并且添加如下文本
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">blub</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Nothing is worth more than laughter."</span><span style="color: #3a81c3;">)</span>;
</pre>
</div></li>
<li><p>
我们如果使用tsc编译的话,会出现如下错误
</p>
<div class="org-src-container">
<pre class="src src-shell">$ tsc index.ts
index.ts:1:9 - error TS2339: Property <span style="color: #2d9574;">'blub'</span> does not exist on type <span style="color: #2d9574;">'Console'</span>.

1 console.blub<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Nothing is worth more than laughter."</span><span style="color: #3a81c3;">)</span>;
          ~~~~


Found 1 error<span style="color: #3a81c3; font-weight: bold;"> in</span> index.ts:1
</pre>
</div></li>
<li><p>
虽然你的写法tsc认为有问题,但是它还是给你创建了一个新的index.js文件
</p>
<div class="org-src-container">
<pre class="src src-shell">$ cat index.js
<span style="color: #6c3163; font-weight: bold;">console.blub</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Nothing is worth more than laughter."</span><span style="color: #3a81c3;">)</span>;
</pre>
</div></li>
<li>从这里看tsc的编译和我们之前理解的gcc等还是有差别的.</li>
<li><p>
我们更改错误之后,编译就不会有问题了,而且会产生新的正确的js代码
</p>
<div class="org-src-container">
<pre class="src src-shell">$ cat index.ts
<span style="color: #6c3163; font-weight: bold;">console.log</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Nothing is worth more than laughter."</span><span style="color: #3a81c3;">)</span>;
$ tsc index.ts
$ cat index.js
<span style="color: #6c3163; font-weight: bold;">console.log</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Nothing is worth more than laughter."</span><span style="color: #3a81c3;">)</span>;
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-orga83325b" class="outline-4">
<h4 id="orga83325b"><span class="section-number-4">1.5.2.</span> Editor Features</h4>
<div class="outline-text-4" id="text-1-5-2">
<ul class="org-ul">
<li>tsconfig.json配置文件的巨大作用,在于让vs code(或者其他编辑器,IDE)能够识别出ts project root folder</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org30d913a" class="outline-3">
<h3 id="org30d913a"><span class="section-number-3">1.6.</span> What TypeScript is Not</h3>
<div class="outline-text-3" id="text-1-6">
<ul class="org-ul">
<li>每个工具都有其优点,也有其局限性. ts的局限性总计起来就是</li>
</ul>
</div>
<div id="outline-container-org99aa33b" class="outline-4">
<h4 id="org99aa33b"><span class="section-number-4">1.6.1.</span> A Remedy for Bad Code</h4>
<div class="outline-text-4" id="text-1-6-1">
<ul class="org-ul">
<li>ts只会enforce type safety,它不会强制你使用任何的structure(比如class等)</li>
</ul>
</div>
</div>
<div id="outline-container-org1850ef4" class="outline-4">
<h4 id="org1850ef4"><span class="section-number-4">1.6.2.</span> Extensions to JavaScript(Mostly)</h4>
<div class="outline-text-4" id="text-1-6-2">
<ul class="org-ul">
<li>ts的设计目标说,it should:
<ul class="org-ul">
<li>遵守当前的,以及未来的ECMAScript proposal</li>
<li>能够适配所有js的runtime(比如老版本的IE11)</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgd240324" class="outline-4">
<h4 id="orgd240324"><span class="section-number-4">1.6.3.</span> SLower Than JavaScript</h4>
<div class="outline-text-4" id="text-1-6-3">
<ul class="org-ul">
<li>关于ts比js慢的观点,是不准确,而且有诱导性的,因为ts慢是因为它首先要转成js,而且编译的时候有类型检查</li>
</ul>
</div>
</div>
<div id="outline-container-org6e2f265" class="outline-4">
<h4 id="org6e2f265"><span class="section-number-4">1.6.4.</span> Finished Evolving</h4>
<div class="outline-text-4" id="text-1-6-4">
<ul class="org-ul">
<li>随着web的继续发展,ts也会不断演进</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org6c41740" class="outline-2">
<h2 id="org6c41740"><span class="section-number-2">2.</span> Chapter 2: The Type System</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgf54d5a3" class="outline-3">
<h3 id="orgf54d5a3"><span class="section-number-3">2.1.</span> What's in a Type?</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>所谓的shape,是指有哪些property和method在一个value上,也可以理解为内置的typeof操作符对这个value的解释</li>
<li><p>
比如下面的js代码,如果给ts来理解,它肯定能知道singer是一个string type的变量
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">singer</span> = <span style="color: #2d9574;">"Aretha"</span>
</pre>
</div></li>
<li>js中有如下七中原生类型,ts也同样视他们为原生类型:
<ul class="org-ul">
<li>null</li>
<li>undefined</li>
<li>boolean</li>
<li>string</li>
<li>number</li>
<li>bigint</li>
<li>symbol</li>
</ul></li>
</ul>
</div>
<div id="outline-container-orgf655f99" class="outline-4">
<h4 id="orgf655f99"><span class="section-number-4">2.1.1.</span> Type Systems</h4>
<div class="outline-text-4" id="text-2-1-1">
<ul class="org-ul">
<li>TypeScript的type system总体上是安装如下流程工作的:
<ul class="org-ul">
<li>读取你的代码,理解代码中所有的type,和所有的value</li>
<li>对每个value,试着从其初始化的地方理解其可能有的类型</li>
<li>对每个value,看看在后续代码里面其使用的方式(有没有超过其类型所限)</li>
<li>如果value采用了不符合其类型的操作,反馈给用户</li>
</ul></li>
<li>我们以一个例子来介绍下上面的几步都是什么意思:
<ul class="org-ul">
<li><p>
代码如下
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">firstName</span> = <span style="color: #2d9574;">"Whiteney"</span>;
firstName.length<span style="color: #3a81c3;">()</span>;
<span style="color: #2aa1ae; background-color: #ecf3ec;">//        </span><span style="color: #2aa1ae; background-color: #ecf3ec;">~~~~~~</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//  </span><span style="color: #2aa1ae; background-color: #ecf3ec;">This expression is not callable.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//    </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type 'Number' has no call signatures</span>
</pre>
</div></li>
<li>ts能够得到上面的报警,是依次通过如下步骤获得的:
<ol class="org-ol">
<li>读取代码,并且理解了代码里面有个变量叫做firstName</li>
<li>总结出来firstName是string类型的,因为它的初始化值为"Whitney"</li>
<li>发现代码会去让firstName去调用.length这个method</li>
<li>终于得到机会进行警告: .length是一个member,而不是一个函数</li>
</ol></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org651855f" class="outline-4">
<h4 id="org651855f"><span class="section-number-4">2.1.2.</span> Kinds of Errors</h4>
<div class="outline-text-4" id="text-2-1-2">
<ul class="org-ul">
<li>在ts里面一般会遇到两种错误:
<ul class="org-ul">
<li>syntax error: 可以认为是严重错误,导致ts无法转换成js代码(虽然也会产生js代码,但是肯定是错误的,无法运行的)</li>
<li><p>
type error: 可以认为是普通告警,syntax error不存在的情况下(所以ts成功转换成了js代码),但是ts 编译器
认为你的代码可能出错.注意type error是说,从type类型的角度上讲,你是错误的.但是从动态语言的角度讲,
不一定是错误的.比如下面的代码,一个变量开始是字符类型,后来被赋值了true,在ts看来就是type error,但是js
看来,这是再正常不过的代码
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">lastName</span> = <span style="color: #2d9574;">"King"</span>;
lastName = <span style="color: #4e3163;">true</span>;
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org75d8a4f" class="outline-3">
<h3 id="org75d8a4f"><span class="section-number-3">2.2.</span> Assignability</h3>
<div class="outline-text-3" id="text-2-2">
<ul class="org-ul">
<li><p>
ts会读取变量的初始化值来判断其类型,如果后面赋值的时候类型一样还好,如果类型不一样,那么报警是跑不了
的了,而且报的就是Type error
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">lastName</span> = <span style="color: #2d9574;">"King"</span>;
lastName = <span style="color: #4e3163;">true</span>;
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Error: Type 'boolean' is not assignable to type 'string'.</span>
</pre>
</div></li>
</ul>
</div>
<div id="outline-container-org3989188" class="outline-4">
<h4 id="org3989188"><span class="section-number-4">2.2.1.</span> Understanding Assignability Errors</h4>
<div class="outline-text-4" id="text-2-2-1">
<ul class="org-ul">
<li>我们要试着理解Type Error报警:
<ul class="org-ul">
<li>比如 Type 'A' is not assignable to type 'B'</li>
<li>意思就是类型A无法赋值给类型B, 类型B是接受者(变量), 类型A是赋值者(新的类型)</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org995dbe6" class="outline-3">
<h3 id="org995dbe6"><span class="section-number-3">2.3.</span> Type Annotations</h3>
<div class="outline-text-3" id="text-2-3">
<ul class="org-ul">
<li>如果一个变量没有设置初始化的值,那么ts显然不能assume它的类型,这种情况下,ts认为这个变量的类型是any</li>
<li>any类型很奇怪:
<ul class="org-ul">
<li><p>
一个any类型的变量可以先后被赋值任何类型的数值.如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">rocker</span>;                     <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type: any</span>
rocker.<span style="color: #6c3163; font-weight: bold;">toUpperCase</span><span style="color: #3a81c3;">()</span>;

rocker = 19.58;
rocker.<span style="color: #6c3163; font-weight: bold;">toPrecision</span><span style="color: #3a81c3;">(</span>1<span style="color: #3a81c3;">)</span>;
</pre>
</div></li>
<li><p>
但是每次赋值相当于让当前变量处于某个类型,不过不能调用其他类型的method,如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">rocker</span>;                     <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type: any</span>
rocker.<span style="color: #6c3163; font-weight: bold;">toUpperCase</span><span style="color: #3a81c3;">()</span>;

rocker = 19.58;
rocker.<span style="color: #6c3163; font-weight: bold;">toPrecision</span><span style="color: #3a81c3;">(</span>1<span style="color: #3a81c3;">)</span>;

rocker.<span style="color: #6c3163; font-weight: bold;">toUpperCase</span><span style="color: #3a81c3;">()</span>;           <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error    2339   Property 'toUpperCase' does not exist on type 'number'. (typescript-</span><span style="color: #715ab1;">tide</span><span style="color: #2aa1ae; background-color: #ecf3ec;">)</span>

</pre>
</div></li>
</ul></li>
<li>使用any类型是不推荐的,因为它本质上是一种妥协,一旦设置了any, ts的很多类型检查就不再起作用了</li>
<li>如果没有初始化值,但是还想要设置类型怎么办? ts给出的解决方案是type annotation:
<ul class="org-ul">
<li><p>
type annotation的代码如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">rocker</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>;
rocker = <span style="color: #2d9574;">"Joan Jett"</span>;
</pre>
</div></li>
<li><p>
type annotation是ts的特有syntax, js无法理解. tsc会把上面的ts代码编译成如下的js代码
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #3a81c3; font-weight: bold;">var</span> <span style="color: #715ab1;">rocker</span>;
rocker = <span style="color: #2d9574;">"Joan Jett"</span>;
</pre>
</div></li>
</ul></li>
</ul>
</div>
<div id="outline-container-org0e92385" class="outline-4">
<h4 id="org0e92385"><span class="section-number-4">2.3.1.</span> Unnecessary Type Annotaions</h4>
<div class="outline-text-4" id="text-2-3-1">
<ul class="org-ul">
<li>只有在没有初始化值的情况下才需要type annotation,否则:
<ul class="org-ul">
<li>如果类型和初始化值一样,那么type annotation是多此一举</li>
<li>如果类型和初始化值不一样,那么还会报错</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org2057475" class="outline-3">
<h3 id="org2057475"><span class="section-number-3">2.4.</span> Type Shapes</h3>
<div class="outline-text-3" id="text-2-4">
<ul class="org-ul">
<li>typescript不仅仅能检查赋值的时候类型是否匹配,还会理解object的shape</li>
<li>所谓object的shape,就是object能够拥有哪些:
<ul class="org-ul">
<li>property</li>
<li>method</li>
</ul></li>
</ul>
</div>
<div id="outline-container-org5bd02d4" class="outline-4">
<h4 id="org5bd02d4"><span class="section-number-4">2.4.1.</span> Modules</h4>
<div class="outline-text-4" id="text-2-4-1">
<ul class="org-ul">
<li>js自己是没有包版本管理系统的,直到2015年ECMAScript添加了ECMAScript modules(ESM),标准化了如下两个命令:
<ul class="org-ul">
<li><p>
import: 用来从其他文件读取value
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #3a81c3; font-weight: bold;">import</span> <span style="color: #3a81c3;">{</span> value <span style="color: #3a81c3;">}</span> from <span style="color: #2d9574;">"./values"</span>;
</pre>
</div></li>
<li><p>
export: 用来把value导出到其他文件
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #3a81c3; font-weight: bold;">export</span> <span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">doubled</span> = value * 2;
</pre>
</div></li>
</ul></li>
<li>本书为了和ECAMScript规范相一致,会严格区分如下两个概念:
<ul class="org-ul">
<li>Module: 包含export或者import的文件</li>
<li>Script: 不是module的文件,都是script</li>
</ul></li>
<li>ts自然是能和Module以及Script都处理好关系的,这是最低要求</li>
<li>moduleA里面如果定义了一个变量, 并不会和moduleB里面定义的其他同名变量相conflict(例外情况是你非要从
moduleB里面import那肯定不行,比如下面的例子),这也是module的魅力
<ul class="org-ul">
<li><p>
两个module里面相同名字,没问题
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">a.ts</span>
<span style="color: #3a81c3; font-weight: bold;">export</span> <span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">shared</span> = <span style="color: #2d9574;">"Cher"</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">b.ts</span>
<span style="color: #3a81c3; font-weight: bold;">export</span> <span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">shared</span> = <span style="color: #2d9574;">"Cher"</span>;
</pre>
</div></li>
<li><p>
两个module里面相同名字,但是你要从另外一个module import,那么就会declaration conflicts啦
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">a.ts</span>
<span style="color: #3a81c3; font-weight: bold;">export</span> <span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">shared</span> = <span style="color: #2d9574;">"Cher"</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">c.ts</span>
<span style="color: #3a81c3; font-weight: bold;">import</span> <span style="color: #3a81c3;">{</span> shared <span style="color: #3a81c3;">}</span> <span style="color: #3a81c3; font-weight: bold;">from</span> <span style="color: #2d9574;">"./a"</span>;
<span style="color: #2aa1ae; background-color: #ecf3ec;">//       </span><span style="color: #2aa1ae; background-color: #ecf3ec;">~~~~~~</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Error: Import declaration conflicts with local declaration of 'shared'.</span>

<span style="color: #3a81c3; font-weight: bold;">export</span> <span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">shared</span> = <span style="color: #2d9574;">"Cher"</span>;
<span style="color: #2aa1ae; background-color: #ecf3ec;">//           </span><span style="color: #2aa1ae; background-color: #ecf3ec;">~~~~~~</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//  </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Error: Individual declarations in merged declaration</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//  </span><span style="color: #2aa1ae; background-color: #ecf3ec;">'shared' must b all exported or all local</span>
</pre>
</div></li>
</ul></li>
<li>在script里面,可以就不一样了,scriptA里面定义了一个变量,那么ts就认为他是全局的,同一个project下面的另
外一个scriptB文件就完全不能再定义同一个名字的变量了.
<ul class="org-ul">
<li><p>
例子如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">a.ts</span>
<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">shared</span> = <span style="color: #2d9574;">"Cher"</span>;
<span style="color: #2aa1ae; background-color: #ecf3ec;">//    </span><span style="color: #2aa1ae; background-color: #ecf3ec;">~~~~~~</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Cannot redeclare block-scoped variable 'shared'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">b.ts</span>
<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">shared</span> = <span style="color: #2d9574;">"Cher"</span>;
<span style="color: #2aa1ae; background-color: #ecf3ec;">//    </span><span style="color: #2aa1ae; background-color: #ecf3ec;">~~~~~~</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Cannot redeclare block-scoped variable 'shared'.</span>
</pre>
</div></li>
<li>上面的俩个文件虽然是.ts文件,但是由于没有import也没有export,那么就认为是普通script(不是module),于
是两个文件里面连同名变量都不能有</li>
<li>以后一旦看到"Cannot redeclare &#x2026;",那么看看是不是你的文件可能是script,避免这个错误的办法可以是转
换script成module</li>
<li><p>
如果实在不需要export和import,还想让你的script成为module,那么可以使用一个export {}.如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">a.ts and b.ts</span>
<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">shared</span> = <span style="color: #2d9574;">"Cher"</span>           <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">ok</span>
<span style="color: #3a81c3; font-weight: bold;">export</span> <span style="color: #3a81c3;">{}</span>;
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-orge4428b5" class="outline-2">
<h2 id="orge4428b5"><span class="section-number-2">3.</span> Chapter 3: Unions and Literals</h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li>本章主要介绍如下两个特性:
<ul class="org-ul">
<li>Unions: 可以让一个value承载两种或者多种类型</li>
<li>Narrowing: 可以让一个value承载除了某几种类型以外的类型</li>
</ul></li>
</ul>
</div>
<div id="outline-container-org704454c" class="outline-3">
<h3 id="org704454c"><span class="section-number-3">3.1.</span> Union Types</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li>有种情况,某个类型可能是多种类型
<ul class="org-ul">
<li><p>
代码如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">mathematician</span> = Math.<span style="color: #6c3163; font-weight: bold;">random</span><span style="color: #3a81c3;">()</span> &gt; 0.5
  ? <span style="color: #4e3163;">undefined</span>
  : <span style="color: #2d9574;">"Mark Goldberg"</span>;
</pre>
</div></li>
<li>mathematician是一个either undefined or string的变量.这种"either or"类型在ts
里面就叫做union</li>
<li><p>
Typescript的编译器会分析出来,并且给出mathematician的类型判断如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">mathematician</span>: <span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #4e3163;">undefined</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
<div id="outline-container-org98d5094" class="outline-4">
<h4 id="org98d5094"><span class="section-number-4">3.1.1.</span> Declaring Union Types</h4>
<div class="outline-text-4" id="text-3-1-1">
<ul class="org-ul">
<li><p>
union type的定义例子如下: 虽然thinker已经有了初始化值null,但是因为它有可能后面变成string,所以还是
给它一个string的定义
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">thinker</span>: <span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #4e3163;">null</span> = <span style="color: #4e3163;">null</span>;

<span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3;">(</span>Math.<span style="color: #6c3163; font-weight: bold;">random</span><span style="color: #6c3163;">()</span> &gt; 0.5<span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  thinker = <span style="color: #2d9574;">"Susanne Langer"</span>;   <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">ok</span>
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
<li>union里面的多个类型的先后顺序是不重要的</li>
</ul>
</div>
</div>
<div id="outline-container-orgf5ba7e8" class="outline-4">
<h4 id="orgf5ba7e8"><span class="section-number-4">3.1.2.</span> Union Preperties</h4>
<div class="outline-text-4" id="text-3-1-2">
<ul class="org-ul">
<li><p>
如果一个类型是union的,那么ts只允许你访问union内部所有类型都有的member property. 访问只有部分类型有
的member property是会报type-checking error的,例子如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">physicist</span> = Math.<span style="color: #6c3163; font-weight: bold;">random</span><span style="color: #3a81c3;">()</span> &gt; 0.5
  ? <span style="color: #2d9574;">"Marie Curie"</span>
  : 84;

physicist.<span style="color: #6c3163; font-weight: bold;">toString</span><span style="color: #3a81c3;">()</span>;


<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS2339: Property 'toUpperCase' does not exist on type 'string | number'. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">physicist.</span><span style="color: #6c3163; font-weight: bold;">toUpperCase</span><span style="color: #2aa1ae; background-color: #ecf3ec;">();</span>


<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS2339: Property 'toFixed' does not exist on type 'string | number'. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">physicist.</span><span style="color: #6c3163; font-weight: bold;">toFixed</span><span style="color: #2aa1ae; background-color: #ecf3ec;">();</span>
</pre>
</div></li>
<li>为了能够使用只有某一种类型上才有的property, 代码需要告诉ts,在某处的code是one of those more specific
type:这个过程叫做narrowing</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org1349f82" class="outline-3">
<h3 id="org1349f82"><span class="section-number-3">3.2.</span> Narrowing</h3>
<div class="outline-text-3" id="text-3-2">
<ul class="org-ul">
<li>narrowing的方法有两种:
<ul class="org-ul">
<li>一种通过assignment</li>
<li>另外一种通过check</li>
</ul></li>
</ul>
</div>
<div id="outline-container-org3e29043" class="outline-4">
<h4 id="org3e29043"><span class="section-number-4">3.2.1.</span> Assignment Narrowing</h4>
<div class="outline-text-4" id="text-3-2-1">
<ul class="org-ul">
<li>assignment narrowing又有两种情况:
<ul class="org-ul">
<li><p>
初始化为其中一个类型
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">physicist</span>: <span style="color: #3a81c3; font-weight: bold;">number</span> | <span style="color: #3a81c3; font-weight: bold;">string</span> = 83;

physicist.<span style="color: #6c3163; font-weight: bold;">toString</span><span style="color: #3a81c3;">()</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS2339: Property 'toUpperCase' does not exist on type 'string | number'. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">physicist.</span><span style="color: #6c3163; font-weight: bold;">toUpperCase</span><span style="color: #2aa1ae; background-color: #ecf3ec;">();</span>

physicist.<span style="color: #6c3163; font-weight: bold;">toFixed</span><span style="color: #3a81c3;">()</span>;
</pre>
</div></li>
<li><p>
赋值为其中一个类型
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">physicist</span> = Math.<span style="color: #6c3163; font-weight: bold;">random</span><span style="color: #3a81c3;">()</span> &gt; 0.5 ? <span style="color: #2d9574;">"Marie Curie"</span> : 84;

physicist.<span style="color: #6c3163; font-weight: bold;">toString</span><span style="color: #3a81c3;">()</span>;

physicist = <span style="color: #2d9574;">"Hedy Lamarr"</span>;
physicist.<span style="color: #6c3163; font-weight: bold;">toUpperCase</span><span style="color: #3a81c3;">()</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS2339: Property 'toFixed' does not exist on type 'string | number'. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">physicist.</span><span style="color: #6c3163; font-weight: bold;">toFixed</span><span style="color: #2aa1ae; background-color: #ecf3ec;">();</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org62141ad" class="outline-4">
<h4 id="org62141ad"><span class="section-number-4">3.2.2.</span> Conditional Checks</h4>
<div class="outline-text-4" id="text-3-2-2">
<ul class="org-ul">
<li><p>
ts非常聪明,能够判定if statement里面的变量当前是什么类型.下面的例子中在if里面scientist是字符串类型,
但是出了循环scientist就不再单单是字符串类型了
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">scientist</span> = Math.<span style="color: #6c3163; font-weight: bold;">random</span><span style="color: #3a81c3;">()</span> &gt; 0.5 ? <span style="color: #2d9574;">"Rosalind Franklin"</span> : 51;

<span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3;">(</span>scientist === <span style="color: #2d9574;">"Rosalind Franklin"</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type of scientist: string</span>
  scientist.<span style="color: #6c3163; font-weight: bold;">toUpperCase</span><span style="color: #6c3163;">()</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #715ab1;">ok</span>
<span style="color: #3a81c3;">}</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS2339: Property 'toUpperCase' does not exist on type 'string | number'.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">scientist.</span><span style="color: #6c3163; font-weight: bold;">toUpperCase</span><span style="color: #2aa1ae; background-color: #ecf3ec;">(); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////</span>
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-orge24943e" class="outline-4">
<h4 id="orge24943e"><span class="section-number-4">3.2.3.</span> Typeof Checks</h4>
<div class="outline-text-4" id="text-3-2-3">
<ul class="org-ul">
<li>除了用直接的等于(<code>=</code>)判断,typescript还支持typeof的结果</li>
<li><p>
typeof首先可以判断true的情况
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">researcher</span> = Math.<span style="color: #6c3163; font-weight: bold;">random</span><span style="color: #3a81c3;">()</span> &gt; 0.5 ? <span style="color: #2d9574;">"Rosalind Franklin"</span> : 51;

<span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">typeof</span> researcher === <span style="color: #2d9574;">"string"</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  researcher.<span style="color: #6c3163; font-weight: bold;">toUpperCase</span><span style="color: #6c3163;">()</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #715ab1;">ok</span>
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
<li><p>
typeof也可以判断false的情况
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">researcher</span> = Math.<span style="color: #6c3163; font-weight: bold;">random</span><span style="color: #3a81c3;">()</span> &gt; 0.5 ? <span style="color: #2d9574;">"Rosalind Franklin"</span> : 51;

<span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3;">(</span>!<span style="color: #6c3163;">(</span><span style="color: #3a81c3; font-weight: bold;">typeof</span> researcher === <span style="color: #2d9574;">"string"</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  researcher.<span style="color: #6c3163; font-weight: bold;">toFixed</span><span style="color: #6c3163;">()</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #715ab1;">ok</span>
<span style="color: #3a81c3;">}</span> <span style="color: #3a81c3; font-weight: bold;">else</span> <span style="color: #3a81c3;">{</span>
  researcher.<span style="color: #6c3163; font-weight: bold;">toUpperCase</span><span style="color: #6c3163;">()</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #715ab1;">ok</span>
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
<li><p>
我们还可以把typeof写成三元表达式的情况
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">researcher</span> = Math.<span style="color: #6c3163; font-weight: bold;">random</span><span style="color: #3a81c3;">()</span> &gt; 0.5 ? <span style="color: #2d9574;">"Rosalind Franklin"</span> : 51;

<span style="color: #3a81c3; font-weight: bold;">typeof</span> researcher === <span style="color: #2d9574;">"string"</span>
  ? researcher.<span style="color: #6c3163; font-weight: bold;">toUpperCase</span><span style="color: #3a81c3;">()</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #715ab1;">ok</span>
  : researcher.<span style="color: #6c3163; font-weight: bold;">toFixed</span><span style="color: #3a81c3;">()</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #715ab1;">ok</span>
</pre>
</div></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgd66e898" class="outline-3">
<h3 id="orgd66e898"><span class="section-number-3">3.3.</span> Literal Types</h3>
<div class="outline-text-3" id="text-3-3">
<ul class="org-ul">
<li>先来看个例子
<ul class="org-ul">
<li><p>
例子如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">philosopher</span> = <span style="color: #2d9574;">"Hypatia"</span>;
</pre>
</div></li>
<li>这个例子中的philosopher是一个string类型,这也是我们之前学到的内容</li>
<li>我们这里要学到的是,philosopher不仅仅是string类型,它还是一个更具体的类型,叫做"specific Hypatia"类型</li>
<li><p>
这种"更具体的类型",就是literal type,具体点说就是
</p>
<pre class="example" id="org769c48a">
The type of a value that is known to be a specific value of a primitive,
rather than any of those primitive's value at all
</pre></li>
</ul></li>
<li>我们来看看"string类型"和"Hypatia类型"的区别:
<ul class="org-ul">
<li>primitive type string代表了所有可能的字符串</li>
<li>literal type Hypatia只能代表一种字符串</li>
</ul></li>
<li><p>
如果你创建了变量,并且给它设置为const,那么ts就直接给这个变量设置为literal type,比如下面的例子中,
mathematician的类型就是 "Mark Goldberg"
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">mathematician</span> = <span style="color: #2d9574;">"Mark Goldberg"</span>;
</pre>
</div></li>
<li><p>
你可以把每个primitive type都看成是所有可能的literal value的union
</p>
<pre class="example" id="org0997511">
You can think of each primitive type as a union of every possible matching literal value
</pre></li>
<li><p>
union type annotation可以混合literal和primitive,比如下面的例子
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">lifespan</span>: <span style="color: #3a81c3; font-weight: bold;">number</span> | <span style="color: #2d9574;">"ongoing"</span> | <span style="color: #2d9574;">"uncertain"</span>;

lifespan = 89;                   <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">ok</span>
lifespan = <span style="color: #2d9574;">"ongoing"</span>;            <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">ok</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS2322: Type 'true' is not assignable to type 'number | "ongoing" | "uncertain"'. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//</span><span style="color: #2aa1ae; background-color: #ecf3ec;">lifespan = true;</span>
</pre>
</div></li>
</ul>
</div>
<div id="outline-container-org0c8bd20" class="outline-4">
<h4 id="org0c8bd20"><span class="section-number-4">3.3.1.</span> Literal Assignability</h4>
<div class="outline-text-4" id="text-3-3-1">
<ul class="org-ul">
<li>literal type可不是简单说说一下,它真的是一个类型:
<ul class="org-ul">
<li>我们知道,不通的primitive 类型相互之间不能赋值:比如number和string不能相互赋值</li>
<li>不同的literal type之间也不能相互赋值(虽然他们属于同一种primitive type)</li>
</ul></li>
<li>我们可以从下面的例子证明这一点:
<ul class="org-ul">
<li><p>
例子如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">specificallyAda</span>: <span style="color: #2d9574;">"Ada"</span>;
specificallyAda = <span style="color: #2d9574;">"Ada"</span>;         <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">ok</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS2322: Type '"Byron"' is not assignable to type '"Ada"'. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">specificallyAda = "Byron";</span>

<span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">someStirng</span> = <span style="color: #2d9574;">""</span>;            <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type: string</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS2322: Type 'string' is not assignable to type '"Ada"'. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">specificallyAda = someStirng</span>
</pre>
</div></li>
<li><p>
注意,创建一个literal type除了使用const,还可以把literal 类型像其他类型一样写在':'后面,但是注意,虽
然specificallyAda的值只能是"Ada"(因为他是"Ada"类型的),但是初始化之后没有赋值,还是不能访问的,否则
会报错.例子如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">specificallyAda</span>: <span style="color: #2d9574;">"Ada"</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS2454: Variable 'specificallyAda' is used before being assigned. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">console.</span><span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #2aa1ae; background-color: #ecf3ec;">(specificallyAda)</span>

specificallyAda = <span style="color: #2d9574;">"Ada"</span>;         <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">ok</span>
<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>specificallyAda<span style="color: #3a81c3;">)</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Ada</span>
</pre>
</div></li>
</ul></li>
<li>literal type相互之间不可用赋值,但是literal type却可以"向上"赋值给自己所在的primitive type,这也是
literal type作为比primitive低一个级别类型的特点."向上"赋值随时可见,只是我们没有想到.比如下面这两个
都是向上赋值:
<ul class="org-ul">
<li><p>
比较"严谨"的向上赋值
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">smile</span> : <span style="color: #2d9574;">":)"</span>;
smile = <span style="color: #2d9574;">":)"</span>;
<span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">something</span> = <span style="color: #2d9574;">""</span>;

something = smile
<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>something<span style="color: #3a81c3;">)</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">:)</span>
</pre>
</div></li>
<li><p>
比较"常见"的向上赋值,其实是上面"严谨"版本的简化版
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">someString</span> = <span style="color: #2d9574;">":)"</span>;
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org4d7094e" class="outline-3">
<h3 id="org4d7094e"><span class="section-number-3">3.4.</span> Strict Null Checking</h3>
<div class="outline-text-3" id="text-3-4">
<ul class="org-ul">
<li>narrowed union在加上literal能够让ts非常从容的处理strict null checking</li>
</ul>
</div>
<div id="outline-container-org5263d19" class="outline-4">
<h4 id="org5263d19"><span class="section-number-4">3.4.1.</span> The Billion-Dollar Mistake</h4>
<div class="outline-text-4" id="text-3-4-1">
<ul class="org-ul">
<li>所谓的billion-dollar mistake是指, null value的发明者认为这不是一个好的发明,把null value引入编程语言
导致了几十亿美元的损失.</li>
<li>ts的编译器包含了很多option,允许我们配置编译器,最著名的一个选项就是strictNullChecks:
<ul class="org-ul">
<li><p>
如果enable,那么null(undefined)不能赋值给其他类型变量,默认的配置就是这样的
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">someString</span> = <span style="color: #2d9574;">"abc"</span>;
<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>someString<span style="color: #3a81c3;">)</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS2322: Type 'null' is not assignable to type 'string'. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">someString = null;</span>
</pre>
</div></li>
<li><p>
如果disable,那么显然就是null(undefined)可以赋值给其他变量.其实质上的原理,就是给每个类型添加如下
代码
</p>
<div class="org-src-container">
<pre class="src src-typescript">| <span style="color: #4e3163;">null</span> | <span style="color: #4e3163;">undefined</span>
</pre>
</div></li>
</ul></li>
<li>ts的最佳实践就是开启strictNullCheck,否则无法规避某些null和undefined对代码的破坏</li>
</ul>
</div>
</div>
<div id="outline-container-org3611fda" class="outline-4">
<h4 id="org3611fda"><span class="section-number-4">3.4.2.</span> Truthiness Narrowing</h4>
<div class="outline-text-4" id="text-3-4-2">
<ul class="org-ul">
<li>在js里面,判断一个变量是否为true原理如下:变量只要不是如下值,那么它们就是true:
<ul class="org-ul">
<li>false</li>
<li>0</li>
<li>-0</li>
<li>0n</li>
<li>""</li>
<li>null</li>
<li>undefined</li>
<li>NaN</li>
</ul></li>
<li>基于js的这些设置,那么ts可以在某些if为true的case里面,narrowing类型成功(到一种)
<ul class="org-ul">
<li><p>
例子如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">geneticist</span> = Math.<span style="color: #6c3163; font-weight: bold;">random</span><span style="color: #3a81c3;">()</span> &gt; 0.5
  ? <span style="color: #2d9574;">"Barbara McClintock"</span>
  : <span style="color: #4e3163;">undefined</span>;

<span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3;">(</span>geneticist<span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  geneticist.<span style="color: #6c3163; font-weight: bold;">toUpperCase</span><span style="color: #6c3163;">()</span>;      <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #715ab1;">ok</span><span style="color: #2aa1ae; background-color: #ecf3ec;">: </span><span style="color: #715ab1;">string</span>
<span style="color: #3a81c3;">}</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS18048: 'geneticist' is possibly 'undefined'. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">geneticist.</span><span style="color: #6c3163; font-weight: bold;">toUpperCase</span><span style="color: #2aa1ae; background-color: #ecf3ec;">();</span>
</pre>
</div></li>
<li>上面例子中,由于undefined是不可能为true的,那么if 里面是必然是string类型的</li>
<li>在if之外,就不能narrowing了,强制调用toUpperCase()会失败</li>
</ul></li>
<li>注意,这种narrowing只能在true case里面起作用,无法在false case里面起作用,因为空字符串("")和undefined
都被认为是false</li>
</ul>
</div>
</div>
<div id="outline-container-org87df15e" class="outline-4">
<h4 id="org87df15e"><span class="section-number-4">3.4.3.</span> Variables Without Initial Values</h4>
<div class="outline-text-4" id="text-3-4-3">
<ul class="org-ul">
<li>在js里面,如果一个变量声明之后,没有给初始化值,那么这个变量就会初始化成undefined</li>
<li>在ts中如果试图使用一个值为undefined的变量(声明之后没有赋值的变量),ts会报一个特定的错误,
<ul class="org-ul">
<li><p>
代码如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">mathematician</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS2454: Variable 'mathematician' is used before being assigned. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">mathematician?.length;</span>

mathematician = <span style="color: #2d9574;">"Mark Goldberg"</span>;
mathematician.length;
</pre>
</div></li>
<li><p>
上面例子中出现了 `?`, 这是ts里面特有的安全链式调用,详细解释如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#36825;&#37324; Error&#23545;&#35937;&#23450;&#20041;&#30340;stack&#26159;&#21487;&#36873;&#21442;&#25968;&#65292;&#22914;&#26524;&#36825;&#26679;&#20889;&#30340;&#35805;&#32534;&#35793;&#22120;&#20250;&#25552;&#31034;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#20986;&#38169; TS2532: Object is possibly 'undefined'.</span>
<span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #3a81c3; font-weight: bold;">new</span> <span style="color: #ba2f59; font-weight: bold;">Error</span><span style="color: #3a81c3;">()</span>.stack.<span style="color: #6c3163; font-weight: bold;">split</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'\n'</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#25105;&#20204;&#21487;&#20197;&#28155;&#21152;?&#25805;&#20316;&#31526;&#65292;&#24403;stack&#23646;&#24615;&#23384;&#22312;&#26102;&#65292;&#35843;&#29992; stack.split&#12290;&#33509;stack&#19981;&#23384;&#22312;&#65292;&#21017;&#36820;&#22238;&#31354;</span>
<span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #3a81c3; font-weight: bold;">new</span> <span style="color: #ba2f59; font-weight: bold;">Error</span><span style="color: #3a81c3;">()</span>.stack?.<span style="color: #6c3163; font-weight: bold;">split</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'\n'</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#20197;&#19978;&#20195;&#30721;&#31561;&#21516;&#20197;&#19979;&#20195;&#30721;</span>
<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">err</span> = <span style="color: #3a81c3; font-weight: bold;">new</span> <span style="color: #ba2f59; font-weight: bold;">Error</span><span style="color: #3a81c3;">()</span>;
<span style="color: #3a81c3; font-weight: bold;">return</span> err.stack &amp;&amp; err.stack.<span style="color: #6c3163; font-weight: bold;">split</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">'\n'</span><span style="color: #3a81c3;">)</span>;
</pre>
</div></li>
<li><p>
注意,如果类型里面union了undefined,那么上面的错误不会发生
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">mathematician</span>: <span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #4e3163;">undefined</span>;
<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>mathematician?.length<span style="color: #3a81c3;">)</span>;

mathematician = <span style="color: #2d9574;">"Mark Goldberg"</span>;
mathematician.length;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">undefined</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgae05808" class="outline-3">
<h3 id="orgae05808"><span class="section-number-3">3.5.</span> Type Aliases</h3>
<div class="outline-text-3" id="text-3-5">
<ul class="org-ul">
<li><p>
绝大多数情况下,union只有两三个成员,但是也有出现很多成员的情况,如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">rawDataFirst</span>: <span style="color: #3a81c3; font-weight: bold;">boolean</span> | <span style="color: #3a81c3; font-weight: bold;">number</span> | <span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #4e3163;">null</span> | <span style="color: #4e3163;">undefined</span>
<span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">rawDataSecond</span>: <span style="color: #3a81c3; font-weight: bold;">boolean</span> | <span style="color: #3a81c3; font-weight: bold;">number</span> | <span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #4e3163;">null</span> | <span style="color: #4e3163;">undefined</span>
<span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">rawDataThird</span>: <span style="color: #3a81c3; font-weight: bold;">boolean</span> | <span style="color: #3a81c3; font-weight: bold;">number</span> | <span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #4e3163;">null</span> | <span style="color: #4e3163;">undefined</span>
</pre>
</div></li>
<li><p>
上述例子中的 `boolean | number | string | null | undefined` 被使用了多次,为了保证DRY原则,ts又设计了
重用type列表的type alias,上面的例子就可以改写成如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">RawData</span> = <span style="color: #3a81c3; font-weight: bold;">boolean</span> | <span style="color: #3a81c3; font-weight: bold;">number</span> | <span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #4e3163;">null</span> | <span style="color: #4e3163;">undefined</span>

<span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">rawDataFirst</span>: <span style="color: #ba2f59; font-weight: bold;">RawData</span>
<span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">rawDataSecond</span>: <span style="color: #ba2f59; font-weight: bold;">RawData</span>
<span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">rawDataThird</span>: <span style="color: #ba2f59; font-weight: bold;">RawData</span>
</pre>
</div></li>
</ul>
</div>
<div id="outline-container-orge5fe355" class="outline-4">
<h4 id="orge5fe355"><span class="section-number-4">3.5.1.</span> Type Aliases Are Not JavaScript</h4>
<div class="outline-text-4" id="text-3-5-1">
<ul class="org-ul">
<li>type alias不会编译成javascript,它只存在于typescript里面</li>
<li><p>
既然不会被编译成js,那么你在运行时想access这个变量就是违法的,ts会报警
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">SomeType</span> = <span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #4e3163;">undefined</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS2693: 'SomeType' only refers to a type, but is being used as a value here. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">console.</span><span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #2aa1ae; background-color: #ecf3ec;">(SomeType)</span>
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-orgaacdd68" class="outline-4">
<h4 id="orgaacdd68"><span class="section-number-4">3.5.2.</span> Combining Type Aliases</h4>
<div class="outline-text-4" id="text-3-5-2">
<ul class="org-ul">
<li><p>
type alias还可以互相引用
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">Id</span> = <span style="color: #3a81c3; font-weight: bold;">number</span> | <span style="color: #3a81c3; font-weight: bold;">string</span>

<span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">IdMaybe</span> = Id | <span style="color: #4e3163;">undefined</span> | <span style="color: #4e3163;">null</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Equivalent to: number | string | undefind | null</span>
</pre>
</div></li>
<li><p>
互相引用的时候,不必要又顺序,ts编译器会全局考虑,所以使用未定义的type alias也是允许的
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">IdMaybe</span> = Id | <span style="color: #4e3163;">undefined</span> | <span style="color: #4e3163;">null</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Equivalent to: number | string | undefind | null</span>
<span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">Id</span> = <span style="color: #3a81c3; font-weight: bold;">number</span> | <span style="color: #3a81c3; font-weight: bold;">string</span>
</pre>
</div></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org10467d1" class="outline-2">
<h2 id="org10467d1"><span class="section-number-2">4.</span> Chapter 4: Objects</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org8bb2f5e" class="outline-3">
<h3 id="org8bb2f5e"><span class="section-number-3">4.1.</span> Object Types</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>在ts/js里面,有种创建object的方法叫做object literal
<ul class="org-ul">
<li><p>
样子如下
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">person</span> = <span style="color: #3a81c3;">{</span>
  name: <span style="color: #2d9574;">"adam"</span>,
  age: 23,
<span style="color: #3a81c3;">}</span>;
console.log<span style="color: #3a81c3;">(</span>person<span style="color: #3a81c3;">)</span>
console.log<span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">typeof</span><span style="color: #6c3163;">(</span>person<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">{ name: 'adam', age: 23 }</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">object</span>
</pre>
</div></li>
<li>在js的语境中person的类型就是object</li>
</ul></li>
<li>ts中当然也承认这种用法,并且ts还做了js没有做的事情,给新的object person一个更加具体的类型
<ul class="org-ul">
<li>类型名字叫'{name: string; age: number;}'</li>
<li><p>
这个类型我们可以通过typescript playground可以看到,也可以通过如下的"错误"代码看到
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">person</span> = <span style="color: #3a81c3;">{</span>
  name: <span style="color: #2d9574;">"adam"</span>,
  age: 23,
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Property 'foo' does not exist on type '{ name: string; age: number; }'. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">person.</span><span style="color: #6c3163; font-weight: bold;">foo</span><span style="color: #2aa1ae; background-color: #ecf3ec;">()</span>
</pre>
</div></li>
</ul></li>
<li>在js和ts中,我们都可以使用如下两种方式访问object value的成员:
<ul class="org-ul">
<li>object_value.mameber</li>
<li>object_value['member']</li>
</ul></li>
<li><p>
如果访问不存在的member,那么会报警
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span>  <span style="color: #715ab1;">poet</span> = <span style="color: #3a81c3;">{</span>
  born: 1935,
  name: <span style="color: #2d9574;">"Mary Oliver"</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>poet<span style="color: #6c3163;">[</span><span style="color: #2d9574;">'born'</span><span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>;
<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>poet.name<span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS2339: Property 'end' does not exist on type '{ born: number; name: string; }'. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">poet.end;</span>
</pre>
</div></li>
</ul>
</div>
<div id="outline-container-org975b89b" class="outline-4">
<h4 id="org975b89b"><span class="section-number-4">4.1.1.</span> Declaring Object Types</h4>
<div class="outline-text-4" id="text-4-1-1">
<ul class="org-ul">
<li>ts作为一个静态的类型系统语言,当然会提供"显式"定义object type的功能
<ul class="org-ul">
<li><p>
代码如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">poetLater</span>: <span style="color: #3a81c3;">{</span>
  born: <span style="color: #3a81c3; font-weight: bold;">number</span>;
  name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">ok</span>
poetLater = <span style="color: #3a81c3;">{</span>
  born: 1935,
  name: <span style="color: #2d9574;">"Mary Oliver"</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS2322: Type 'string' is not assignable to type '{ born: number; name: string; }'. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">poetLater = "Sappho";</span>
</pre>
</div></li>
<li>注意这里的类型就是type '{ born: number; name: string; }'</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org9126c28" class="outline-4">
<h4 id="org9126c28"><span class="section-number-4">4.1.2.</span> Aliased Object Types</h4>
<div class="outline-text-4" id="text-4-1-2">
<ul class="org-ul">
<li>我们发现上一节讲到的ts的类型名字都是这样的type '{ born: number; name: string; }', 这种名字是类似"匿名"
的这么一种方式(只有类型的属性,没有名字)</li>
<li><p>
如果我们想给不同的变量赋予类型,显然还是"非匿名"的方式更好,也就是给object type一个名字.这样一来,我们
的error message也会更加易读
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">Poet</span> = <span style="color: #3a81c3;">{</span>
  born: <span style="color: #3a81c3; font-weight: bold;">number</span>;
  name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">poetLater</span>: <span style="color: #ba2f59; font-weight: bold;">Poet</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">ok</span>
poetLater = <span style="color: #3a81c3;">{</span>
  born: 1935,
  name: <span style="color: #2d9574;">"Sara Teasdale"</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">error TS2322: Type 'string' is not assignable to type 'Poet'. //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">poetLater = "Emily Dickinson"</span>
</pre>
</div></li>
<li>理解ts如何解析object literal对于我们理解ts的type system非常重要,本节内容对后面理解也非常重要</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgcbf2e93" class="outline-3">
<h3 id="orgcbf2e93"><span class="section-number-3">4.2.</span> Structural Typing</h3>
<div class="outline-text-3" id="text-4-2">
<ul class="org-ul">
<li><p>
TypeScript的类型系统叫做structurally typed: 所谓structurally type,是说一个value"刚好"能满足一个类型,
那么就可以作为这个类型的value. 换句话说就是golang的所谓类型推断(Type inference),不需要显式的类型声明
</p>
<pre class="example" id="org2e08fef">
Structurally typing means: any value that happens to satisfy a type is a allowed to be used
as a value of that type.
</pre></li>
<li>下面就是一个structural typing的例子:
<ul class="org-ul">
<li><p>
如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">WithFirstName</span> = <span style="color: #3a81c3;">{</span>
  firstName: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">WithLastName</span> = <span style="color: #3a81c3;">{</span>
  lastName: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">hasBoth</span> = <span style="color: #3a81c3;">{</span>
  firstName: <span style="color: #2d9574;">"Lucille"</span>,
  lastName: <span style="color: #2d9574;">"Clifton"</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">withFirstName</span>: <span style="color: #ba2f59; font-weight: bold;">WithFirstName</span> = hasBoth;
<span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">withLastName</span>: <span style="color: #ba2f59; font-weight: bold;">WithLastName</span> = hasBoth;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>withFirstName<span style="color: #3a81c3;">)</span>;
<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>withLastName<span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">{ firstName: 'Lucille', lastName: 'Clifton' }</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">{ firstName: 'Lucille', lastName: 'Clifton' }</span>
</pre>
</div></li>
<li>这个例子中我们有两个类型WithFirstName和WithLastName,每个类型都只有一个成员.</li>
<li>而hasBoth刚好这两个成员都有,那么即便我们没有"显式"的声明hashBoth属于这两个类型,但是hasBoth确实同
时符合这两个类型,那么一旦有这两个类型的变量需要value,我们的hashBoth就可以提供了.</li>
</ul></li>
<li>需要注意的是Structural typing和duck typing是两个概念:
<ul class="org-ul">
<li>structural tying是有staic system check的,在typescript这里就是type checker</li>
<li>duck typing是没有static system check的,它是在runtime遇到某个属性方法的时候,才去做check. Javascript
就是duck typing的编程语言</li>
</ul></li>
</ul>
</div>
<div id="outline-container-org2d0034b" class="outline-4">
<h4 id="org2d0034b"><span class="section-number-4">4.2.1.</span> Usage Checking</h4>
<div class="outline-text-4" id="text-4-2-1">
<ul class="org-ul">
<li>当我们在为一个value标记object type的时候,typescript会去check这个value是否满足了目标标记的type所需要
的所有成员. 如果缺少成员,那么就会报type error(多了其实也不行,后面会看到. 赋值的时候多了可以,声明的
时候多了不行)</li>
<li>下面就是一个缺少成员而报错的例子
<ul class="org-ul">
<li><p>
代码如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">FirstAndLastNames</span> = <span style="color: #3a81c3;">{</span>
  first: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  last: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">ok</span>
<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">hasBoth</span>: <span style="color: #ba2f59; font-weight: bold;">FirstAndLastNames</span> = <span style="color: #3a81c3;">{</span>
  first: <span style="color: #2d9574;">"Sarojini"</span>,
  last: <span style="color: #2d9574;">"Naidu"</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:12:7 - error TS2741: Property 'last' is missing in type '{ first: string; }' but required in type 'FirstAndLastNames'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const hasOnlyOne: FirstAndLastNames = { //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">first: "Sappho",                      //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">};                                      //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
<li>如果数量对上了,但是具体的类型没有满足,也是会报错的.
<ul class="org-ul">
<li><p>
如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">TimeRange</span> = <span style="color: #3a81c3;">{</span>
  start: <span style="color: #ba2f59; font-weight: bold;">Date</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:6:3 - error TS2322: Type 'string' is not assignable to type 'Date'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const hasStartString: TimeRange = { //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">start: "1979-02-13",              //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">};                                  //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org7441f17" class="outline-4">
<h4 id="org7441f17"><span class="section-number-4">4.2.2.</span> Excess Property Checking</h4>
<div class="outline-text-4" id="text-4-2-2">
<ul class="org-ul">
<li>我们对Typescript的structural typing印象深刻,一来是不需要声明,二来是成员满足即可,成员多了也能赋值成功</li>
<li>如果初始化变量的时候,我们声明了(同时标记了类型),那么成员就必须一模一样,不能少,也不能多了
<ul class="org-ul">
<li><p>
下面的例子中,就是我们在声明的时候,标记了类型,多一个成员activity就会报错
</p>
<div class="org-src-container">
<pre class="src src-js">type Poet = <span style="color: #3a81c3;">{</span>
  born: number;
  name: string;
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">poetMatch</span>: Poet = <span style="color: #3a81c3;">{</span>
  born: 1928,
  name: <span style="color: #2d9574;">"Maya Angelou"</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:12:3 - error TS2353: Object literal may only specify known properties, and 'activity' does not exist in type 'Poet'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const extraProperty: Poet = { //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">activity: "walking",        //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">born: 1935,                 //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">name: "Mary Oliver",        //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">};                            //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">existingObject</span> = <span style="color: #3a81c3;">{</span>
  activity: <span style="color: #2d9574;">"walking"</span>,
  born: 1935,
  name: <span style="color: #2d9574;">"Mary Oliver"</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">extraProperty</span>: Poet = existingObject; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Ok</span>
</pre>
</div></li>
<li>我们可以看到,初始化的时候多了是会有问题的(因为这时候往往是mistype), 但是用一个其他value赋值的时候多了是没问题的</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org7aa72ec" class="outline-4">
<h4 id="org7aa72ec"><span class="section-number-4">4.2.3.</span> Nested Object Types</h4>
<div class="outline-text-4" id="text-4-2-3">
<ul class="org-ul">
<li>由于Javascript object可以nest很多其他的object, typescript也就必须能够表达nested object.</li>
<li>我们在type定义的类型,在使用object literal(而不是value)初始化的时候,必须完全一致
<ul class="org-ul">
<li><p>
下面代码中poemMismatch缺少author成员,所以初始化报错
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">Poem</span> = <span style="color: #3a81c3;">{</span>
  author: <span style="color: #6c3163;">{</span>
    firstName: <span style="color: #3a81c3; font-weight: bold;">string</span>;
    lastName: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  <span style="color: #6c3163;">}</span>;
  name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">ok</span>
<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">poemMatch</span>: <span style="color: #ba2f59; font-weight: bold;">Poem</span> = <span style="color: #3a81c3;">{</span>
  author: <span style="color: #6c3163;">{</span>
    firstName: <span style="color: #2d9574;">"Sylvia"</span>,
    lastName: <span style="color: #2d9574;">"Plath"</span>,
  <span style="color: #6c3163;">}</span>,
  name: <span style="color: #2d9574;">"Lady Lazarus"</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:20:5 - error TS2353: Object literal may only specify known properties, and 'name' does not exist in type '{ firstName: string; lastName: string; }'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const poemMismatch: Poem = { //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">author: {                  //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//     </span><span style="color: #2aa1ae; background-color: #ecf3ec;">name: "Sylvia Plath",    //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">},                         //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">name: "Tuplips",           //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">};                           //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////</span>
</pre>
</div></li>
<li>上面的代码报错比较不容易理解,因为我们的author成员没有文字类型,只能用'{ firstName: string; lastName: string; }'来替代.</li>
<li><p>
一个更好的办法是把nested 类型给拆出来,给与一个名字,比如Author,那么代码更清晰,报错也更易读
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">Author</span> = <span style="color: #3a81c3;">{</span>
  firstName: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  lastName: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">Poem</span> = <span style="color: #3a81c3;">{</span>
  author: <span style="color: #ba2f59; font-weight: bold;">Author</span>;
  name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:16:5 - error TS2353: Object literal may only specify known properties, and 'name' does not exist in type 'Author'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const poemMismatch: Poem = { //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">author: {                  //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//     </span><span style="color: #2aa1ae; background-color: #ecf3ec;">name: "Sylvia Plath",    //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">},                         //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">name: "Tuplips",           //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">};                           //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org3b7999a" class="outline-4">
<h4 id="org3b7999a"><span class="section-number-4">4.2.4.</span> Optional Properties</h4>
<div class="outline-text-4" id="text-4-2-4">
<ul class="org-ul">
<li>Object type可以包含一些"可选"成员,这些成员可以不出现,使用`?`标记
<ul class="org-ul">
<li><p>
比如下面的author成员可以不出现
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">Book</span> = <span style="color: #3a81c3;">{</span>
  author?: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  pages: <span style="color: #3a81c3; font-weight: bold;">number</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">ok</span>: <span style="color: #ba2f59; font-weight: bold;">Book</span> = <span style="color: #3a81c3;">{</span>
  author: <span style="color: #2d9574;">"Rita Dove"</span>,
  pages: 80,
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">ok2</span>: <span style="color: #ba2f59; font-weight: bold;">Book</span> = <span style="color: #3a81c3;">{</span>
  pages: 90,
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:15:7 - error TS2741: Property 'pages' is missing in type '{ author: string; }' but required in type 'Book'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const missing: Book = { //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">author: "Rita Dove",  //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">};                      //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////</span>
</pre>
</div></li>
<li>但是注意pages是必须出现的,不出现就会报错</li>
</ul></li>
<li>optional参数是可以不存在的,这个和类型为undefined(或者union包含undefined)不一样,后者即便是undefined也要存在
<ul class="org-ul">
<li><p>
例子如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">Writers</span> = <span style="color: #3a81c3;">{</span>
  author: <span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #4e3163;">undefined</span>;
  editor?: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">ok</span>
<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">hasRequired</span>: <span style="color: #ba2f59; font-weight: bold;">Writers</span> = <span style="color: #3a81c3;">{</span>
  author: <span style="color: #4e3163;">undefined</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:11:7 - error TS2741: Property 'author' is missing in type '{}' but required in type 'Writers'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const missingRequired: Writers = {}; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org69524be" class="outline-3">
<h3 id="org69524be"><span class="section-number-3">4.3.</span> Unions of Object Types</h3>
<div class="outline-text-3" id="text-4-3">
<ul class="org-ul">
<li>既然普通类型有union,那么object类型的union需求也是合理的</li>
</ul>
</div>
<div id="outline-container-org81409bc" class="outline-4">
<h4 id="org81409bc"><span class="section-number-4">4.3.1.</span> Inferred Object-Type Unions</h4>
<div class="outline-text-4" id="text-4-3-1">
<ul class="org-ul">
<li>如果我们不明确的"声明"类型,而是直接赋值(通过?:),那么Typescript会自动的为我们创建union type
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">poem</span> =
  Math.<span style="color: #6c3163; font-weight: bold;">random</span><span style="color: #3a81c3;">()</span> &gt; 0.5
    ? <span style="color: #3a81c3;">{</span> name: <span style="color: #2d9574;">"The Double Image"</span>, pages: 7 <span style="color: #3a81c3;">}</span>
    : <span style="color: #3a81c3;">{</span> name: <span style="color: #2d9574;">"Her Kind"</span>, rhymes: <span style="color: #4e3163;">true</span> <span style="color: #3a81c3;">}</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">`|poem.name| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">poem.name</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3;">)</span>;
<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">`|poem.pages| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">poem.pages</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3;">)</span>;
<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">`|poem.rhymes| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">poem.rhymes</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT1====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.name| =&gt; The Double Image</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.pages| =&gt; 7</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.rhymes| =&gt; undefined</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT2====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.name| =&gt; Her Kind</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.pages| =&gt; undefined</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.rhymes| =&gt; true</span>
</pre>
</div></li>
<li>注意,这种Typescript内部帮我们创建的union type和真正的写出来的union type的不同:
<ol class="org-ol">
<li>真正的union type在没有narrow的情况下,只能使用"交集"的成员,比如name</li>
<li>这里的union type在没有narrow的情况下,还能使用"并集"的成员,比如pages, rhymes</li>
</ol></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org1cc6ac3" class="outline-4">
<h4 id="org1cc6ac3"><span class="section-number-4">4.3.2.</span> Explicit Object-Type Unions</h4>
<div class="outline-text-4" id="text-4-3-2">
<ul class="org-ul">
<li>explicit的把类型列出来做union,而不是让Typescript帮我们创建union是最高的选择,代码清晰,逻辑自然
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">PoemWithPages</span> = <span style="color: #3a81c3;">{</span>
  name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  pages: <span style="color: #3a81c3; font-weight: bold;">number</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">PoemWithRhymes</span> = <span style="color: #3a81c3;">{</span>
  name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  rhymes: <span style="color: #3a81c3; font-weight: bold;">boolean</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">Poem</span> = PoemWithPages | PoemWithRhymes;

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">poem</span>: <span style="color: #ba2f59; font-weight: bold;">Poem</span> =
  Math.<span style="color: #6c3163; font-weight: bold;">random</span><span style="color: #3a81c3;">()</span> &gt; 0.5
    ? <span style="color: #3a81c3;">{</span> name: <span style="color: #2d9574;">"The Double Image"</span>, pages: 7 <span style="color: #3a81c3;">}</span>
    : <span style="color: #3a81c3;">{</span> name: <span style="color: #2d9574;">"Her Kind"</span>, rhymes: <span style="color: #4e3163;">true</span> <span style="color: #3a81c3;">}</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">`|poem.name| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">poem.name</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT1====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.name| =&gt; The Double Image</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT2====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.name| =&gt; Her Kind</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:27:6 - error TS2339: Property 'pages' does not exist on type 'Poem'.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Property 'pages' does not exist on type 'PoemWithRhymes'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">poem.pages; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:35:6 - error TS2339: Property 'rhymes' does not exist on type 'Poem'.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Property 'rhymes' does not exist on type 'PoemWithPages'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">poem.rhymes; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////</span>
</pre>
</div></li>
<li>注意,这里因为是列出来的union,所以只有"交集"name可以在没有narrow的情况下访问</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgc9a85e0" class="outline-4">
<h4 id="orgc9a85e0"><span class="section-number-4">4.3.3.</span> Narrowing Object Types</h4>
<div class="outline-text-4" id="text-4-3-3">
<ul class="org-ul">
<li>有union,那么很显然也会有narrow,只不过object narrow的方法有所不同
<ul class="org-ul">
<li><p>
比如下面的例子,我们使用"page" in poem来进行narrow是可以的
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">PoemWithPages</span> = <span style="color: #3a81c3;">{</span>
  name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  pages: <span style="color: #3a81c3; font-weight: bold;">number</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">PoemWithRhymes</span> = <span style="color: #3a81c3;">{</span>
  name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  rhymes: <span style="color: #3a81c3; font-weight: bold;">boolean</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">Poem</span> = PoemWithPages | PoemWithRhymes;

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">poem</span>: <span style="color: #ba2f59; font-weight: bold;">Poem</span> =
  Math.<span style="color: #6c3163; font-weight: bold;">random</span><span style="color: #3a81c3;">()</span> &gt; 0.5
    ? <span style="color: #3a81c3;">{</span> name: <span style="color: #2d9574;">"The Double Image"</span>, pages: 7 <span style="color: #3a81c3;">}</span>
    : <span style="color: #3a81c3;">{</span> name: <span style="color: #2d9574;">"Her Kind"</span>, rhymes: <span style="color: #4e3163;">true</span> <span style="color: #3a81c3;">}</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">`|poem.name| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">poem.name</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3;">)</span>;

<span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"pages"</span> <span style="color: #3a81c3; font-weight: bold;">in</span> poem<span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`|poem.pages| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">poem.pages</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span> <span style="color: #3a81c3; font-weight: bold;">else</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`|poem.rhymes| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">poem.rhymes</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT1====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.name| =&gt; The Double Image</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.pages| =&gt; 7</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT2====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.name| =&gt; Her Kind</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.rhymes| =&gt; true</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:34:10 - error TS2339: Property 'pages' does not exist on type 'Poem'.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Property 'pages' does not exist on type 'PoemWithRhymes'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">if (poem.</span><span style="color: #715ab1;">pages</span><span style="color: #2aa1ae; background-color: #ecf3ec;">) { //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">}                 //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////</span>
</pre>
</div></li>
<li>但是不可以使用if (poem.pages), 因为试图访问一个不存在的property是会触发type error的</li>
<li>typescript足够聪明,判断出俩poem不是PoemWithPages的时候,它能够确定poem必然是PoemWithRhymes,所以else
里面的的poem.rhymes也能够触发而不报错</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgad64fb1" class="outline-4">
<h4 id="orgad64fb1"><span class="section-number-4">4.3.4.</span> Discriminated Unions</h4>
<div class="outline-text-4" id="text-4-3-4">
<ul class="org-ul">
<li>discriminated union是一个在Javascript和Typescript里面都适用的概念,就是专门加一个property(通常是string)
用来indicate object的真实type</li>
<li>这个专门的用来indicate object的type就叫做discriminant, 而Typescript的narrow过程,如果有discriminant
的参与的话,就会事半功倍.
<ul class="org-ul">
<li><p>
示例如下, 下面例子中的poem.type就是discriminant
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">PoemWithPages</span> = <span style="color: #3a81c3;">{</span>
  name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  pages: <span style="color: #3a81c3; font-weight: bold;">number</span>;
  <span style="color: #655370; background-color: #fbf8ef;">type</span>: <span style="color: #2d9574;">"pages"</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">PoemWithRhymes</span> = <span style="color: #3a81c3;">{</span>
  name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  rhymes: <span style="color: #3a81c3; font-weight: bold;">boolean</span>;
  <span style="color: #655370; background-color: #fbf8ef;">type</span>: <span style="color: #2d9574;">"rhymes"</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">Poem</span> = PoemWithPages | PoemWithRhymes;

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">poem</span>: <span style="color: #ba2f59; font-weight: bold;">Poem</span> =
  Math.<span style="color: #6c3163; font-weight: bold;">random</span><span style="color: #3a81c3;">()</span> &gt; 0.5
    ? <span style="color: #3a81c3;">{</span> name: <span style="color: #2d9574;">"The Double Image"</span>, pages: 7, <span style="color: #655370; background-color: #fbf8ef;">type</span>: <span style="color: #2d9574;">"pages"</span> <span style="color: #3a81c3;">}</span>
    : <span style="color: #3a81c3;">{</span> name: <span style="color: #2d9574;">"Her Kind"</span>, rhymes: <span style="color: #4e3163;">true</span>, <span style="color: #655370; background-color: #fbf8ef;">type</span>: <span style="color: #2d9574;">"rhymes"</span> <span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #3a81c3;">(</span>poem.<span style="color: #3a81c3; font-weight: bold;">type</span> === <span style="color: #2d9574;">"pages"</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`|poem.pages| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">poem.pages</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span> <span style="color: #3a81c3; font-weight: bold;">else</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`|poem.rhymes| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">poem.rhymes</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">`|poem.type| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">poem.type</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT1====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.pages| =&gt; 7</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.type| =&gt; pages</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">// &lt;====================OUTPUT2====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.rhymes| =&gt; true</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|poem.type| =&gt; rhymes</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:36:6 - error TS2339: Property 'pages' does not exist on type 'Poem'.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Property 'pages' does not exist on type 'PoemWithRhymes'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">poem.pages; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////</span>
</pre>
</div></li>
<li>poem.type在if判断后,可以选择书写poem.pages(或者poem.rhymes),否则还是会报错</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgc1706d2" class="outline-3">
<h3 id="orgc1706d2"><span class="section-number-3">4.4.</span> Intersection Types</h3>
<div class="outline-text-3" id="text-4-4">
<ul class="org-ul">
<li>在集合里面中:
<ul class="org-ul">
<li>| 代表 union</li>
<li>&amp; 代表 intersection</li>
</ul></li>
<li>既然已经有了使用`|`的union type,会整活的typescript也没有放弃`&amp;`,创建了intersection type
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">Artwork</span> = <span style="color: #3a81c3;">{</span>
  genre: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">Writing</span> = <span style="color: #3a81c3;">{</span>
  pages: <span style="color: #3a81c3; font-weight: bold;">number</span>;
  name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">WrittenArt</span> = Artwork &amp; Writing;

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">example</span>: <span style="color: #ba2f59; font-weight: bold;">WrittenArt</span> = <span style="color: #3a81c3;">{</span>
  genre: <span style="color: #2d9574;">"Fiction"</span>,
  name: <span style="color: #2d9574;">"The Great Novel"</span>,
  pages: 300,
<span style="color: #3a81c3;">}</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>example<span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">{ genre: 'Fiction', name: 'The Great Novel', pages: 300 }</span>
</pre>
</div></li>
<li><p>
上面的WrittenArt其实就相当于如下的类型
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">WrittenArt</span> = <span style="color: #3a81c3;">{</span>
  genre: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  pages: <span style="color: #3a81c3; font-weight: bold;">number</span>;
<span style="color: #3a81c3;">}</span>;
</pre>
</div></li>
</ul></li>
<li>集合中的union和intersection可以混用,以提高编程语言的解释力
<ul class="org-ul">
<li><p>
示例如下: 在创建discriminated union的时候,共同类型可以通过,`&amp;`来间接的引入而不需要重复写一遍
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">ShortPoem</span> = <span style="color: #3a81c3;">{</span> author: <span style="color: #3a81c3; font-weight: bold;">string</span> <span style="color: #3a81c3;">}</span> &amp; <span style="color: #3a81c3;">(</span>
  | <span style="color: #6c3163;">{</span> kigo: <span style="color: #3a81c3; font-weight: bold;">string</span>; <span style="color: #655370; background-color: #fbf8ef;">type</span>: <span style="color: #2d9574;">"haiku"</span> <span style="color: #6c3163;">}</span>
  | <span style="color: #6c3163;">{</span> meter: <span style="color: #3a81c3; font-weight: bold;">number</span>; <span style="color: #655370; background-color: #fbf8ef;">type</span>: <span style="color: #2d9574;">"villanelle"</span> <span style="color: #6c3163;">}</span>
<span style="color: #3a81c3;">)</span>;

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">morningGlory</span>: <span style="color: #ba2f59; font-weight: bold;">ShortPoem</span> = <span style="color: #3a81c3;">{</span>
  author: <span style="color: #2d9574;">"Fukuda Chiyo-ni"</span>,
  kigo: <span style="color: #2d9574;">"Morning Glory"</span>,
  <span style="color: #655370; background-color: #fbf8ef;">type</span>: <span style="color: #2d9574;">"haiku"</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">`|morningGlory| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">morningGlory</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|morningGlory| =&gt; [object Object]</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:17:7 - error TS2322: Type '{ author: string; </span><span style="color: #655370; background-color: #fbf8ef;">type</span><span style="color: #2aa1ae; background-color: #ecf3ec;">: "villanelle"; }' is not assignable to type 'ShortPoem'.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type '{ author: string; </span><span style="color: #655370; background-color: #fbf8ef;">type</span><span style="color: #2aa1ae; background-color: #ecf3ec;">: "villanelle"; }' is not assignable to type '{ author: string; } &amp; { meter: number; </span><span style="color: #655370; background-color: #fbf8ef;">type</span><span style="color: #2aa1ae; background-color: #ecf3ec;">: "villanelle"; }'.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//     </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Property 'meter' is missing in type '{ author: string; </span><span style="color: #655370; background-color: #fbf8ef;">type</span><span style="color: #2aa1ae; background-color: #ecf3ec;">: "villanelle"; }' but required in type '{ meter: number; </span><span style="color: #655370; background-color: #fbf8ef;">type</span><span style="color: #2aa1ae; background-color: #ecf3ec;">: "villanelle"; }'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const oneArt: ShortPoem = {   //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">author: "Elizabeth Bishop", //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">type: "villanelle",         //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">};                            //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
<div id="outline-container-org3cb2459" class="outline-4">
<h4 id="org3cb2459"><span class="section-number-4">4.4.1.</span> Dangers of Intersection Types</h4>
<div class="outline-text-4" id="text-4-4-1">
<ul class="org-ul">
<li>intersection type会让作者和编译器都困惑,我们最好不要使用这个特性</li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-org33f3dff" class="outline-2">
<h2 id="org33f3dff"><span class="section-number-2">5.</span> Chapter 5: Functions</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org1857d3e" class="outline-3">
<h3 id="org1857d3e"><span class="section-number-3">5.1.</span> Function Parameters</h3>
<div class="outline-text-3" id="text-5-1">
<ul class="org-ul">
<li>对于typescript来说,函数参数也必须声明类型,否则会报错
<ul class="org-ul">
<li><p>
例子如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">sing</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">song</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`Singing: </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">song</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">!`</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #6c3163; font-weight: bold;">sing</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"hello world"</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:1:15 - error TS7006: Parameter 'song' implicitly has an 'any' type.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">function sing(</span><span style="color: #715ab1;">song</span><span style="color: #2aa1ae; background-color: #ecf3ec;">) {               //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">console.</span><span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #2aa1ae; background-color: #ecf3ec;">(`Singing: ${song}!`); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">}                                   //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
<div id="outline-container-orgc279c65" class="outline-4">
<h4 id="orgc279c65"><span class="section-number-4">5.1.1.</span> Required Parameters</h4>
<div class="outline-text-4" id="text-5-1-1">
<ul class="org-ul">
<li>javascript的function并没有参数检查,你可以使用任意数目的参数来调用函数.即便这个数目和你声明的不一样
<ul class="org-ul">
<li><p>
示例如下,下面例子中我们的javascript函数声明了一个参数,但是可以分别使用0,1,2个参数成功调用
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">greet</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">name</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  console.log<span style="color: #6c3163;">(</span><span style="color: #2d9574;">"Hello, "</span> + name + <span style="color: #2d9574;">"!"</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>

greet<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Alice"</span><span style="color: #3a81c3;">)</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#35843;&#29992;&#26102;&#20256;&#36882;&#19968;&#20010;&#21442;&#25968;&#65292;&#36755;&#20986;: Hello, Alice!</span>
greet<span style="color: #3a81c3;">()</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#35843;&#29992;&#26102;&#27809;&#26377;&#20256;&#36882;&#21442;&#25968;&#65292;&#36755;&#20986;: Hello, undefined!</span>
greet<span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Alice"</span>, <span style="color: #2d9574;">"Bob"</span><span style="color: #3a81c3;">)</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#35843;&#29992;&#26102;&#20256;&#36882;&#20004;&#20010;&#21442;&#25968;&#65292;&#36755;&#20986;: Hello, Alice!</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Hello, Alice!</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Hello, undefined!</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Hello, Alice!</span>
</pre>
</div></li>
</ul></li>
<li>TypeScript则不可能延续这个策略,它会严格的进行测试,确保声明的函数参数和调用的函数参数数目一致
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">singTwo</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">first</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>, <span style="color: #715ab1;">second</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">first</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;"> / </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">second</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #6c3163; font-weight: bold;">singTwo</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"hello"</span>, <span style="color: #2d9574;">"world"</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">hello / world</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:10:1 - error TS2554: Expected 2 arguments, but got 1.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">singTwo("hello"); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:18:27 - error TS2554: Expected 2 arguments, but got 3.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">singTwo("hello", "world", "again"); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////</span>
</pre>
</div>
<ul class="org-ul">
<li>用上面的例子区分两个概念:
<ol class="org-ol">
<li>parameter是函数声明时候希望接受的,上面例子的first, second就是pamameter</li>
<li>argument是函数调用时候赋予的,上面例子的"hello", "world"就是argument</li>
</ol></li>
</ul></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org2df0ffd" class="outline-4">
<h4 id="org2df0ffd"><span class="section-number-4">5.1.2.</span> Optional Parameters</h4>
<div class="outline-text-4" id="text-5-1-2">
<ul class="org-ul">
<li>在javascript里面,如果一个function parameter没有被提供,那么在使用的时候,其argument就是undefined</li>
<li>typescript作为类型安全的语言,为了能够满足parameter和argument数目不一致的场景,设计了特性:optional parameter
<ul class="org-ul">
<li><p>
示例如下,我们使用`?`来标记为optional parameter,所有的这些加`?`的参数类型默认加union为`| undefined`
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">announceSong</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">song</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>, <span style="color: #715ab1;">singer?</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`Song: </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">song</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #6c3163;">)</span>;

  <span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #6c3163;">(</span>singer<span style="color: #6c3163;">)</span> <span style="color: #6c3163;">{</span>
    <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #2d9574;">(</span><span style="color: #2d9574;">`Singer: </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">singer</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #2d9574;">)</span>;
  <span style="color: #6c3163;">}</span>
<span style="color: #3a81c3;">}</span>

<span style="color: #6c3163; font-weight: bold;">announceSong</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Greensleeves"</span><span style="color: #3a81c3;">)</span>;
<span style="color: #6c3163; font-weight: bold;">announceSong</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Greensleeves"</span>, <span style="color: #4e3163;">undefined</span><span style="color: #3a81c3;">)</span>;
<span style="color: #6c3163; font-weight: bold;">announceSong</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Greensleeves"</span>, <span style="color: #2d9574;">"Sia"</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Song: Greensleeves</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Song: Greensleeves</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Song: Greensleeves</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Singer: Sia</span>
</pre>
</div></li>
<li><p>
注意,optional和"刚好加了|union的参数"不同,前者可以parameter和argument数目不一,后者不可以
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">announceSong</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">song</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>, <span style="color: #715ab1;">singer</span>: <span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #4e3163;">undefined</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`Song: </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">song</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #6c3163;">)</span>;

  <span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #6c3163;">(</span>singer<span style="color: #6c3163;">)</span> <span style="color: #6c3163;">{</span>
    <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #2d9574;">(</span><span style="color: #2d9574;">`Singer: </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">singer</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #2d9574;">)</span>;
  <span style="color: #6c3163;">}</span>
<span style="color: #3a81c3;">}</span>

<span style="color: #6c3163; font-weight: bold;">announceSong</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Greensleeves"</span>, <span style="color: #4e3163;">undefined</span><span style="color: #3a81c3;">)</span>;
<span style="color: #6c3163; font-weight: bold;">announceSong</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Greensleeves"</span>, <span style="color: #2d9574;">"Sia"</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Song: Greensleeves</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Song: Greensleeves</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Singer: Sia</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:9:1 - error TS2554: Expected 2 arguments, but got 1.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">announceSong("Greensleeves"); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
<li>optional parameter必须作为最后的参数,否则会报错
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:1:40 - error TS1016: A required parameter cannot follow an optional parameter.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">function announceSong(</span><span style="color: #715ab1;">singer?</span><span style="color: #2aa1ae; background-color: #ecf3ec;">: string, </span><span style="color: #715ab1;">song</span><span style="color: #2aa1ae; background-color: #ecf3ec;">: string) {} //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org05974fc" class="outline-4">
<h4 id="org05974fc"><span class="section-number-4">5.1.3.</span> Default Parameters</h4>
<div class="outline-text-4" id="text-5-1-3">
<ul class="org-ul">
<li>参数默认值是比optional parameter更好的一种选择,它可以让我们的parameter在没有argument的情况下给一个默认值
<ul class="org-ul">
<li><p>
typescript的default parameter示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">rateSong</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">song</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>, rating = 0<span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`|typeof rating| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">typeof rating</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #6c3163;">)</span>;
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">song</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;"> gets </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">rating</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">/5 stars!`</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #6c3163; font-weight: bold;">rateSong</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Photograph"</span><span style="color: #3a81c3;">)</span>;
<span style="color: #6c3163; font-weight: bold;">rateSong</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Set Fire to the Rain"</span>, 5<span style="color: #3a81c3;">)</span>;
<span style="color: #6c3163; font-weight: bold;">rateSong</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Set Fire to the Rain"</span>, <span style="color: #4e3163;">undefined</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|typeof rating| =&gt; number</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Photograph gets 0/5 stars!</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|typeof rating| =&gt; number</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Set Fire to the Rain gets 5/5 stars!</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|typeof rating| =&gt; number</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Set Fire to the Rain gets 0/5 stars!</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:14:22 - error TS2345: Argument of type 'string' is not assignable to parameter of type 'number'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">rateSong("At Last!", "100"); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////</span>
</pre>
</div></li>
<li>我们调用的时候,想要默认值起作用可以:
<ol class="org-ol">
<li>缺少这个参数(这个和其他语言行为一致),</li>
<li>使用undefind替代(这个是为了和javascript语言特性一致)</li>
</ol></li>
<li><p>
我们发现一旦有了default parameter,那么argument的类型就确定了,在上例中必定是number.而不是像optional
parameter一样的union类型(number | undefiend).
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">rateSong</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">song</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>, <span style="color: #715ab1;">rating?</span>: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`|typeof rating| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">typeof rating</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #6c3163;">)</span>;
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">song</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;"> gets </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">rating</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">/5 stars!`</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #6c3163; font-weight: bold;">rateSong</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Photograph"</span><span style="color: #3a81c3;">)</span>;
<span style="color: #6c3163; font-weight: bold;">rateSong</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Set Fire to the Rain"</span>, 5<span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|typeof rating| =&gt; undefined</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Photograph gets undefined/5 stars!</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|typeof rating| =&gt; number</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Set Fire to the Rain gets 5/5 stars!</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgfd17a1f" class="outline-4">
<h4 id="orgfd17a1f"><span class="section-number-4">5.1.4.</span> Rest Parameters</h4>
<div class="outline-text-4" id="text-5-1-4">
<ul class="org-ul">
<li>rest parametr也叫不定参数,是只最后一个参数可以是0个或者多个的情况
<ul class="org-ul">
<li><p>
在typescript里面,rest  parameter的类型会多一个`[]`,示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">singAllTheSongs</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">singer</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>, ...songs: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">[]</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">for</span> <span style="color: #6c3163;">(</span><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">song</span> <span style="color: #3a81c3; font-weight: bold;">of</span> songs<span style="color: #6c3163;">)</span> <span style="color: #6c3163;">{</span>
    <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #2d9574;">(</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">song</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">, by </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">singer</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #2d9574;">)</span>;
  <span style="color: #6c3163;">}</span>
<span style="color: #3a81c3;">}</span>

<span style="color: #6c3163; font-weight: bold;">singAllTheSongs</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Alicia Keys"</span><span style="color: #3a81c3;">)</span>;
<span style="color: #6c3163; font-weight: bold;">singAllTheSongs</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Lady Gaga"</span>, <span style="color: #2d9574;">"Bad Romance"</span>, <span style="color: #2d9574;">"Just Dance"</span>, <span style="color: #2d9574;">"Poker Face"</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Bad Romance, by Lady Gaga</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Just Dance, by Lady Gaga</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Poker Face, by Lady Gaga</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:18:36 - error TS2345: Argument of type 'number' is not assignable to parameter of type 'string'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">singAllTheSongs("Ella Fitzgerald", 2000); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////////</span>
</pre>
</div></li>
<li>由于rest parameter有类型要求,所以传入number类型会导致typescript报错</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orge054fa0" class="outline-3">
<h3 id="orge054fa0"><span class="section-number-3">5.2.</span> Return Types</h3>
<div class="outline-text-3" id="text-5-2">
<ul class="org-ul">
<li>TypeScript可以理解一个函数的所有可能返回值,并且给与其类型(多种返回值类型就是union类型)
<ul class="org-ul">
<li><p>
下面这个例子中,singSong返回值类型就是number
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">singSong</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">songs</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">[]</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span> songs.length;
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
<li><p>
下面这个例子中,getSongAt的返回值就是一个string | undefined了
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">getSongAt</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">songs</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">[]</span>, <span style="color: #715ab1;">index</span>: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span> index &lt; <span style="color: #ba2f59; font-weight: bold;">songs</span>.<span style="color: #ba2f59; font-weight: bold;">length</span> ? <span style="color: #ba2f59; font-weight: bold;">songs</span><span style="color: #6c3163;">[</span><span style="color: #ba2f59; font-weight: bold;">index</span><span style="color: #6c3163;">]</span> : <span style="color: #ba2f59; font-weight: bold;">undefined</span>;
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
<div id="outline-container-org6ee3455" class="outline-4">
<h4 id="org6ee3455"><span class="section-number-4">5.2.1.</span> Explicit Return Types</h4>
<div class="outline-text-4" id="text-5-2-1">
<ul class="org-ul">
<li>虽然typescript最佳实践就是不要给function明确的标记返回值类型.但是有几种特殊的情况下还是建议把返回值
类型给标记起来,这些情况分别是:
<ul class="org-ul">
<li>有很多种可能的return value,但是你希望只返回一种类型</li>
<li>typescript拒绝判断返回类型</li>
<li>在非常大的项目里面,标记函数返回类型,能减轻typescript的工作,从而提升代码检查效率,缩短时间</li>
</ul></li>
<li>下面是函数返回类型annotaion的书写方式:
<ul class="org-ul">
<li><p>
对于普通函数来说,就是在`{`之前加上类型
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">singSongRecursive</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">songs</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">[]</span>, <span style="color: #715ab1;">count</span> = 0<span style="color: #3a81c3;">)</span>: <span style="color: #3a81c3; font-weight: bold;">number</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span> songs.length ? <span style="color: #6c3163; font-weight: bold;">singSongRecursive</span><span style="color: #6c3163;">(</span>songs.<span style="color: #6c3163; font-weight: bold;">slice</span><span style="color: #2d9574;">(</span>1<span style="color: #2d9574;">)</span>, count + 1<span style="color: #6c3163;">)</span> : count;
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
<li><p>
对于arrow function来说,就是在`=&gt;`之前加上类型
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">singSongRecursive</span> = <span style="color: #3a81c3;">(</span>songs: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">[]</span>, count = 0<span style="color: #3a81c3;">)</span>: <span style="color: #3a81c3; font-weight: bold;">number</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span>
  songs.length ? <span style="color: #6c3163; font-weight: bold;">singSongRecursive</span><span style="color: #3a81c3;">(</span>songs.<span style="color: #6c3163; font-weight: bold;">slice</span><span style="color: #6c3163;">(</span>1<span style="color: #6c3163;">)</span>, count + 1<span style="color: #3a81c3;">)</span> : count;
</pre>
</div></li>
</ul></li>
<li>一旦设置的function return type,那么typescript会去进行检查的
<ul class="org-ul">
<li><p>
示例代码如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">getSongRecordingDate</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">song</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span>: <span style="color: #ba2f59; font-weight: bold;">Date</span> | <span style="color: #4e3163;">undefined</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">switch</span> <span style="color: #6c3163;">(</span>song<span style="color: #6c3163;">)</span> <span style="color: #6c3163;">{</span>
    <span style="color: #3a81c3; font-weight: bold;">case</span> <span style="color: #2d9574;">"Strange Fruit"</span>:
      <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #3a81c3; font-weight: bold;">new</span> <span style="color: #ba2f59; font-weight: bold;">Date</span><span style="color: #2d9574;">(</span><span style="color: #2d9574;">"April 20, 1939"</span><span style="color: #2d9574;">)</span>;
    <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
    <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:6:7 - error TS2322: Type 'string' is not assignable to type 'Date'.</span>

    <span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////</span>
    <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">case "Greensleeves": //</span>
    <span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">return "unknown";  //</span>
    <span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////</span>
    <span style="color: #655370; background-color: #fbf8ef;">default</span>:
      <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #4e3163;">undefined</span>;
  <span style="color: #6c3163;">}</span>
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgb982fba" class="outline-3">
<h3 id="orgb982fba"><span class="section-number-3">5.3.</span> Function Types</h3>
<div class="outline-text-3" id="text-5-3">
<ul class="org-ul">
<li>Javascript的函数是一等公民,可以把function作为value到处传递,那么我们的function也必须要有自己的类型</li>
<li>Function type和arrow function的样子很像,只不过"=&gt;"之后是返回值的类型,而不是{}
<ul class="org-ul">
<li><p>
nothingInGivesString函数是一个没有形参,返回值为string类型的函数
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">nothingInGivesString</span>: <span style="color: #3a81c3;">()</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">string</span>;
</pre>
</div></li>
<li><p>
inputAndOutput函数有一个必选参数string[]类型的songs,一个可选参数count?,返回值为number类型
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">inputAndOutput</span>: <span style="color: #3a81c3;">(</span>songs: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">[]</span>, <span style="color: #715ab1;">count</span>?: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">number</span>;
</pre>
</div></li>
</ul></li>
<li>function type的最常用的地方是callback parameter(这种参数会被像function一样被调用)
<ul class="org-ul">
<li><p>
下面就是这样一个例子,runOnSong的唯一参数就是一个callback parameter
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">songs</span> = <span style="color: #3a81c3;">[</span><span style="color: #2d9574;">"Juice"</span>, <span style="color: #2d9574;">"Shake It Off"</span>, <span style="color: #2d9574;">"What's Up"</span><span style="color: #3a81c3;">]</span>;

<span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">runOnSongs</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">getSongAtP</span>: <span style="color: #6c3163;">(</span><span style="color: #715ab1;">index</span>: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #6c3163;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">for</span> <span style="color: #6c3163;">(</span><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">i</span> = 0; i &lt; <span style="color: #ba2f59; font-weight: bold;">songs</span>.<span style="color: #ba2f59; font-weight: bold;">length</span>; <span style="color: #ba2f59; font-weight: bold;">i</span> += 1<span style="color: #6c3163;">)</span> <span style="color: #6c3163;">{</span>
    <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #2d9574;">(</span><span style="color: #6c3163; font-weight: bold;">getSongAtP</span><span style="color: #67b11d;">(</span>i<span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span>;
  <span style="color: #6c3163;">}</span>
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">getSongAt</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">index</span>: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #2d9574;">`</span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">songs[index]</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #6c3163; font-weight: bold;">runOnSongs</span><span style="color: #3a81c3;">(</span>getSongAt<span style="color: #3a81c3;">)</span>;

<span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">longSong</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">song</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #2d9574;">`</span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">song</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Juice</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Shake It Off</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">What's Up</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:24:12 - error TS2345: Argument of type '(song: string) =&gt; string' is not assignable to parameter of type '(index: number) =&gt; string'.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Types of parameters 'song' and 'index' are incompatible.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//     </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type 'number' is not assignable to type 'string'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">runOnSongs(longSong); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////</span>
</pre>
</div></li>
<li>callback pameter的类型是形参为number,返回值为string, getSongAt符合要求, logSong则不符合</li>
</ul></li>
</ul>
</div>
<div id="outline-container-org5acad59" class="outline-4">
<h4 id="org5acad59"><span class="section-number-4">5.3.1.</span> Function Type Parentheses</h4>
<div class="outline-text-4" id="text-5-3-1">
<ul class="org-ul">
<li>function type是一个比较复杂的称谓(这个称谓的中间还有空格),所以我们需要在有些情况下在function type外面加上括号</li>
<li>union type就是这样一种情况:
<ul class="org-ul">
<li><p>
如果不加括号,那么returnsStringOrUndefined的function type的类型为: function that returns a union: string | undefined
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">returnsStringOrUndefined</span>: <span style="color: #3a81c3;">()</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #4e3163;">undefined</span>;
</pre>
</div></li>
<li><p>
加了括号,那么mybeReturnsString要么是一个function that returns a string, 要么是一个undefined
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">maybeReturnsString</span>: <span style="color: #3a81c3;">(</span><span style="color: #6c3163;">()</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span> | <span style="color: #4e3163;">undefined</span>;
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org1ad536e" class="outline-4">
<h4 id="org1ad536e"><span class="section-number-4">5.3.2.</span> Parameter Type Inferences</h4>
<div class="outline-text-4" id="text-5-3-2">
<ul class="org-ul">
<li>typescript可以聪明的让我们在类型明确的情况下,少些后续的类型.
<ul class="org-ul">
<li><p>
比如下面的例子,我们已经声明了singer的类型了,那么在赋值的时候我们不需要再给song声明其为string了
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">singer</span>: <span style="color: #3a81c3;">(</span>song: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">string</span>;

singer = <span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #3a81c3;">(</span><span style="color: #715ab1;">song</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #2d9574;">`Sing: </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">song.toUpperCase()</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">!`</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span><span style="color: #6c3163; font-weight: bold;">singer</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">"Hello"</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Sing: HELLO!</span>
</pre>
</div></li>
<li><p>
因为不是stirng压根赋值不会成功,如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">singer</span>: <span style="color: #3a81c3;">(</span>song: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">string</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:3:1 - error TS2322: Type '(song: number) =&gt; string' is not assignable to type '(song: string) =&gt; string'.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Types of parameters 'song' and 'song' are incompatible.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//     </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type 'string' is not assignable to type 'number'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">singer = function (</span><span style="color: #715ab1;">song</span><span style="color: #2aa1ae; background-color: #ecf3ec;">: number) { //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">return `Sing: Something!`;       //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">};                                 //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
<li>既然"已声明对象赋值"的时候,可以被infer. 那么把"函数作为参数"传递给另外函数的时候,类型也是可以被infer
的,因为另外的函数肯定在其他地方已经声明过"函数参数"的类型了
<ul class="org-ul">
<li><p>
示例如下:
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">songs</span> = <span style="color: #3a81c3;">[</span><span style="color: #2d9574;">"Call Me"</span>, <span style="color: #2d9574;">"Jolene"</span>, <span style="color: #2d9574;">"The Chain"</span><span style="color: #3a81c3;">]</span>;

songs.<span style="color: #6c3163; font-weight: bold;">forEach</span><span style="color: #3a81c3;">(</span><span style="color: #6c3163;">(</span><span style="color: #715ab1;">song</span>, <span style="color: #715ab1;">index</span><span style="color: #6c3163;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #6c3163;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #2d9574;">(</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">song</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;"> is at index </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">index</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #2d9574;">)</span>
<span style="color: #6c3163;">}</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Call Me is at index 0</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Jolene is at index 1</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">The Chain is at index 2</span>
</pre>
</div></li>
<li>forEach的函数参数已经声明过类型了,其callbackFn参数第二个成员为number类型,这里的inde也就直接被infer
成number类型</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgdc717e4" class="outline-4">
<h4 id="orgdc717e4"><span class="section-number-4">5.3.3.</span> Function Type Aliases</h4>
<div class="outline-text-4" id="text-5-3-3">
<ul class="org-ul">
<li>type aliases 本来是实现"一人千面"作用的. 但是同时也能将复杂的类型转换成一个"看起来简单的类型"</li>
<li>function type一般来说,其都是比较复杂的类型,能够转成一个"看起来简单的类型"非常重要.
<ul class="org-ul">
<li><p>
示例如下,我们把(input: string) =&gt; number这么复杂的类型,alias成StringToNumber这么一个"看起来简单
的类型",然后这个类型还能在之后使用
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">StringToNumber</span> = <span style="color: #3a81c3;">(</span>input: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">number</span>;

<span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">stringToNumber</span>: <span style="color: #ba2f59; font-weight: bold;">StringToNumber</span>;

stringToNumber = <span style="color: #3a81c3;">(</span>input<span style="color: #3a81c3;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> input.length; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">ok</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:8:29 - error TS2322: Type 'string' is not assignable to type 'number'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">stringToNumber = (input) =&gt; input.</span><span style="color: #6c3163; font-weight: bold;">toUpperCase</span><span style="color: #2aa1ae; background-color: #ecf3ec;">(); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////////////////////////</span>
</pre>
</div></li>
<li><p>
我们当然可以把这个"看起来简单的类型"放到函数声明里面,比起原来的复杂的函数声明,当前的函数声明看起
来简单好多(虽然看起来不像function type)
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">NumberToString</span> = <span style="color: #3a81c3;">(</span>input: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">string</span>;

<span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">userNumberToString</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">numberToString</span>: <span style="color: #ba2f59; font-weight: bold;">NumberToString</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`Ths string is : </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">numberToString(123)</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #6c3163; font-weight: bold;">userNumberToString</span><span style="color: #3a81c3;">(</span><span style="color: #6c3163;">(</span>input<span style="color: #6c3163;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #2d9574;">`</span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">input</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">! Hooray`</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Ths string is : 123! Hooray</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:9:31 - error TS2322: Type 'number' is not assignable to type 'string'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">userNumberToString((input) =&gt; input * 2); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org5d21c91" class="outline-3">
<h3 id="org5d21c91"><span class="section-number-3">5.4.</span> More Return Types</h3>
<div class="outline-text-3" id="text-5-4">
</div>
<div id="outline-container-org4670b4b" class="outline-4">
<h4 id="org4670b4b"><span class="section-number-4">5.4.1.</span> Void Returns</h4>
<div class="outline-text-4" id="text-5-4-1">
<ul class="org-ul">
<li>void return是绝大多数typescript都有的特性,其主要处理如下两种情况:
<ul class="org-ul">
<li>函数体没有return关键字</li>
<li>函数体的return后面直接就是分号,没返回任何东西</li>
</ul></li>
<li>void return一旦声明了之后,是不允许返回任何值的
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">songLogger</span>: <span style="color: #3a81c3;">(</span>song: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">void</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:5:3 - error TS2322: Type 'boolean' is not assignable to type 'void'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">songLogger = (</span><span style="color: #715ab1;">song</span><span style="color: #2aa1ae; background-color: #ecf3ec;">): void =&gt; { //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">console.</span><span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #2aa1ae; background-color: #ecf3ec;">(`${song}`);      //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">return true;                 //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">};                             //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
<li>void return在function type里面非常重要,因为"=&gt;"后面必须得有点东西
<ul class="org-ul">
<li><p>
示例如下,注意声明时候的void在"=&gt;"后面,调用的时候void在"=&gt;"前面
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">songLogger</span>: <span style="color: #3a81c3;">(</span>song: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">void</span>;

songLogger = <span style="color: #3a81c3;">(</span><span style="color: #715ab1;">song</span><span style="color: #3a81c3;">)</span>: <span style="color: #3a81c3; font-weight: bold;">void</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">song</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #6c3163; font-weight: bold;">songLogger</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Heart of Glass"</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Heart of Glass</span>
</pre>
</div></li>
</ul></li>
<li>注意,void是typescript里面的一个type,其和undefined是不一样的,两者不可以相互赋值
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">returnsVoid</span><span style="color: #3a81c3;">()</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">lazyValue</span>: <span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #4e3163;">undefined</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:7:1 - error TS2322: Type 'void' is not assignable to type 'string | undefined'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">lazyValue = returnsVoid(); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////</span>
</pre>
</div></li>
<li><p>
注意上面的例子中function returnsVoid()并没有明确的写出返回值类型,那么其实是可以返回任意类型的,只
不过代码里面return;让Typescript编译器直接给他确认了返回值类型是void.如果你的代码里面有其他逻辑,可
以返回不同类型,编译器甚至能判断出这些类型!
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">returnsVoid</span><span style="color: #3a81c3;">()</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #6c3163;">(</span>Math.<span style="color: #6c3163; font-weight: bold;">random</span><span style="color: #2d9574;">()</span> &gt; 0.5<span style="color: #6c3163;">)</span> <span style="color: #6c3163;">{</span>
    <span style="color: #3a81c3; font-weight: bold;">return</span> 123;
  <span style="color: #6c3163;">}</span> <span style="color: #3a81c3; font-weight: bold;">else</span> <span style="color: #6c3163;">{</span>
    <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #2d9574;">"123"</span>;
  <span style="color: #6c3163;">}</span>
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">lazyValue</span>: <span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #4e3163;">undefined</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:14:1 - error TS2322: Type '123 | "123"' is not assignable to type 'string | undefined'.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type 'number' is not assignable to type 'string'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">lazyValue = returnsVoid(); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
<li>void返回值的定义会产生一个问题,比如forEach函数,其要求第一个参数callbackFn的返回值为void,这样可以警
告forEach,不要去使用这个callbackFn的返回值.
<ul class="org-ul">
<li><p>
如果真的严格要求,那么我们的forEach只能这样调用
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">records</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">[]</span> = <span style="color: #3a81c3;">[]</span>;
<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>records<span style="color: #3a81c3;">)</span>;

<span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">saveRecords</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">newRecords</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">[]</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  newRecords.<span style="color: #6c3163; font-weight: bold;">forEach</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">(</span><span style="color: #715ab1;">record</span><span style="color: #2d9574;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #2d9574;">{</span>
    records.<span style="color: #6c3163; font-weight: bold;">push</span><span style="color: #67b11d;">(</span>record<span style="color: #67b11d;">)</span>;
  <span style="color: #2d9574;">}</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #6c3163; font-weight: bold;">saveRecords</span><span style="color: #3a81c3;">(</span><span style="color: #6c3163;">[</span><span style="color: #2d9574;">"21"</span>, <span style="color: #2d9574;">"Come On Over"</span>, <span style="color: #2d9574;">"The Bodyguard"</span><span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>records<span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">[]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">[ '21', 'Come On Over', 'The Bodyguard' ]</span>
</pre>
</div></li>
<li><p>
但实际上,我们可以不要这个括号也能调用,这算是Typescript为数不多的"委曲求全",默认了也能在void返回值
的时候返回非void,只是用void警告大家不要使用这个返回值就可以了.
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">records</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">[]</span> = <span style="color: #3a81c3;">[]</span>;
<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>records<span style="color: #3a81c3;">)</span>;

<span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">saveRecords</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">newRecords</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">[]</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  newRecords.<span style="color: #6c3163; font-weight: bold;">forEach</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">(</span>record<span style="color: #2d9574;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> records.<span style="color: #6c3163; font-weight: bold;">push</span><span style="color: #2d9574;">(</span>record<span style="color: #2d9574;">)</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #6c3163; font-weight: bold;">saveRecords</span><span style="color: #3a81c3;">(</span><span style="color: #6c3163;">[</span><span style="color: #2d9574;">"21"</span>, <span style="color: #2d9574;">"Come On Over"</span>, <span style="color: #2d9574;">"The Bodyguard"</span><span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>records<span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">[]</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">[ '21', 'Come On Over', 'The Bodyguard' ]</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org639e7b5" class="outline-4">
<h4 id="org639e7b5"><span class="section-number-4">5.4.2.</span> Never Returns</h4>
<div class="outline-text-4" id="text-5-4-2">
<ul class="org-ul">
<li>never return是处理如下两种情况:
<ul class="org-ul">
<li><p>
总数抛出异常,例子如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">fail</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">message</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span>: <span style="color: #3a81c3; font-weight: bold;">never</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">throw</span> <span style="color: #3a81c3; font-weight: bold;">new</span> <span style="color: #ba2f59; font-weight: bold;">Error</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`Invariant failure: </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">message</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">.`</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">workWithUnsafeParam</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">param</span>: <span style="color: #3a81c3; font-weight: bold;">unknown</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #6c3163;">(</span><span style="color: #3a81c3; font-weight: bold;">typeof</span> param != <span style="color: #2d9574;">"string"</span><span style="color: #6c3163;">)</span> <span style="color: #6c3163;">{</span>
    <span style="color: #6c3163; font-weight: bold;">fail</span><span style="color: #2d9574;">(</span><span style="color: #2d9574;">`param should be a string, not </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">typeof param</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #2d9574;">)</span>
  <span style="color: #6c3163;">}</span>

  param.<span style="color: #6c3163; font-weight: bold;">toUpperCase</span><span style="color: #6c3163;">()</span>;
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
<li>无限循环,但是不返回.这种不太常见.</li>
</ul></li>
<li>注意,never和void不一样:
<ul class="org-ul">
<li>never是一个函数永远都不返回值</li>
<li>void是函数返回的值nothing,提醒使用者不用使用这个nothing</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org8bf5b5e" class="outline-3">
<h3 id="org8bf5b5e"><span class="section-number-3">5.5.</span> Function Overloads</h3>
<div class="outline-text-3" id="text-5-5">
<ul class="org-ul">
<li>函数重载是编程语言经典的特性.typescript自然也是支持的
<ul class="org-ul">
<li><p>
下面就是一个重载的例子.
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">createDate</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">timestamp</span>: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">)</span>: <span style="color: #ba2f59; font-weight: bold;">Date</span>;
<span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">createDate</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">month</span>: <span style="color: #3a81c3; font-weight: bold;">number</span>, <span style="color: #715ab1;">day</span>: <span style="color: #3a81c3; font-weight: bold;">number</span>, <span style="color: #715ab1;">year</span>: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">)</span>: <span style="color: #ba2f59; font-weight: bold;">Date</span>;

<span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">createDate</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">monthOrTimestamp</span>: <span style="color: #3a81c3; font-weight: bold;">number</span>, <span style="color: #715ab1;">day?</span>: <span style="color: #3a81c3; font-weight: bold;">number</span>, <span style="color: #715ab1;">year?</span>: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span> day === <span style="color: #4e3163;">undefined</span> || year === <span style="color: #4e3163;">undefined</span>
    ? <span style="color: #3a81c3; font-weight: bold;">new</span> <span style="color: #ba2f59; font-weight: bold;">Date</span><span style="color: #6c3163;">(</span><span style="color: #715ab1;">monthOrTimestamp</span><span style="color: #6c3163;">)</span>
    : <span style="color: #3a81c3; font-weight: bold;">new</span> <span style="color: #ba2f59; font-weight: bold;">Date</span><span style="color: #6c3163;">(</span>year, monthOrTimestamp, day<span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #6c3163; font-weight: bold;">createDate</span><span style="color: #3a81c3;">(</span>554356800<span style="color: #3a81c3;">)</span>;
<span style="color: #6c3163; font-weight: bold;">createDate</span><span style="color: #3a81c3;">(</span>7, 27, 1987<span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:13:1 - error TS2575: No overload expects 2 arguments, but overloads do exist that expect either 1 or 3 arguments.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">createDate(3, 1); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////</span>
</pre>
</div></li>
<li>注意上面的前两个是函数声明,第三个是函数实现.第三个函数实现虽然是支持两个参数调用的,但是由于声明的
时候没有两个参数的版本,所以调用两个参数的版本会失败</li>
<li><p>
上面重载的例子,其实就是在转换为javascript之后,会把代码改变成如下javascript逻辑,可以看到,已经完全
没有重载的痕迹了.
</p>
<div class="org-src-container">
<pre class="src src-js"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">createDate</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">monthOrTimestamp</span>, <span style="color: #715ab1;">day</span>, <span style="color: #715ab1;">year</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span> day === <span style="color: #4e3163;">undefined</span> || year === <span style="color: #4e3163;">undefined</span>
    ? <span style="color: #3a81c3; font-weight: bold;">new</span> <span style="color: #ba2f59; font-weight: bold;">Datre</span><span style="color: #6c3163;">(</span>monthOrTimestamp<span style="color: #6c3163;">)</span>
    : <span style="color: #3a81c3; font-weight: bold;">new</span> <span style="color: #ba2f59; font-weight: bold;">Datre</span><span style="color: #6c3163;">(</span>year, monthOrTimestamp, day<span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
<div id="outline-container-orgb3f0bde" class="outline-4">
<h4 id="orgb3f0bde"><span class="section-number-4">5.5.1.</span> Call-Signature Compatibility</h4>
<div class="outline-text-4" id="text-5-5-1">
<ul class="org-ul">
<li>由于typescript的重载办法,是在编译成javascript的时候,依靠逻辑来重写代码.那么我们就要求参数必须能够
相互转换(对位assignable),比如上一节例子中的timestamp和month都是string
<ul class="org-ul">
<li><p>
下面的例子中,第三个函数就因为无法和第一个函数对位assign,所以重载失败了
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">format</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">data</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">format</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">data</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>, <span style="color: #715ab1;">needle</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>, <span style="color: #715ab1;">haystack</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:4:10 - error TS2394: This overload signature is not compatible with its implementation signature.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">function format(</span><span style="color: #715ab1;">getData</span><span style="color: #2aa1ae; background-color: #ecf3ec;">: () =&gt; </span><span style="color: #715ab1;">string</span><span style="color: #2aa1ae; background-color: #ecf3ec;">): string; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////////</span>

<span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">format</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">data</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>, <span style="color: #715ab1;">needle?</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>, <span style="color: #715ab1;">haystack?</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span> needle &amp;&amp; haystack ? data.<span style="color: #6c3163; font-weight: bold;">replace</span><span style="color: #6c3163;">(</span><span style="color: #715ab1;">needle</span>, <span style="color: #715ab1;">haystack</span><span style="color: #6c3163;">)</span> : data;
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-orga912e60" class="outline-2">
<h2 id="orga912e60"><span class="section-number-2">6.</span> Chapter 6: Arrays</h2>
<div class="outline-text-2" id="text-6">
</div>
<div id="outline-container-orgb44d4b4" class="outline-3">
<h3 id="orgb44d4b4"><span class="section-number-3">6.1.</span> Array Types</h3>
<div class="outline-text-3" id="text-6-1">
<ul class="org-ul">
<li>变量一般声明的时候,都是没有value的.array也同样,所以我们必须为"空的array"创建一个声明样式
<ul class="org-ul">
<li><p>
typescript肯定是希望你一开始就把array里面放置什么类型给标记出来的,如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">arrayOfNumbbers</span>: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">[]</span>;

arrayOfNumbbers = <span style="color: #3a81c3;">[</span>1, 2, 3, 4, 5<span style="color: #3a81c3;">]</span>;
</pre>
</div></li>
<li>我们甚至可以使用Array&lt;number&gt;来替代number[],但是这种写法不太受欢迎</li>
</ul></li>
</ul>
</div>
<div id="outline-container-org1109f5d" class="outline-4">
<h4 id="org1109f5d"><span class="section-number-4">6.1.1.</span> Array and Function Types</h4>
<div class="outline-text-4" id="text-6-1-1">
<ul class="org-ul">
<li>我们之前说过,本身function type由于其类型过长,就容易需要配合(). 如果function type再加上array,那么使
用括号的概率,就更高了
<ul class="org-ul">
<li><p>
第一个例子函数的类型是: function that returns an array of strings
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">createStrings</span>: <span style="color: #3a81c3;">()</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">[]</span>;
</pre>
</div></li>
<li><p>
第二个例子函数的类型是: functions that each return a string
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">strignCreators</span>: <span style="color: #3a81c3;">(</span><span style="color: #6c3163;">()</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)[]</span>;
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org8ab0817" class="outline-4">
<h4 id="org8ab0817"><span class="section-number-4">6.1.2.</span> Union Type Arrays</h4>
<div class="outline-text-4" id="text-6-1-2">
<ul class="org-ul">
<li>array里面可以使用union type来明确array里面的成员可以是union中的一种.这种情况下,()的使用概率也很高:
<ul class="org-ul">
<li><p>
第一个例子变量的类型是: either a number or an array of strings
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">stringOrArrayOfNumbers</span>: <span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">[]</span>;
</pre>
</div></li>
<li><p>
第二个例子变量的类型是: an array of elements that ar each either a number or a string
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">arrayOfStringOrNumbers</span>: <span style="color: #3a81c3;">(</span><span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">)[]</span>;
</pre>
</div></li>
</ul></li>
<li>如果一个typescript没有明确的declare它的类型,那么Typescript会自己infer这个数组的类型(通过数组中的数据)
<ul class="org-ul">
<li><p>
比如下面的例子中,我们可以通过错误提示来发现namesMaybe的类型
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">namesMaybe</span> = <span style="color: #3a81c3;">[</span><span style="color: #2d9574;">"Aqualtune"</span>, <span style="color: #2d9574;">"Blenda"</span>, <span style="color: #4e3163;">undefined</span><span style="color: #3a81c3;">]</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:3:5 - error TS2322: Type '(string | undefined)[]' is not assignable to type 'number'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">let tmp: number = namesMaybe; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org49e43d8" class="outline-4">
<h4 id="org49e43d8"><span class="section-number-4">6.1.3.</span> Evolving Any Arrays</h4>
<div class="outline-text-4" id="text-6-1-3">
<ul class="org-ul">
<li>如果声明数组的时候,没有写具体的类型,那么就相当于是any[]</li>
<li>any[]不是Typescript所希望的类型,因为这样配置失去了typescript的优势:类型. 所以typescript会随着any[]
数组里面增加不同类型的成员,而动态的改变自己的类型
<ul class="org-ul">
<li><p>
比如下面例子中,数组的类型从any[]到string[],再到(number | string)[]
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">values</span> = <span style="color: #3a81c3;">[]</span>;                <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type: any[]</span>
values.<span style="color: #6c3163; font-weight: bold;">push</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">""</span><span style="color: #3a81c3;">)</span>;                <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #715ab1;">Type</span><span style="color: #2aa1ae; background-color: #ecf3ec;">: string[]</span>
values<span style="color: #3a81c3;">[</span>0<span style="color: #3a81c3;">]</span> = 0;                  <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type: (number | string)[]</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgc425901" class="outline-4">
<h4 id="orgc425901"><span class="section-number-4">6.1.4.</span> Multidimensional Arrays</h4>
<div class="outline-text-4" id="text-6-1-4">
<ul class="org-ul">
<li>作为2D数组,我们会有两个[]
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">arrayOfArraysOfNumbers</span>: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">[][]</span>;

arrayOfArraysOfNumbers = <span style="color: #3a81c3;">[</span>
  <span style="color: #6c3163;">[</span>1, 2, 3<span style="color: #6c3163;">]</span>,
  <span style="color: #6c3163;">[</span>2, 4, 6<span style="color: #6c3163;">]</span>,
  <span style="color: #6c3163;">[</span>3, 6, 9<span style="color: #6c3163;">]</span>,
<span style="color: #3a81c3;">]</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>arrayOfArraysOfNumbers<span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">[ [ 1, 2, 3 ], [ 2, 4, 6 ], [ 3, 6, 9 ] ]</span>
</pre>
</div></li>
</ul></li>
<li>对于3D数组,那么就会有3个[], 4D数组,会有4个[],5D数组,会有5个[].依此类推</li>
<li>多维数组其实只是语法糖.如下两种情况其实是等价的:
<ul class="org-ul">
<li>number[][]</li>
<li>(number[])[]</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgffcaf25" class="outline-3">
<h3 id="orgffcaf25"><span class="section-number-3">6.2.</span> Array Members</h3>
<div class="outline-text-3" id="text-6-2">
<ul class="org-ul">
<li>typescript可以理解数组[index]得到的数据的类型:
<ul class="org-ul">
<li><p>
如果数组是string[],那么数组[index]类型是string,这个容易理解
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">defenders</span> = <span style="color: #3a81c3;">[</span><span style="color: #2d9574;">"Clarenza"</span>, <span style="color: #2d9574;">"Dina"</span><span style="color: #3a81c3;">]</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type: string</span>
<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">defender</span> = defenders<span style="color: #3a81c3;">[</span>0<span style="color: #3a81c3;">]</span>;
</pre>
</div></li>
<li><p>
如果数组是(string | Date)[],那么数组[index]类型是 string | Date.这个有点反直觉,本以为Typescript能
够判断出具体类型的
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">soldersOrDates</span> = <span style="color: #3a81c3;">[</span><span style="color: #2d9574;">"Deborah Sampson"</span>, <span style="color: #3a81c3; font-weight: bold;">new</span> <span style="color: #ba2f59; font-weight: bold;">Date</span><span style="color: #6c3163;">(</span>1782, 6, 3<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">]</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type: Date | string</span>
<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">soldersOrDate</span> = soldersOrDates<span style="color: #3a81c3;">[</span>0<span style="color: #3a81c3;">]</span>;
</pre>
</div></li>
</ul></li>
</ul>
</div>
<div id="outline-container-orgab669fd" class="outline-4">
<h4 id="orgab669fd"><span class="section-number-4">6.2.1.</span> Caveat: Unsound Members</h4>
<div class="outline-text-4" id="text-6-2-1">
<ul class="org-ul">
<li>有个术语叫做unsound,意思就是说类型判断大多数情况下是准确的,但不是每次都是准确的. Typescript的type
system就是unsound的
<ul class="org-ul">
<li><p>
示例如下, typescript在compile time没有发现9001是一个错误的index
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TypeError: Cannot read properties of undefined (reading 'length')</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">function withElements(</span><span style="color: #715ab1;">elements</span><span style="color: #2aa1ae; background-color: #ecf3ec;">: string[]) { //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">console.</span><span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #2aa1ae; background-color: #ecf3ec;">(elements[9001].length);       //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">}                                           //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//                                             </span><span style="color: #2aa1ae; background-color: #ecf3ec;">//</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">withElements(["A", "AB", "ABC"])            //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////</span>
</pre>
</div></li>
<li>虽然也有报错,但是我们看到这个错误是一个runtime错误</li>
<li>如果我们设置&#x2013;noUncheckedIndexedAccess flag那么能够捕捉到这个错误,但是这个flag太严格了,几乎没有项
目使用这个flag</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgdbc408b" class="outline-3">
<h3 id="orgdbc408b"><span class="section-number-3">6.3.</span> Spreads and Rests</h3>
<div class="outline-text-3" id="text-6-3">
<ul class="org-ul">
<li>前面我们用过"&#x2026;"这个操作符,其在typescript里面和javascript的左右是一样的.:
<ul class="org-ul">
<li><p>
array spreading
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">fruits</span> = <span style="color: #3a81c3;">[</span><span style="color: #2d9574;">"apple"</span>, <span style="color: #2d9574;">"banana"</span>, <span style="color: #2d9574;">"orange"</span><span style="color: #3a81c3;">]</span>;
<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">moreFruits</span> = <span style="color: #3a81c3;">[</span><span style="color: #2d9574;">"grape"</span>, ...fruits, <span style="color: #2d9574;">"pineapple"</span><span style="color: #3a81c3;">]</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>moreFruits<span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">[ 'grape', 'apple', 'banana', 'orange', 'pineapple' ]</span>
</pre>
</div></li>
<li><p>
rest parameter
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">sum</span><span style="color: #3a81c3;">(</span>...<span style="color: #715ab1;">numbers</span>: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #6c3163;">[]</span><span style="color: #3a81c3;">)</span>: <span style="color: #3a81c3; font-weight: bold;">number</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span> numbers.<span style="color: #6c3163; font-weight: bold;">reduce</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">(</span>total, num<span style="color: #2d9574;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> total + num, 0<span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">totalSum</span> = <span style="color: #6c3163; font-weight: bold;">sum</span><span style="color: #3a81c3;">(</span>1, 2, 3, 4, 5<span style="color: #3a81c3;">)</span>;
<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>totalSum<span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">15</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
<div id="outline-container-org8a39350" class="outline-4">
<h4 id="org8a39350"><span class="section-number-4">6.3.1.</span> Spreads</h4>
<div class="outline-text-4" id="text-6-3-1">
<ul class="org-ul">
<li>Typescript足够聪明,可以知道两个不同类型的数组spread在一块得到的新数组,其类型是两个类型的union
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">soldiers</span> = <span style="color: #3a81c3;">[</span><span style="color: #2d9574;">"Harriet Tubman"</span>, <span style="color: #2d9574;">"Joan of Arc"</span>, <span style="color: #2d9574;">"Khutulun"</span><span style="color: #3a81c3;">]</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type: string[]</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">soldierAges</span> = <span style="color: #3a81c3;">[</span>90, 19, 45<span style="color: #3a81c3;">]</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type: number[]</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">conjoined</span> = <span style="color: #3a81c3;">[</span>...soldiers, ...soldier<span style="color: #3a81c3;">]</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Type: (string | number)[]</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orga18d930" class="outline-4">
<h4 id="orga18d930"><span class="section-number-4">6.3.2.</span> Spreading Rest Parameters</h4>
<div class="outline-text-4" id="text-6-3-2">
<ul class="org-ul">
<li>如果"&#x2026;"作为rest parameters,那么我们的typescript就会进行严格检查了,不符合规定的实参传递不进去
<ul class="org-ul">
<li><p>
示例如下, string[]可以传入, number[]不能传入
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">logWarriers</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">greeting</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>, ...names: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">[]</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">for</span> <span style="color: #6c3163;">(</span><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">name</span> <span style="color: #3a81c3; font-weight: bold;">of</span> names<span style="color: #6c3163;">)</span> <span style="color: #6c3163;">{</span>
    <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #2d9574;">(</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">greeting</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">, </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">name</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">!`</span><span style="color: #2d9574;">)</span>;
  <span style="color: #6c3163;">}</span>
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">warriors</span> = <span style="color: #3a81c3;">[</span><span style="color: #2d9574;">"Cathay Williams"</span>, <span style="color: #2d9574;">"Lozen"</span>, <span style="color: #2d9574;">"Nzinga"</span><span style="color: #3a81c3;">]</span>;
<span style="color: #6c3163; font-weight: bold;">logWarriers</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Hello"</span>, ...warriors<span style="color: #3a81c3;">)</span>;

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">brithYears</span> = <span style="color: #3a81c3;">[</span>1844, 1840, 1583<span style="color: #3a81c3;">]</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Hello, Cathay Williams!</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Hello, Lozen!</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Hello, Nzinga!</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:11:22 - error TS2345: Argument of type 'number' is not assignable to parameter of type 'string'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">logWarriers("Hello", ...brithYears); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org1b2c9ee" class="outline-3">
<h3 id="org1b2c9ee"><span class="section-number-3">6.4.</span> Tuples</h3>
<div class="outline-text-3" id="text-6-4">
<ul class="org-ul">
<li>所谓tuple,就是fixed size array. 在python中也有tuple这个概念,typescript是对这个概念的增强:因为typescript
自己有类型系统.所以typescript的tuple包含了如下两层含义:
<ul class="org-ul">
<li>fixed size</li>
<li>type for each index</li>
</ul></li>
<li>tuple需要为每个index都声明类型,这些类型组成的数组又标明了其fixed的长度
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">yearAndWarrier</span>: <span style="color: #3a81c3;">[</span><span style="color: #3a81c3; font-weight: bold;">number</span>, <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">]</span>;
yearAndWarrier = <span style="color: #3a81c3;">[</span>530, <span style="color: #2d9574;">"Tomyris"</span><span style="color: #3a81c3;">]</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:3:19 - error TS2322: Type 'boolean' is not assignable to type 'number'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">yearAndWarrier = [false, "Tomyris"]; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////////////</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:11:1 - error TS2322: Type '[number]' is not assignable to type '[number, string]'.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Source has 1 element(s) but target requires 2.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">yearAndWarrier = [530]; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////</span>
</pre>
</div></li>
</ul></li>
<li>tuple最常用的场景是array destructuring, 其作用是一次性assign多个value
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #3a81c3;">[</span><span style="color: #715ab1;">year</span>, <span style="color: #715ab1;">warrier</span><span style="color: #3a81c3;">]</span> =
  Math.<span style="color: #6c3163; font-weight: bold;">random</span><span style="color: #3a81c3;">()</span> &gt; 0.5 ? <span style="color: #3a81c3;">[</span>340, <span style="color: #2d9574;">"Archidamia"</span><span style="color: #3a81c3;">]</span> : <span style="color: #3a81c3;">[</span>1828, <span style="color: #2d9574;">"Rani of Jhansi"</span><span style="color: #3a81c3;">]</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">`|year| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">year</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3;">)</span>;
<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">`|warrier| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">warrier</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT1====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|year| =&gt; 1828</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|warrier| =&gt; Rani of Jhansi</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT2====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|year| =&gt; 340</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|warrier| =&gt; Archidamia</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
<div id="outline-container-orgd77a9f6" class="outline-4">
<h4 id="orgd77a9f6"><span class="section-number-4">6.4.1.</span> Tuple Assignability</h4>
<div class="outline-text-4" id="text-6-4-1">
<ul class="org-ul">
<li>由于tuple的类型信息里面包括了每个index的类型,所以tuple是比array更加specific的类型,那么我们很显然是
没办法把array赋值给tuple的
<ul class="org-ul">
<li><p>
下面就是这样一个例子,我们的pairLosse这个数组不是我们想象的[boolean, number],其类型其实是(boolean | number)[],
那么显然其无法赋值给类型我[boolean, number]的tuple
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">pairLosse</span> = <span style="color: #3a81c3;">[</span><span style="color: #4e3163;">false</span>, 123<span style="color: #3a81c3;">]</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:3:7 - error TS2322: Type '(number | boolean)[]' is not assignable to type '[boolean, number]'.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Target requires 2 element(s) but source may have fewer.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const pairTupleLoose: [boolean, number] = pairLosse; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
<li>不同长度的tuple,显然是无法赋值的.这个很显然
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">tupleThree</span>: <span style="color: #3a81c3;">[</span><span style="color: #3a81c3; font-weight: bold;">boolean</span>, <span style="color: #3a81c3; font-weight: bold;">number</span>, <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">]</span> = <span style="color: #3a81c3;">[</span><span style="color: #4e3163;">false</span>, 1583, <span style="color: #2d9574;">"Nzinga"</span><span style="color: #3a81c3;">]</span>;
<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">tupleTwoExact1</span>: <span style="color: #3a81c3;">[</span><span style="color: #3a81c3; font-weight: bold;">boolean</span>, <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">]</span> = <span style="color: #3a81c3;">[</span>tupleThree<span style="color: #6c3163;">[</span>0<span style="color: #6c3163;">]</span>, tupleThree<span style="color: #6c3163;">[</span>1<span style="color: #6c3163;">]</span><span style="color: #3a81c3;">]</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:3:7 - error TS2322: Type '[boolean, number, string]' is not assignable to type '[boolean, number]'.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Source has 3 element(s) but target allows only 2.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const tupleTwoExact2: [boolean, number] = tupleThree; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
<li>由于tuple包含了fixed数组和每个index的类型信息,其非常适合作为rest parameter传递给函数
<ul class="org-ul">
<li><p>
示例如下,tuple可以赋值给函数,其类型在每个index上面是确定的
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">logPair</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">name</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>, <span style="color: #715ab1;">value</span>: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">name</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;"> has </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">value</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">pairTupleCorrect</span>: <span style="color: #3a81c3;">[</span><span style="color: #3a81c3; font-weight: bold;">string</span>, <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">]</span> = <span style="color: #3a81c3;">[</span><span style="color: #2d9574;">"Amage"</span>, 1<span style="color: #3a81c3;">]</span>;
<span style="color: #6c3163; font-weight: bold;">logPair</span><span style="color: #3a81c3;">(</span>...pairTupleCorrect<span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Amage has 1</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">pairTupleIncorrect</span>: <span style="color: #3a81c3;">[</span><span style="color: #3a81c3; font-weight: bold;">number</span>, <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">]</span> = <span style="color: #3a81c3;">[</span>1, <span style="color: #2d9574;">"Amage"</span><span style="color: #3a81c3;">]</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:6:9 - error TS2345: Argument of type 'number' is not assignable to parameter of type 'string'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">logPair(...pairTupleIncorrect); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">pairArray</span> = <span style="color: #3a81c3;">[</span><span style="color: #2d9574;">"Amage"</span>, 1<span style="color: #3a81c3;">]</span>;
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:6:9 - error TS2556: A spread argument must either have a tuple type or be passed to a rest parameter.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">logPair(...pairArray); //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////</span>
</pre>
</div></li>
<li>作为反例,index类型不正确的tuple是赋值不成功的</li>
<li>作为另一个反例,数组也不能赋值给函数,其类型是union()</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org79b9985" class="outline-4">
<h4 id="org79b9985"><span class="section-number-4">6.4.2.</span> Tuple Inferences</h4>
<div class="outline-text-4" id="text-6-4-2">
<ul class="org-ul">
<li>Typescript总体上,如果不特殊配置,都是把"[]"的代码都解释为variable length array的,而不是tuple
<ul class="org-ul">
<li><p>
示例如下,下面的函数把其返回值给infer成(string | number)[]
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">firstCharAndSize</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">input</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #6c3163;">[</span>input<span style="color: #2d9574;">[</span>0<span style="color: #2d9574;">]</span>, input.length<span style="color: #6c3163;">]</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #3a81c3;">[</span><span style="color: #715ab1;">firstChar</span>, <span style="color: #715ab1;">size</span><span style="color: #3a81c3;">]</span> = <span style="color: #6c3163; font-weight: bold;">firstCharAndSize</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Gudit"</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:7:7 - error TS2322: Type 'string | number' is not assignable to type 'strng</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const tmp: string = firstChar; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
<li>Typescript如果经过如下两种"特殊配置",那么就可以把"[]"解析成tuple:
<ul class="org-ul">
<li>explicit tuple type</li>
<li>const assertion</li>
</ul></li>
</ul>
</div>
<ol class="org-ol">
<li><a id="orgc02c0cf"></a>Explicit tuple types<br />
<div class="outline-text-5" id="text-6-4-2-1">
<ul class="org-ul">
<li>如果一个函数的返回值明确的描述了自己要返回一个tuple type,并且代码里面使用了array literal(也就是"[]")
那么这种情况下,这个array literal会被infer成一个tuple,而不是数组
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">firstCharAndSizeExplicit</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">input</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span>: <span style="color: #3a81c3;">[</span><span style="color: #3a81c3; font-weight: bold;">string</span>, <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #3a81c3;">]</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #6c3163;">[</span>input<span style="color: #2d9574;">[</span>0<span style="color: #2d9574;">]</span>, input.length<span style="color: #6c3163;">]</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #3a81c3;">[</span><span style="color: #715ab1;">firstChar</span>, <span style="color: #715ab1;">size</span><span style="color: #3a81c3;">]</span> = <span style="color: #6c3163; font-weight: bold;">firstCharAndSizeExplicit</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Cathay Williams"</span><span style="color: #3a81c3;">)</span>;

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">typeStr</span>: <span style="color: #3a81c3; font-weight: bold;">string</span> = firstChar;
<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">typeNum</span>: <span style="color: #3a81c3; font-weight: bold;">number</span> = size;
</pre>
</div></li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org4e4cb3b"></a>Const asserted tuples<br />
<div class="outline-text-5" id="text-6-4-2-2">
<ul class="org-ul">
<li>如果每次都把类型明确的写出来,不仅非常的累,而且在更新代码的时候,还要同时更新这些类型,所以Typescript
也为我们提供了一种能够把array litral("[]")给直接解释成tuple的语法糖, as const
<ul class="org-ul">
<li><p>
示例如下,下面例子中的readonlyTuple就别infer成了tuple
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">unionArray</span> = <span style="color: #3a81c3;">[</span>1157, <span style="color: #2d9574;">"Tomo"</span><span style="color: #3a81c3;">]</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:3:7 - error TS2322: Type '(string | number)[]' is not assignable to type 'string'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const typeStr: string = unionArray; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">readonlyTuple</span> = <span style="color: #3a81c3;">[</span>1157, <span style="color: #2d9574;">"Tomoe"</span><span style="color: #3a81c3;">]</span> <span style="color: #3a81c3; font-weight: bold;">as</span> <span style="color: #3a81c3; font-weight: bold;">const</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:12:7 - error TS2322: Type 'readonly [1157, "Tomoe"]' is not assignable to type 'string'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const typeStr: string = readonlyTuple; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////</span>
</pre>
</div></li>
<li>从上面的例子中我们也可以看到使用as const返回的不仅仅是tuple,而是加了一个readonly的tuple,也就是readonly [1157, "Tomoe"]</li>
</ul></li>
<li>上面as const的副作用就是我们得到的tuple不仅仅是tuple,其是readonly的.这个readonly还不仅仅是对象不能重复被assign,而是每个成员都不能改动.
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">pairMutable</span>: <span style="color: #3a81c3;">[</span><span style="color: #3a81c3; font-weight: bold;">number</span>, <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">]</span> = <span style="color: #3a81c3;">[</span>1157, <span style="color: #2d9574;">"Tomoe"</span><span style="color: #3a81c3;">]</span>;
pairMutable<span style="color: #3a81c3;">[</span>0<span style="color: #3a81c3;">]</span> = 1247; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Ok</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">The type 'readonly [1157, "Tomoe"]' is 'readonly' and cannot be assigned to the mutable type '[number, string]'. (typescript-tide)</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const pairAlsoMutable: [number, string] = [1157, "Tomoe"] as const; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">/////////////////////////////////////////////////////////////////////////</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">pairConst</span> = <span style="color: #3a81c3;">[</span>1157, <span style="color: #2d9574;">"Tomoe"</span><span style="color: #3a81c3;">]</span> <span style="color: #3a81c3; font-weight: bold;">as</span> <span style="color: #3a81c3; font-weight: bold;">const</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:11:11 - error TS2540: Cannot assign to '0' because it is a read-only property.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">pairConst[0] = 1247; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////</span>
</pre>
</div></li>
</ul></li>
<li>在实践当中,read-only tuple最合适的使用场景是function return, 因为函数的返回值往往非常快的就被destructure
掉.用户只关心从function return里面取值,不关心其是否const
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">firstCharAndSizeAsConst</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">input</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #6c3163;">[</span>input<span style="color: #2d9574;">[</span>0<span style="color: #2d9574;">]</span>, input.length<span style="color: #6c3163;">]</span> <span style="color: #3a81c3; font-weight: bold;">as</span> <span style="color: #3a81c3; font-weight: bold;">const</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #3a81c3;">[</span><span style="color: #715ab1;">firstChar</span>, <span style="color: #715ab1;">size</span><span style="color: #3a81c3;">]</span> = <span style="color: #6c3163; font-weight: bold;">firstCharAndSizeAsConst</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"Ching Shih"</span><span style="color: #3a81c3;">)</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">`|firstChar| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">firstChar</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3;">)</span>;
<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">`|size| =&gt; </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">size</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|firstChar| =&gt; C</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">|size| =&gt; 10</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-org718e7b3" class="outline-2">
<h2 id="org718e7b3"><span class="section-number-2">7.</span> Chapter 7: Interfaces</h2>
<div class="outline-text-2" id="text-7">
<ul class="org-ul">
<li>我们前面主要介绍了type,其主要功能是describe object shape</li>
<li>而本章介绍的interface,其主要功能也是describe shape,interface的功能和type基本一致,但是多数情况下,
interface更应该被Typescript开发者所选择,因为其:
<ul class="org-ul">
<li>错误信息更加友好</li>
<li>编译器能更加快速编译</li>
<li>和class更好的进行配合</li>
</ul></li>
</ul>
</div>
<div id="outline-container-org4099eeb" class="outline-3">
<h3 id="org4099eeb"><span class="section-number-3">7.1.</span> Type Aliases Versus Intrfaces</h3>
<div class="outline-text-3" id="text-7-1">
<ul class="org-ul">
<li>我们用下面的代码来对比下type和Interface
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">type</span> <span style="color: #ba2f59; font-weight: bold;">Poet1</span> = <span style="color: #3a81c3;">{</span>
  born: <span style="color: #3a81c3; font-weight: bold;">number</span>;
  name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">Poet2</span> <span style="color: #3a81c3;">{</span>
  born: <span style="color: #3a81c3; font-weight: bold;">number</span>;
  name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
<li>我们可以看到,两者的syntax基本一致</li>
<li>但是type的最后有分号,而interface最后没有.这个可以从javascript的规范来推导:
<ol class="org-ol">
<li>javascript里面创建一个变量是加分号的</li>
<li>javascript里面创建一个class或者function是不加分号的</li>
</ol></li>
</ul></li>
<li>Type和interface有如下根本上的不同:
<ul class="org-ul">
<li>interface是可以把多个interface合成一个的</li>
<li>interface是可以type check class 声明的,但是type不行</li>
<li>interface的编译更快</li>
<li>interface被编译器认为是"named object", 而type被编译器认为是"alias for an unnamed object literal",
所以显然interface的错误信息更易读</li>
</ul></li>
<li><p>
上面虽然都是区别,但是很显然凸显出interface的优势.最佳实践中,我们会默认使用interface,直到你遇到必须
使用type的情况,比如union type(required)或者是function type(cleaner syntax)
</p>
<pre class="example" id="orgb7a66aa">
Use interfaces whenever possible, until you need features such as union types(required)
or function type (cleaner syntax)
</pre></li>
</ul>
</div>
</div>
<div id="outline-container-org0f9270c" class="outline-3">
<h3 id="org0f9270c"><span class="section-number-3">7.2.</span> Type of Proprties</h3>
<div class="outline-text-3" id="text-7-2">
<ul class="org-ul">
<li>真实世界的javascript object非常灵活(比如可选的property, setter和getter等), 为了能够适配这些灵活的情况,
typescript创建了一系列的type system tool</li>
<li>下面会介绍这些system tool,多说一句,这些tool竟然都能在type上面使用.可见type和interface有多相似.</li>
</ul>
</div>
<div id="outline-container-org62ece3d" class="outline-4">
<h4 id="org62ece3d"><span class="section-number-4">7.2.1.</span> Optional Properties</h4>
<div class="outline-text-4" id="text-7-2-1">
<ul class="org-ul">
<li>我们前面介绍object type的时候介绍过,某个object满足某个type可以有"可选的property",interface也同样拥有这个特性
<ul class="org-ul">
<li><p>
示例如下,任何object只需要pages存在,既可以被认为是Book interface
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">Book</span> <span style="color: #3a81c3;">{</span>
  author?: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  pages: <span style="color: #3a81c3; font-weight: bold;">number</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">ok</span>: <span style="color: #ba2f59; font-weight: bold;">Book</span> = <span style="color: #3a81c3;">{</span>
  author: <span style="color: #2d9574;">"Rita Dove"</span>,
  pages: 80,
<span style="color: #3a81c3;">}</span>;

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">missing</span>: <span style="color: #ba2f59; font-weight: bold;">Book</span> = <span style="color: #3a81c3;">{</span>
  pages: 80,
<span style="color: #3a81c3;">}</span>;
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgf1ec6b3" class="outline-4">
<h4 id="orgf1ec6b3"><span class="section-number-4">7.2.2.</span> Read-Only Properties</h4>
<div class="outline-text-4" id="text-7-2-2">
<ul class="org-ul">
<li>typescript的interface可以设置某些property为readonly,一旦设置,那么实现这个interface的object的相应
property不能在初始化之后再被赋值
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">Page</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">readonly</span> text: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">read</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">page</span>: <span style="color: #ba2f59; font-weight: bold;">Page</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span>page.text<span style="color: #6c3163;">)</span>;

  <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
  <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:8:8 - error TS2540: Cannot assign to 'text' because it is a read-only property.</span>

  <span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////</span>
  <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">page.text += "!"; //</span>
  <span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////</span>
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
<li>需要注意的是,readonly这个标签,只有像上面例子一样,某个object"显式地"和某个interface发生映射关系的
时候才起作用. 下面例子中的page2 虽然也"隐式"的符合interface Page,但是在没有被read函数"显式"的指派
给Page interface之前,是可以随便改动text的</li>
</ul></li>
<li>需要理解的是,readonly这个特性是类型系统的typescript才有的,目的也是在编译阶段进行检查,最终编译成javascript
之后,就不存在这个特性了</li>
</ul>
</div>
</div>
<div id="outline-container-org1f97a98" class="outline-4">
<h4 id="org1f97a98"><span class="section-number-4">7.2.3.</span> Functions and Methods</h4>
<div class="outline-text-4" id="text-7-2-3">
<ul class="org-ul">
<li>在javascript里面function作为object的member是很正常的事情, 所以作为object的抽象interface,其也会允许
声明interface member的类型为function type</li>
<li>typescript提供了两种声明interface function memeber 的方式,其实是映射了两种javascript定义function的
方式(arrow和非arrow):
<ul class="org-ul">
<li>method syntax:对应常规函数,this会在调用时候动态绑定,适合class的instance使用</li>
<li>property syntax:对应箭头函数,this在创建时候就绑定,除了class的instance以外的情况都使用这个</li>
</ul></li>
<li>我们来看一个interface的例子,其中混合使用了两种function member的声明方式:
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">HasBothFunctionTypes</span> <span style="color: #3a81c3;">{</span>
  property: <span style="color: #6c3163;">()</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">string</span>;
  <span style="color: #6c3163; font-weight: bold;">method</span><span style="color: #6c3163;">()</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">hasBoth</span>: <span style="color: #ba2f59; font-weight: bold;">HasBothFunctionTypes</span> = <span style="color: #3a81c3;">{</span>
  property: <span style="color: #6c3163;">()</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #2d9574;">"property return"</span>,
  <span style="color: #6c3163; font-weight: bold;">method</span><span style="color: #6c3163;">()</span> <span style="color: #6c3163;">{</span>
    <span style="color: #3a81c3; font-weight: bold;">return</span> <span style="color: #2d9574;">"method return"</span>;
  <span style="color: #6c3163;">}</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>hasBoth.<span style="color: #6c3163; font-weight: bold;">property</span><span style="color: #6c3163;">()</span><span style="color: #3a81c3;">)</span>;
<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>hasBoth.<span style="color: #6c3163; font-weight: bold;">method</span><span style="color: #6c3163;">()</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">property return</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">method return</span>
</pre>
</div></li>
<li><p>
上面的每种形式也支持使用?来配置成optional参数
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">OptionalFunctions</span> <span style="color: #3a81c3;">{</span>
  property?: <span style="color: #6c3163;">()</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">string</span>;
  method?<span style="color: #6c3163;">()</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
<li><p>
readonly只能在method 声明上面使用
</p>
<div class="org-src-container">
<pre class="src src-typescript">jinterface ReadonlyFunctions <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">readonly</span> property: <span style="color: #6c3163;">()</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">string</span>;
  <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
  <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:3:3 - error TS1024: 'readonly' modifier can only appear on a property declaration or index signature.</span>

  <span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////</span>
  <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">readonly method(): string; //</span>
  <span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////</span>
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org9a98dc8" class="outline-4">
<h4 id="org9a98dc8"><span class="section-number-4">7.2.4.</span> Call Signatures</h4>
<div class="outline-text-4" id="text-7-2-4">
<ul class="org-ul">
<li>call signature是一个非常重要的特性,其用来描述一个value是如何能被像function一样调用的</li>
<li>上面这句定义非常难懂,其实也没有什么意义.我们通过例子来了解call signature在interface的三个主要使用
场景:
<ul class="org-ul">
<li><p>
interface通常描述一个类型,但是有时候interface描述的本身就是一个function(function也是一个类型)
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">StringToNumberConverter</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #6c3163;">(</span>input: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">)</span>: <span style="color: #3a81c3; font-weight: bold;">number</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">stringLength</span>: <span style="color: #ba2f59; font-weight: bold;">StringToNumberConverter</span> = <span style="color: #3a81c3;">(</span><span style="color: #715ab1;">input</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #3a81c3; font-weight: bold;">return</span> input.length;
<span style="color: #3a81c3;">}</span>

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span><span style="color: #6c3163; font-weight: bold;">stringLength</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">"Hello"</span><span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">5</span>
</pre>
</div></li>
<li><p>
interface通常描述一个类型,很多的时候,这个类型是一个对象,那么这个对象里面就得有对应的函数才行.这个
时候call signature要有函数名
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">PriceCalculator</span> <span style="color: #3a81c3;">{</span>
  calculatePrice: <span style="color: #6c3163;">(</span>quantity: <span style="color: #3a81c3; font-weight: bold;">number</span>, pricePerUnit: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #6c3163;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">number</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">calculator</span>: <span style="color: #ba2f59; font-weight: bold;">PriceCalculator</span> = <span style="color: #3a81c3;">{</span>
  calculatePrice: <span style="color: #6c3163;">(</span><span style="color: #715ab1;">quantity</span>, <span style="color: #715ab1;">pricePreUnit</span><span style="color: #6c3163;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #6c3163;">{</span>
    <span style="color: #3a81c3; font-weight: bold;">return</span> quantity * pricePreUnit;
  <span style="color: #6c3163;">}</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>calculator.<span style="color: #6c3163; font-weight: bold;">calculatePrice</span><span style="color: #6c3163;">(</span>5, 10<span style="color: #6c3163;">)</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">50</span>
</pre>
</div></li>
<li><p>
interface描述的本身就是一个function,然后这个function还有一些自己的变量.这属于第一种情况的扩展
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">Logger</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #6c3163;">(</span>message: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">)</span>: <span style="color: #3a81c3; font-weight: bold;">void</span>;
  logLevel: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">myLogger</span>: <span style="color: #ba2f59; font-weight: bold;">Logger</span> = <span style="color: #3a81c3;">(</span><span style="color: #715ab1;">message</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">`[</span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">myLogger.logLevel</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">] </span><span style="color: #3a81c3; font-weight: bold;">${</span><span style="color: #655370; background-color: #fbf8ef;">message</span><span style="color: #3a81c3; font-weight: bold;">}</span><span style="color: #2d9574;">`</span><span style="color: #6c3163;">)</span>;
<span style="color: #3a81c3;">}</span>;
myLogger.logLevel = <span style="color: #2d9574;">"INFO"</span>;

<span style="color: #6c3163; font-weight: bold;">myLogger</span><span style="color: #3a81c3;">(</span><span style="color: #2d9574;">"This is a log message."</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">[INFO] This is a log message.</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org10cf8fe" class="outline-4">
<h4 id="org10cf8fe"><span class="section-number-4">7.2.5.</span> Index Signatures</h4>
<div class="outline-text-4" id="text-7-2-5">
<ul class="org-ul">
<li>有时候,你无法提前知道某个类型所有属性的名字,但是你知道这些属性值的类型(属性通常是字符串或者能转换成
字符串的类型,比如字符串,symbol, 所以这里强调属性值的类型)</li>
<li>在这种情况下,你可以使用index signature(索引签名)去描述可能的key和value的类型
<ul class="org-ul">
<li><p>
示例如下,只有number类型的value可以赋值成功
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">WordCounts</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #6c3163;">[</span>i: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">]</span>: <span style="color: #3a81c3; font-weight: bold;">number</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">counts</span>: <span style="color: #ba2f59; font-weight: bold;">WordCounts</span> = <span style="color: #3a81c3;">{}</span>;
counts.apple = 0;
counts.banana = 1;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>counts<span style="color: #6c3163;">[</span><span style="color: #2d9574;">"apple"</span><span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>;
<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>counts<span style="color: #6c3163;">[</span><span style="color: #2d9574;">"banana"</span><span style="color: #6c3163;">]</span><span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">0</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">1</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:12:1 - error TS2322: Type 'boolean' is not assignable to type 'number'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">counts.cherry = false; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////</span>
</pre>
</div></li>
</ul></li>
<li><p>
Index signature的存在的意义是:一个对象必须返回一个value,不管对象触发的property是什么.所以index signature
的重点,在于"不管触发的property是什么",而不在于typesafe
</p>
<pre class="example" id="org1fc3190">
Index Signature indicates that an object should give back a value no matter
what proprty is being accessed
</pre></li>
<li>下面例子就是这样一种情况, publishDate的Beloved明明没设置,但是还是返回值了(undefined)
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">DatesByName</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #6c3163;">[</span>i: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">]</span>: <span style="color: #ba2f59; font-weight: bold;">Date</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">publishDates</span>: <span style="color: #ba2f59; font-weight: bold;">DatesByName</span> = <span style="color: #3a81c3;">{</span>
  Frankenstein: <span style="color: #3a81c3; font-weight: bold;">new</span> <span style="color: #ba2f59; font-weight: bold;">Date</span><span style="color: #6c3163;">(</span><span style="color: #2d9574;">"1 January 1818"</span><span style="color: #6c3163;">)</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>publishDates.Frankenstein<span style="color: #3a81c3;">)</span>;

<span style="color: #ba2f59; font-weight: bold;">console</span>.<span style="color: #6c3163; font-weight: bold;">log</span><span style="color: #3a81c3;">(</span>publishDates.Beloved<span style="color: #3a81c3;">)</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&lt;====================OUTPUT====================&gt;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">1817-12-31T15:54:17.000Z</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">undefined</span>
</pre>
</div></li>
<li>上面这种情况下更应该的选择是Map</li>
</ul></li>
</ul>
</div>
<ol class="org-ol">
<li><a id="org912d1a6"></a>Mixing properties and index signatures<br />
<div class="outline-text-5" id="text-7-2-5-1">
<ul class="org-ul">
<li><p>
interface 甚至可以把index signature和一个具体的named property并列的列出来. 但是需要注意的是:
</p>
<pre class="example" id="org5ec3617">
这个named property的key和value,必须能够assign给index signature
</pre></li>
<li>换句话说,就是named property列出大的范围, named property是这个大的范围里面的一个特例.这个特例也要符
合大的范围,并且object是必须要有property满足这个特例的,其他的property满足大范围就可以了
<ul class="org-ul">
<li><p>
完全匹配的例子(完全匹配必然可以assign)如下. 注意这例子中的`i`是一个占位符,其可以随意更改,必须改成`key`,这里写成`i`是因为这里代表index signature
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">HistorialNovels</span> <span style="color: #3a81c3;">{</span>
  Oroonoko: <span style="color: #3a81c3; font-weight: bold;">number</span>;
  <span style="color: #6c3163;">[</span>i: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">]</span>: <span style="color: #3a81c3; font-weight: bold;">number</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">novels</span>: <span style="color: #ba2f59; font-weight: bold;">HistorialNovels</span> = <span style="color: #3a81c3;">{</span>
  Outlander: 1991,
  Oroonoko: 1688,
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:11:7 - error TS2741: Property 'Oroonoko' is missing in type '{ Outlander: number; }' but required in type 'HistorialNovels'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const missingOroonoko: HistorialNovels = { //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Outlander: 1991,                         //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">};                                         //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////////////</span>
</pre>
</div></li>
<li><p>
不完全匹配,但是可以assign的例子如下(0作为primitive是可以assign给number的,类似的还有literal可以assign给string)
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">ChapterStarts</span> <span style="color: #3a81c3;">{</span>
  preface: 0;
  <span style="color: #6c3163;">[</span>i: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">]</span>: <span style="color: #3a81c3; font-weight: bold;">number</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">correctPreface</span>: <span style="color: #ba2f59; font-weight: bold;">ChapterStarts</span> = <span style="color: #3a81c3;">{</span>
  preface: 0,
  night: 1,
  shopping: 5,
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:13:3 - error TS2322: Type '1' is not assignable to type '0'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const wrongPreface: ChapterStarts = { //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">preface: 1,                         //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">};                                    //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</li>
<li><a id="orgebf893d"></a>Numeric index signatures<br />
<div class="outline-text-5" id="text-7-2-5-2">
<ul class="org-ul">
<li>虽然绝大部分情况下,我们使用string来作为object的key(因为javascript其实是隐式的将object key转换为string
的),但是也有时候,特别是在typescript里面,我们会以number来作为key.</li>
<li>不过这个number key其地位是类似named property,是一个特例,其还是要在string key限定的范围里面
<ul class="org-ul">
<li><p>
示例如下, [i:number]: string 是一个特例,类似上面的preface:0, 其value类型string必须能赋给catchall的string index
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">MoreNarrowNumbers</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #6c3163;">[</span>i: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">]</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  <span style="color: #6c3163;">[</span>i: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #6c3163;">]</span>: <span style="color: #3a81c3; font-weight: bold;">string</span> | <span style="color: #4e3163;">undefined</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">mixesNumberAndString</span>: <span style="color: #ba2f59; font-weight: bold;">MoreNarrowNumbers</span> = <span style="color: #3a81c3;">{</span>
  0: <span style="color: #2d9574;">""</span>,
  key1: <span style="color: #2d9574;">""</span>,
  key2: <span style="color: #4e3163;">undefined</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:3:3 - error TS2413: 'number' index type 'string | undefined' is not assignable to 'string' index type 'string'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">interface MoreNarrowStrings {      //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">[i: number]: string | undefined; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">[i: string]: string;             //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">}                                  //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">////////////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</li>
</ol>
</div>
<div id="outline-container-orgee471d5" class="outline-4">
<h4 id="orgee471d5"><span class="section-number-4">7.2.6.</span> Nested Interfaces</h4>
<div class="outline-text-4" id="text-7-2-6">
<ul class="org-ul">
<li>就像object typeA可以nested成为 object typeB的property, interfaceA也能作为其他interface的property
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">Novel</span> <span style="color: #3a81c3;">{</span>
  author: <span style="color: #6c3163;">{</span>
    name: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  <span style="color: #6c3163;">}</span>;
  setting: <span style="color: #ba2f59; font-weight: bold;">Settings</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">Settings</span> <span style="color: #3a81c3;">{</span>
  place: <span style="color: #3a81c3; font-weight: bold;">string</span>;
  year: <span style="color: #3a81c3; font-weight: bold;">number</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">myNovel</span>: <span style="color: #ba2f59; font-weight: bold;">Novel</span>;

myNovel = <span style="color: #3a81c3;">{</span>
  author: <span style="color: #6c3163;">{</span>
    name: <span style="color: #2d9574;">"Jane Austen"</span>,
  <span style="color: #6c3163;">}</span>,
  setting: <span style="color: #6c3163;">{</span>
    place: <span style="color: #2d9574;">"England"</span>,
    year: 1812,
  <span style="color: #6c3163;">}</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:29:3 - error TS2741: Property 'year' is missing in type '{ place: string; }' but required in type 'Settings'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">myNovel = {                  //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">author: {                  //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//     </span><span style="color: #2aa1ae; background-color: #ecf3ec;">name: "Emilly Bronte",   //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">},                         //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">setting: {                 //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//     </span><span style="color: #2aa1ae; background-color: #ecf3ec;">place: "West Yorkshire", //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">},                         //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">};                           //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org8c36bad" class="outline-3">
<h3 id="org8c36bad"><span class="section-number-3">7.3.</span> Interface Extensions</h3>
<div class="outline-text-3" id="text-7-3">
<ul class="org-ul">
<li>和java一样typescript的interface可以进行"继承",方法就是使用extends关键字
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">Writing</span> <span style="color: #3a81c3;">{</span>
  title: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">Novella</span> <span style="color: #3a81c3; font-weight: bold;">extends</span> <span style="color: #ba2f59; font-weight: bold;">Writing</span> <span style="color: #3a81c3;">{</span>
  pages: <span style="color: #3a81c3; font-weight: bold;">number</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">let</span> <span style="color: #715ab1;">myNovella</span>: <span style="color: #ba2f59; font-weight: bold;">Novella</span> = <span style="color: #3a81c3;">{</span>
  pages: 195,
  title: <span style="color: #2d9574;">"Ethan Frome"</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:14:5 - error TS2741: Property 'pages' is missing in type '{ title: string; }' but required in type 'Novella'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">let missingPages: Novella = { //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">title: "The Awakening",     //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">};                            //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
<div id="outline-container-orgaf74dde" class="outline-4">
<h4 id="orgaf74dde"><span class="section-number-4">7.3.1.</span> Overridden Properties</h4>
<div class="outline-text-4" id="text-7-3-1">
<ul class="org-ul">
<li>derive interface 可以override base interface的property.这里的override和cpp里面的override是不一样的,
这里的override是说新的overridden property,比如能够assign 给base property:</li>
<li>assignable的方法一般有两种:
<ul class="org-ul">
<li><p>
使用subset of a typeo union
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#29238;&#25509;&#21475;</span>
<span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">Base</span> <span style="color: #3a81c3;">{</span>
  status: <span style="color: #2d9574;">"active"</span> | <span style="color: #2d9574;">"inactive"</span> | <span style="color: #2d9574;">"archived"</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#32852;&#21512;&#31867;&#22411;</span>
<span style="color: #3a81c3;">}</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#27966;&#29983;&#25509;&#21475;</span>
<span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">Derived</span> <span style="color: #3a81c3; font-weight: bold;">extends</span> <span style="color: #ba2f59; font-weight: bold;">Base</span> <span style="color: #3a81c3;">{</span>
  status: <span style="color: #2d9574;">"active"</span> | <span style="color: #2d9574;">"inactive"</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#26356;&#20855;&#20307;&#30340;&#23376;&#38598;&#31867;&#22411;</span>
<span style="color: #3a81c3;">}</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#31034;&#20363;&#20351;&#29992;</span>
<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">item1</span>: <span style="color: #ba2f59; font-weight: bold;">Derived</span> = <span style="color: #3a81c3;">{</span>
  status: <span style="color: #2d9574;">"active"</span>, <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#21512;&#27861;</span>
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:17:3 - error TS2322: Type '"archived"' is not assignable to type '"active" | "inactive"'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const item2: Derived = { //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">status: "archived",    //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">};                       //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////</span>
</pre>
</div></li>
<li><p>
使用从base interface type extend出来的type
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#29238;&#25509;&#21475;</span>
<span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">Base</span> <span style="color: #3a81c3;">{</span>
  details: <span style="color: #6c3163;">{</span>
    id: <span style="color: #3a81c3; font-weight: bold;">number</span>;
  <span style="color: #6c3163;">}</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#22522;&#30784;&#31867;&#22411;</span>
<span style="color: #3a81c3;">}</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#27966;&#29983;&#25509;&#21475;</span>
<span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">Derived</span> <span style="color: #3a81c3; font-weight: bold;">extends</span> <span style="color: #ba2f59; font-weight: bold;">Base</span> <span style="color: #3a81c3;">{</span>
  details: <span style="color: #6c3163;">{</span>
    id: <span style="color: #3a81c3; font-weight: bold;">number</span>;
    name: <span style="color: #3a81c3; font-weight: bold;">string</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#26032;&#22686;&#23383;&#27573;</span>
  <span style="color: #6c3163;">}</span>; <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#25193;&#23637;&#31867;&#22411;</span>
<span style="color: #3a81c3;">}</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#31034;&#20363;&#20351;&#29992;</span>
<span style="color: #3a81c3; font-weight: bold;">const</span> <span style="color: #715ab1;">item1</span>: <span style="color: #ba2f59; font-weight: bold;">Derived</span> = <span style="color: #3a81c3;">{</span>
  details: <span style="color: #6c3163;">{</span>
    id: 1,
    name: <span style="color: #2d9574;">"Item 1"</span>, <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#21512;&#27861;&#65292;&#22240;&#20026;&#27966;&#29983;&#25509;&#21475;&#25193;&#23637;&#20102;&#29238;&#25509;&#21475;&#30340;&#23646;&#24615;</span>
  <span style="color: #6c3163;">}</span>,
<span style="color: #3a81c3;">}</span>;

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:25:3 - error TS2741: Property 'name' is missing in type '{ id: number; }' but required in type '{ id: number; name: string; }'.</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">const item2: Derived = { //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">details: {             //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//     </span><span style="color: #2aa1ae; background-color: #ecf3ec;">id: 2,               //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//     </span><span style="color: #2aa1ae; background-color: #ecf3ec;">// name &#32570;&#22833;         //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">},                     //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">};                       //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//////////////////////////////</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org9cdd0f4" class="outline-4">
<h4 id="org9cdd0f4"><span class="section-number-4">7.3.2.</span> Extending Multiple Interfaces</h4>
<div class="outline-text-4" id="text-7-3-2">
<ul class="org-ul">
<li>interface的extends可以extends多个不同的interface,用","隔开
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">GivesNumber</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #6c3163; font-weight: bold;">giveNumber</span><span style="color: #6c3163;">()</span>: <span style="color: #3a81c3; font-weight: bold;">number</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">GivesString</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #6c3163; font-weight: bold;">giveString</span><span style="color: #6c3163;">()</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">GivesBothAndEither</span> <span style="color: #3a81c3; font-weight: bold;">extends</span> <span style="color: #ba2f59; font-weight: bold;">GivesNumber</span>, GivesString <span style="color: #3a81c3;">{</span>
  <span style="color: #6c3163; font-weight: bold;">giveEither</span><span style="color: #6c3163;">()</span>: <span style="color: #3a81c3; font-weight: bold;">number</span> | <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">function</span> <span style="color: #6c3163; font-weight: bold;">useGivesBoth</span><span style="color: #3a81c3;">(</span><span style="color: #715ab1;">instance</span>: <span style="color: #ba2f59; font-weight: bold;">GivesBothAndEither</span><span style="color: #3a81c3;">)</span> <span style="color: #3a81c3;">{</span>
  instance.<span style="color: #6c3163; font-weight: bold;">giveEither</span><span style="color: #6c3163;">()</span>;
  instance.<span style="color: #6c3163; font-weight: bold;">giveNumber</span><span style="color: #6c3163;">()</span>;
  instance.<span style="color: #6c3163; font-weight: bold;">giveString</span><span style="color: #6c3163;">()</span>;
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org722a274" class="outline-3">
<h3 id="org722a274"><span class="section-number-3">7.4.</span> Interface Merging</h3>
<div class="outline-text-3" id="text-7-4">
<ul class="org-ul">
<li>Interface Merging是typescript中非常特殊的特性,在其他语言中很少见.interface merging是说在同一个scope
定义的两个名字相同的interface,那么他们自动合并成一个更大的interface
<ul class="org-ul">
<li><p>
示例如下
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">Merged</span> <span style="color: #3a81c3;">{</span>
  fromFirst: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">Merged</span> <span style="color: #3a81c3;">{</span>
  fromSecond: <span style="color: #3a81c3; font-weight: bold;">number</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Equivalent to</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">interface Merged {    //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">fromFirst: string;  //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">//   </span><span style="color: #2aa1ae; background-color: #ecf3ec;">fromSecond: number; //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">}                     //</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////</span>
</pre>
</div></li>
</ul></li>
<li>注意:Interface merging是一个让代码不容易被人理解的特性,普通程序不建议使用</li>
</ul>
</div>
<div id="outline-container-orgdd0e722" class="outline-4">
<h4 id="orgdd0e722"><span class="section-number-4">7.4.1.</span> Member Naming Conflicts</h4>
<div class="outline-text-4" id="text-7-4-1">
<ul class="org-ul">
<li>虽然我们不会太使用interface merging,但是我们这里还是介绍一下interface merging在property和method方
面的一个不同:
<ul class="org-ul">
<li><p>
在不同的merging interfaces里面是不能定义"名字相同,但是类型不同的"property的(arrow function)
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">MergedProperties</span> <span style="color: #3a81c3;">{</span>
  same: <span style="color: #6c3163;">(</span>input: <span style="color: #3a81c3; font-weight: bold;">boolean</span><span style="color: #6c3163;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">string</span>;
  different: <span style="color: #6c3163;">(</span>input: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">MergedProperties</span> <span style="color: #3a81c3;">{</span>
  same: <span style="color: #6c3163;">(</span>input: <span style="color: #3a81c3; font-weight: bold;">boolean</span><span style="color: #6c3163;">)</span> <span style="color: #3a81c3; font-weight: bold;">=&gt;</span> <span style="color: #3a81c3; font-weight: bold;">string</span>;

  <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">TSError: &#10799; Unable to compile TypeScript:</span>
  <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">main.ts:8:3 - error TS2717: Subsequent property declarations must have the same type.  Property 'different' must be of type '(input: string) =&gt; string', but here has type '(input: number) =&gt; string'.</span>

  <span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////</span>
  <span style="color: #2aa1ae; background-color: #ecf3ec;">// </span><span style="color: #2aa1ae; background-color: #ecf3ec;">different: (input: number) =&gt; string; //</span>
  <span style="color: #2aa1ae; background-color: #ecf3ec;">///////////////////////////////////////////</span>
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
<li><p>
在不同的merging interfaces里面是可以定义"名字相同,但是类型不同的"method的(非arrow function)
</p>
<div class="org-src-container">
<pre class="src src-typescript"><span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">MergedMethods</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #6c3163; font-weight: bold;">different</span><span style="color: #6c3163;">(</span><span style="color: #715ab1;">input</span>: <span style="color: #3a81c3; font-weight: bold;">string</span><span style="color: #6c3163;">)</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>

<span style="color: #3a81c3; font-weight: bold;">interface</span> <span style="color: #ba2f59; font-weight: bold;">MergedMethods</span> <span style="color: #3a81c3;">{</span>
  <span style="color: #6c3163; font-weight: bold;">different</span><span style="color: #6c3163;">(</span><span style="color: #715ab1;">input</span>: <span style="color: #3a81c3; font-weight: bold;">number</span><span style="color: #6c3163;">)</span>: <span style="color: #3a81c3; font-weight: bold;">string</span>;
<span style="color: #3a81c3;">}</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: harrifeng@outlook.com</p>
<p class="date">Created: 2025-03-27 Thu 10:58</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>