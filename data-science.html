<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2021-10-02 Sat 23:53 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>data-science</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="harrifeng@outlook.com" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">data-science</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org373cde1">1. Chapter 1: Introduction</a>
<ul>
<li><a href="#orgcce458e">1.1. The Ascendance of Data</a></li>
<li><a href="#orgccedc3b">1.2. What Is Data Science?</a></li>
<li><a href="#org0cc3bb9">1.3. Motivating Hypothetical: DataSciencester</a>
<ul>
<li><a href="#org95c980c">1.3.1. Finding Key Connectors</a></li>
<li><a href="#orgf4e1bb4">1.3.2. Data Scientists You May Know</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgfc0c911">2. Chapter 2: A Crash Course on Python</a></li>
<li><a href="#org8cd6056">3. Chapter 3: Visualizing Data</a></li>
<li><a href="#org710ec3e">4. Chapter 4: Linear Algrebra</a>
<ul>
<li><a href="#org9fc76b9">4.1. Vectors</a></li>
<li><a href="#orgd617ea9">4.2. Matrices</a></li>
</ul>
</li>
<li><a href="#org779499b">5. Chapter 5: Statistics</a>
<ul>
<li><a href="#orgab67491">5.1. Describing a Single Set of Data</a>
<ul>
<li><a href="#org57ed77b">5.1.1. Central Tendencies</a></li>
<li><a href="#org189ee62">5.1.2. Dispersion(离散)</a></li>
</ul>
</li>
<li><a href="#org74817df">5.2. Correlation</a></li>
<li><a href="#org736f70a">5.3. Simpson's Paradox</a></li>
<li><a href="#org252503e">5.4. Some Other Correlational Caveats</a></li>
<li><a href="#orgb48c106">5.5. Correlation and Causation</a></li>
</ul>
</li>
<li><a href="#orgabfb383">6. Chapter 6: Probability</a>
<ul>
<li><a href="#org49f1ba0">6.1. Dependence and Independence</a></li>
<li><a href="#orgcf307c9">6.2. Conditional Probability</a></li>
<li><a href="#orgcd08f3f">6.3. Bayes's Theorem</a></li>
<li><a href="#org56f5d56">6.4. Random Variables</a></li>
<li><a href="#org7517724">6.5. Continuous Distributions</a></li>
<li><a href="#orgc08a2d7">6.6. The Normal Distribution</a></li>
<li><a href="#orgb6acdef">6.7. The Central Limit Theorem</a></li>
</ul>
</li>
<li><a href="#orge5a71c8">7. Chapter 7: Hypothesis and Inference</a>
<ul>
<li><a href="#orga4ab9c9">7.1. Statistical Hypothesis Testing</a></li>
<li><a href="#org53961ae">7.2. Example: Flipping a Coin</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-org373cde1" class="outline-2">
<h2 id="org373cde1"><span class="section-number-2">1</span> Chapter 1: Introduction</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgcce458e" class="outline-3">
<h3 id="orgcce458e"><span class="section-number-3">1.1</span> The Ascendance of Data</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>当今世界,几乎所有的硬件软件网站都在搜集各种信息.信息爆炸已经是事实</li>
</ul>
</div>
</div>
<div id="outline-container-orgccedc3b" class="outline-3">
<h3 id="orgccedc3b"><span class="section-number-3">1.2</span> What Is Data Science?</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li><p>
我们把数据科学家定义为从杂乱数据中获取对事物深刻认识的人
</p>
<pre class="example" id="orgf05b4b8">
Data scientist is someone who extracts insights from messy data.
</pre></li>
</ul>
</div>
</div>
<div id="outline-container-org0cc3bb9" class="outline-3">
<h3 id="org0cc3bb9"><span class="section-number-3">1.3</span> Motivating Hypothetical: DataSciencester</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>本书通过解决工作当中遇到的问题来学习data science</li>
</ul>
</div>
<div id="outline-container-org95c980c" class="outline-4">
<h4 id="org95c980c"><span class="section-number-4">1.3.1</span> Finding Key Connectors</h4>
<div class="outline-text-4" id="text-1-3-1">
<ul class="org-ul">
<li><p>
假设你第一天入职DS公司,你的VP对于公司的用户有很多的疑问想来问你,为此他给了你一份类似如下的数据
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #076678;">users</span> = [
<span style="background-color: #ebdbb2;"> </span>   {<span style="color: #79740e;">"id"</span>: 0, <span style="color: #79740e;">"name"</span>: <span style="color: #79740e;">"Hero"</span>},
<span style="background-color: #ebdbb2;"> </span>   {<span style="color: #79740e;">"id"</span>: 1, <span style="color: #79740e;">"name"</span>: <span style="color: #79740e;">"Dunn"</span>},
<span style="background-color: #ebdbb2;"> </span>   {<span style="color: #79740e;">"id"</span>: 2, <span style="color: #79740e;">"name"</span>: <span style="color: #79740e;">"Sue"</span>},
]
</pre>
</div></li>
<li><p>
另外他给了你一份代表所有用户友情关系的数据
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #076678;">friendship_pairs</span> = [(0, 1), (0, 2), (1, 2)]
</pre>
</div></li>
<li>其中每个tuple代表一段友谊,比如(0,1)代表id为0和id为1的两个用户是朋友.</li>
<li><p>
这种表示方式如果想找id为1的用户的朋友,就比较麻烦,我们要遍历所有的用户.一个可行的办法,是创建一个
user id为key, 其朋友id为value的dict
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #076678;">users</span> = [
<span style="background-color: #ebdbb2;"> </span>   {<span style="color: #79740e;">"id"</span>: 0, <span style="color: #79740e;">"name"</span>: <span style="color: #79740e;">"Hero"</span>},
<span style="background-color: #ebdbb2;"> </span>   {<span style="color: #79740e;">"id"</span>: 1, <span style="color: #79740e;">"name"</span>: <span style="color: #79740e;">"Dunn"</span>},
<span style="background-color: #ebdbb2;"> </span>   {<span style="color: #79740e;">"id"</span>: 2, <span style="color: #79740e;">"name"</span>: <span style="color: #79740e;">"Sue"</span>},
<span style="background-color: #ebdbb2;"> </span>   {<span style="color: #79740e;">"id"</span>: 3, <span style="color: #79740e;">"name"</span>: <span style="color: #79740e;">"Chi"</span>},
<span style="background-color: #ebdbb2;"> </span>   {<span style="color: #79740e;">"id"</span>: 4, <span style="color: #79740e;">"name"</span>: <span style="color: #79740e;">"Thor"</span>},
<span style="background-color: #ebdbb2;"> </span>   {<span style="color: #79740e;">"id"</span>: 5, <span style="color: #79740e;">"name"</span>: <span style="color: #79740e;">"Clive"</span>},
<span style="background-color: #ebdbb2;"> </span>   {<span style="color: #79740e;">"id"</span>: 6, <span style="color: #79740e;">"name"</span>: <span style="color: #79740e;">"Hicks"</span>},
<span style="background-color: #ebdbb2;"> </span>   {<span style="color: #79740e;">"id"</span>: 7, <span style="color: #79740e;">"name"</span>: <span style="color: #79740e;">"Devin"</span>},
<span style="background-color: #ebdbb2;"> </span>   {<span style="color: #79740e;">"id"</span>: 8, <span style="color: #79740e;">"name"</span>: <span style="color: #79740e;">"Kate"</span>},
<span style="background-color: #ebdbb2;"> </span>   {<span style="color: #79740e;">"id"</span>: 9, <span style="color: #79740e;">"name"</span>: <span style="color: #79740e;">"Klein"</span>},
<span style="background-color: #ebdbb2;"> </span>   {<span style="color: #79740e;">"id"</span>: 10, <span style="color: #79740e;">"name"</span>: <span style="color: #79740e;">"Jen"</span>},
]

<span style="color: #076678;">friendship_pairs</span> = [
<span style="background-color: #ebdbb2;"> </span>   (0, 1),
<span style="background-color: #ebdbb2;"> </span>   (0, 2),
<span style="background-color: #ebdbb2;"> </span>   (1, 2),
<span style="background-color: #ebdbb2;"> </span>   (1, 3),
<span style="background-color: #ebdbb2;"> </span>   (2, 3),
<span style="background-color: #ebdbb2;"> </span>   (3, 4),
<span style="background-color: #ebdbb2;"> </span>   (4, 5),
<span style="background-color: #ebdbb2;"> </span>   (5, 6),
<span style="background-color: #ebdbb2;"> </span>   (5, 7),
<span style="background-color: #ebdbb2;"> </span>   (6, 8),
<span style="background-color: #ebdbb2;"> </span>   (7, 8),
<span style="background-color: #ebdbb2;"> </span>   (8, 9),
]


<span style="color: #076678;">friendships</span> = {user[<span style="color: #79740e;">"id"</span>]: [] <span style="color: #9d0006;">for</span> user <span style="color: #9d0006;">in</span> users}

<span style="color: #9d0006;">for</span> i, j <span style="color: #9d0006;">in</span> friendship_pairs:
<span style="background-color: #ebdbb2;"> </span>   friendships[i].append(j)
<span style="background-color: #ebdbb2;"> </span>   friendships[j].append(i)


<span style="color: #9d0006;">print</span>(friendships)

<span style="color: #a89984;"># </span><span style="color: #a89984;">&lt;===================OUTPUT===================&gt;</span>
<span style="color: #a89984;"># </span><span style="color: #a89984;">{0: [1, 2], 1: [0, 2, 3], 2: [0, 1, 3], 3:</span>
<span style="color: #a89984;"># </span><span style="color: #a89984;">[1, 2, 4], 4: [3, 5], 5: [4, 6, 7], 6: [5, 8],</span>
<span style="color: #a89984;"># </span><span style="color: #a89984;">7: [5, 8], 8: [6, 7, 9], 9: [8], 10: []}</span>
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-orgf4e1bb4" class="outline-4">
<h4 id="orgf4e1bb4"><span class="section-number-4">1.3.2</span> Data Scientists You May Know</h4>
<div class="outline-text-4" id="text-1-3-2">
<ul class="org-ul">
<li>有了前面的朋友关系数据,公司的VP希望你开发一个系统,让你设计一个Data Scientists You May Know的系
统.</li>
<li></li>
</ul>
</div>
</div>
</div>
</div>
<div id="outline-container-orgfc0c911" class="outline-2">
<h2 id="orgfc0c911"><span class="section-number-2">2</span> Chapter 2: A Crash Course on Python</h2>
</div>
<div id="outline-container-org8cd6056" class="outline-2">
<h2 id="org8cd6056"><span class="section-number-2">3</span> Chapter 3: Visualizing Data</h2>
</div>
<div id="outline-container-org710ec3e" class="outline-2">
<h2 id="org710ec3e"><span class="section-number-2">4</span> Chapter 4: Linear Algrebra</h2>
<div class="outline-text-2" id="text-4">
<ul class="org-ul">
<li>线性代数是数学的一个分支,主要是和向量空间(vector space)打交道的.</li>
</ul>
</div>
<div id="outline-container-org9fc76b9" class="outline-3">
<h3 id="org9fc76b9"><span class="section-number-3">4.1</span> Vectors</h3>
<div class="outline-text-3" id="text-4-1">
<ul class="org-ul">
<li>vector的中文名叫做向量</li>
<li>vector可以多个组合起来,形成新的vector.</li>
<li>vector也可以乘以一个scalar(比如数字)来形成新的vector</li>
<li>具体点来说,在有限空间里面,我们可以把vector看成是points的组合.把数据看成vector比你想象的有用多了.
比如,我们如果有一个人的身高,体重,年龄的数据.我们可以把这些数据看做是三维vector[height, weight, age]</li>
<li>最简单的表达vector的方法,是使用list of number.包含三个数字的list就对应三维vector</li>
<li><p>
我们将使用type alias的方法来设计Vector类型(其实就是list of float)
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">from</span> typing <span style="color: #9d0006;">import</span> List

<span style="color: #076678;">Vector</span> = List[<span style="color: #af3a03;">float</span>]

<span style="color: #076678;">height_weight_age</span> = [70, 170, 40]

<span style="color: #076678;">grades</span> = [95, 80, 75, 62]
</pre>
</div></li>
<li>让我们来为我们的向量类型Vector来创建它的各种数学操作吧.</li>
<li>首先来看向量的加法.向量的加法:
<ul class="org-ul">
<li>必须满足长度一致</li>
<li>结果为每个index的值加到一块</li>
</ul></li>
<li><p>
代码如下
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">add</span>(v: Vector, w: Vector) -&gt; Vector:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">assert</span> <span style="color: #af3a03;">len</span>(v) == <span style="color: #af3a03;">len</span>(w)
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> [v_i + w_i <span style="color: #9d0006;">for</span> v_i, w_i <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">zip</span>(v, w)]


<span style="color: #9d0006;">assert</span> add([1, 2, 3], [4, 5, 6]) == [5, 7, 9]
</pre>
</div></li>
<li><p>
向量的减法类似
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">subtract</span>(v: Vector, w: Vector) -&gt; Vector:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">assert</span> <span style="color: #af3a03;">len</span>(v) == <span style="color: #af3a03;">len</span>(w)
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> [v_i - w_i <span style="color: #9d0006;">for</span> v_i, w_i <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">zip</span>(v, w)]


<span style="color: #9d0006;">assert</span> subtract([5, 7, 9], [4, 5, 6]) == [1, 2, 3]
</pre>
</div></li>
<li><p>
我们可以把多个长度一样的数组进行相加
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">vector_sum</span>(vectors: List[Vector]) -&gt; Vector:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">assert</span> vectors, <span style="color: #79740e;">"no vectors provided"</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">num_elements</span> = <span style="color: #af3a03;">len</span>(vectors[0])
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">assert</span> <span style="color: #af3a03;">all</span>(<span style="color: #af3a03;">len</span>(v) == num_elements <span style="color: #9d0006;">for</span> v <span style="color: #9d0006;">in</span> vectors), <span style="color: #79740e;">"different size"</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> [<span style="color: #af3a03;">sum</span>(vector[i] <span style="color: #9d0006;">for</span> vector <span style="color: #9d0006;">in</span> vectors) <span style="color: #9d0006;">for</span> i <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">range</span>(num_elements)]

<span style="color: #9d0006;">assert</span> vector_sum([[1, 2], [3, 4], [5, 6], [7, 8]]) == [16, 20]
</pre>
</div></li>
<li><p>
我们还可以为vector的每个成员乘以一个系数
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">scalar_multiply</span>(c: <span style="color: #af3a03;">float</span>, v: Vector) -&gt; Vector:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> [c * v_i <span style="color: #9d0006;">for</span> v_i <span style="color: #9d0006;">in</span> v]

<span style="color: #9d0006;">assert</span> scalar_multiply(2, [1, 2, 3]) == [2, 4, 6]
</pre>
</div></li>
<li><p>
这样一来,我们就可以计算一个向量的平均值了
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">vector_mean</span>(vectors: List[Vector]) -&gt; Vector:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">n</span> = <span style="color: #af3a03;">len</span>(vectors)
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> scalar_multiply(1/n, vector_sum(vectors))

<span style="color: #9d0006;">assert</span> vector_mean([[1, 2], [3, 4], [5, 6]]) == [3, 4]
</pre>
</div></li>
<li><p>
一个不太明显的运算是dot product.所谓dot product就是两个vector逐一捉对相乘,然后结果相加,代码如下
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">dot</span>(v: Vector, w: Vector) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">assert</span> <span style="color: #af3a03;">len</span>(v) == <span style="color: #af3a03;">len</span>(w), <span style="color: #79740e;">"vectors must be same length"</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> <span style="color: #af3a03;">sum</span>(v_i * w_i <span style="color: #9d0006;">for</span> v_i, w_i <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">zip</span>(v, w))


<span style="color: #9d0006;">assert</span> dot([1, 2, 3], [4, 5, 6]) == 32  <span style="color: #a89984;"># </span><span style="color: #a89984;">1 * 4 + 2 * 5 + 3 * 6</span>
</pre>
</div></li>
<li>假设dot product运算dp(v,w)的一个参与方w其magnitude为1(我们可以把magnitude理解为向量的长度),那么,
我们就可以认为dp(v,w)的结果,就是向量v, 投射在w上的长度.</li>
<li><p>
为了便于理解上面的语句,我们举个极端的例子,假设v为[1, 2], w为[1,0], 那么dot(v,w)的结果就是1,也就
是v投射在w上产生的vector的长度.
</p>
<pre class="example" id="orge929a59">
if w = [1, 0], then dot(v, w) is just the first component of v.
Another way of saying this is that it's the lenght of the vector
you'd get if you projected v onto w
</pre></li>
<li><p>
自己和自己的dot product就是向量的sum of square
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">sum_of_squares</span>(v: Vector) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> dot(v, v)

<span style="color: #9d0006;">assert</span> sum_of_squares([1, 2, 3]) == 14 <span style="color: #a89984;"># </span><span style="color: #a89984;">1 * 1 + 2 * 2 + 3 * 3</span>

</pre>
</div></li>
<li><p>
我们还可以使用sum of squares来计算我们的magnitud(向量的长度)
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">magnitude</span>(v: Vector) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> math.sqrt(sum_of_squares(v))


<span style="color: #9d0006;">assert</span> magnitude([3, 4]) == 5

</pre>
</div></li>
<li>最后,我们可以来计算两个向量的举例了:
<ul class="org-ul">
<li><p>
比较易懂的代码如下
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">squared_distance</span>(v: Vector, w: Vector) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> sum_of_squares(subtract(v, w))  <span style="color: #a89984;"># </span><span style="color: #a89984;">two vectors now become one</span>


<span style="color: #9d0006;">def</span> <span style="color: #b57614;">distance</span>(v: Vector, w: Vector) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> math.sqrt(squared_distance(v, w))


<span style="color: #9d0006;">assert</span> distance([0, 0], [3, 4]) == 5
</pre>
</div></li>
<li><p>
可以简写成如下
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">distance_short</span>(v: Vector, w: Vector) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> magnitude(subtract(v, w))


<span style="color: #9d0006;">assert</span> distance_short([0, 0], [3, 4]) == 5
</pre>
</div></li>
</ul></li>
<li>这么多常规的运算我们使用list来了解了他们的含义,在平时使用中,我们通常使用NumPy里面的array,其效率
更高,而且具有工业水准.</li>
</ul>
</div>
</div>
<div id="outline-container-orgd617ea9" class="outline-3">
<h3 id="orgd617ea9"><span class="section-number-3">4.2</span> Matrices</h3>
<div class="outline-text-3" id="text-4-2">
<ul class="org-ul">
<li>matrix是一个两纬数组,我们可以理解为list of list,每个内部list的长度都是一样的</li>
<li><p>
我们可以定义一个matrix的row为list的个数, column为每个list的长度
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">shape</span>(A: Matrix) -&gt; Tuple[<span style="color: #af3a03;">int</span>, <span style="color: #af3a03;">int</span>]:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Returns (# of rows of A, # of columns of A)"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">num_rows</span> = <span style="color: #af3a03;">len</span>(A)
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">num_cols</span> = <span style="color: #af3a03;">len</span>(A[0]) <span style="color: #9d0006;">if</span> A <span style="color: #9d0006;">else</span> 0
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> num_rows, num_cols


<span style="color: #9d0006;">assert</span> shape([[1, 2, 3], [4, 5, 6]]) == (2, 3)
</pre>
</div></li>
<li>如果一个matrix有n行,k列,那么我们可以称之为 \(n \times k\) matrix</li>
<li>我们可以把一个 \(n \times k\) matrix的每一行看成是一个长度为k的vector,每一列看成是长度为n的vector</li>
<li><p>
我们可以获取每一row和每一column
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">get_row</span>(A: Matrix, i: <span style="color: #af3a03;">int</span>) -&gt; Vector:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Returns the i-th row of A (as a Vector)"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> A[i]


<span style="color: #9d0006;">def</span> <span style="color: #b57614;">get_column</span>(A: Matrix, j: <span style="color: #af3a03;">int</span>) -&gt; Vector:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Returns the j-th column of A (as a Vector)"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> [A_i[j] <span style="color: #9d0006;">for</span> A_i <span style="color: #9d0006;">in</span> A]
</pre>
</div></li>
<li>我们可以使用row,column和生成内容的function三个参数来创建一个matrix</li>
<li><p>
有了这个函数,我们可以创建一个5x5的等长矩阵.其内容生成的规则是斜边等于1,其他的地方等于0
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">from</span> typing <span style="color: #9d0006;">import</span> Callable


<span style="color: #9d0006;">def</span> <span style="color: #b57614;">make_matrix</span>(
<span style="background-color: #ebdbb2;"> </span>   num_rows: <span style="color: #af3a03;">int</span>, num_cols: <span style="color: #af3a03;">int</span>, entry_fn: Callable[[<span style="color: #af3a03;">int</span>, <span style="color: #af3a03;">int</span>], <span style="color: #af3a03;">float</span>]
) -&gt; Matrix:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""</span>
<span style="color: #79740e; background-color: #ebdbb2;"> </span><span style="color: #79740e;">   Returns a num_rows x num_cols matrix</span>
<span style="color: #79740e; background-color: #ebdbb2;"> </span><span style="color: #79740e;">   whose (i,j)-th entry is entry_fn(i,j)</span>
<span style="color: #79740e; background-color: #ebdbb2;"> </span><span style="color: #79740e;">   """</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> [[entry_fn(i, j) <span style="color: #9d0006;">for</span> j <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">range</span>(num_cols)] <span style="color: #9d0006;">for</span> i <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">range</span>(num_rows)]


<span style="color: #9d0006;">def</span> <span style="color: #b57614;">identity_matrix</span>(n: <span style="color: #af3a03;">int</span>) -&gt; Matrix:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> make_matrix(n, n, <span style="color: #9d0006;">lambda</span> i, j: 1 <span style="color: #9d0006;">if</span> i == j <span style="color: #9d0006;">else</span> 0)


<span style="color: #9d0006;">assert</span> identity_matrix(5) == [
<span style="background-color: #ebdbb2;"> </span>   [1, 0, 0, 0, 0],
<span style="background-color: #ebdbb2;"> </span>   [0, 1, 0, 0, 0],
<span style="background-color: #ebdbb2;"> </span>   [0, 0, 1, 0, 0],
<span style="background-color: #ebdbb2;"> </span>   [0, 0, 0, 1, 0],
<span style="background-color: #ebdbb2;"> </span>   [0, 0, 0, 0, 1],
]
</pre>
</div></li>
<li>矩阵是非常有用的:
<ol class="org-ol">
<li><p>
我们可以使用矩阵来表示多个向量(vector)的集合,比如有个1000个人的身高体重年龄信息,我们可以表示成
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #076678;">data</span> = [
<span style="background-color: #ebdbb2;"> </span>   [70, 170, 40],
<span style="background-color: #ebdbb2;"> </span>   [65, 172, 30],
<span style="background-color: #ebdbb2;"> </span>   [72, 180, 20],
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #a89984;"># </span><span style="color: #a89984;">...</span>
]
</pre>
</div></li>
<li>我们可以使用一个n*k的矩阵来表示一个linear function, 这个function会map的一个k-dimensional vector
到一个n-dimensional vector</li>
<li><p>
我们可以使用矩阵来表示一个二维的relation.比如前面的友谊关系,我们就可以使用matrix表示
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #076678;">friend_matrix</span> = [
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #a89984;">#</span><span style="color: #a89984;">u0 u1 u2 u3 u4</span>
<span style="background-color: #ebdbb2;"> </span>   [0, 1, 1, 0, 0],            <span style="color: #a89984;"># </span><span style="color: #a89984;">u0</span>
<span style="background-color: #ebdbb2;"> </span>   [0, 1, 1, 0, 0],            <span style="color: #a89984;"># </span><span style="color: #a89984;">u1</span>
<span style="background-color: #ebdbb2;"> </span>   [0, 1, 1, 0, 0],            <span style="color: #a89984;"># </span><span style="color: #a89984;">u2</span>
<span style="background-color: #ebdbb2;"> </span>   [0, 1, 1, 1, 0],            <span style="color: #a89984;"># </span><span style="color: #a89984;">u3</span>
<span style="background-color: #ebdbb2;"> </span>   [0, 1, 1, 0, 1],            <span style="color: #a89984;"># </span><span style="color: #a89984;">u4</span>
]

<span style="color: #9d0006;">assert</span> friend_matrix[0][2] == 1, <span style="color: #79740e;">"0 and 2 are friends"</span>
<span style="color: #9d0006;">assert</span> friend_matrix[0][8] == 1, <span style="color: #79740e;">"0 and 8 are not friends"</span>

<span style="color: #a89984;"># </span><span style="color: #a89984;">only need to look at one row</span>
<span style="color: #076678;">friends_of_five</span> = [i
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>  <span style="color: #9d0006;">for</span> i, is_friend <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">enumerate</span>(friend_matrix[5])
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>  <span style="color: #9d0006;">if</span> is_friend]
</pre>
</div></li>
</ol></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org779499b" class="outline-2">
<h2 id="org779499b"><span class="section-number-2">5</span> Chapter 5: Statistics</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-orgab67491" class="outline-3">
<h3 id="orgab67491"><span class="section-number-3">5.1</span> Describing a Single Set of Data</h3>
<div class="outline-text-3" id="text-5-1">
<ul class="org-ul">
<li>随着DataSciencester的发展,DataSciencester拥有了许多注册用户,公司领导要求你做个如下的综述:我们的
每个注册用户有多少朋友. 这个综述必须准确而简短,因为公司领导要用在电梯游说里面</li>
<li>通过第一章的方法,我们很容易统计到每个member的朋友,但是困难之处在于如何描述这个问题:
<ul class="org-ul">
<li><p>
对于小量数据,我们可以把数据直接列出来
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #076678;">num_friends</span> = [
<span style="background-color: #ebdbb2;"> </span>   100,
<span style="background-color: #ebdbb2;"> </span>   49,
<span style="background-color: #ebdbb2;"> </span>   41,
<span style="background-color: #ebdbb2;"> </span>   40,
<span style="background-color: #ebdbb2;"> </span>   25,
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #a89984;"># </span><span style="color: #a89984;">... and lots more</span>
]
</pre>
</div></li>
<li>但是我们身处大数据时代,稍微大一点的数据量使用上面的方法描述都会非常的不清晰.这个时候statistics
开始要发挥它的作用了. statistics就是提取,并且总结我们数据的相关feature</li>
</ul></li>
<li>我们首先使用histogram(柱状图)来看看总体的人数分布
<ul class="org-ul">
<li><p>
代码如下
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">from</span> collections <span style="color: #9d0006;">import</span> Counter
<span style="color: #9d0006;">import</span> matplotlib.pyplot <span style="color: #9d0006;">as</span> plt


<span style="color: #076678;">num_friends</span> = [
<span style="background-color: #ebdbb2;"> </span>   100.0,
<span style="background-color: #ebdbb2;"> </span>   49,
<span style="background-color: #ebdbb2;"> </span>   41,
<span style="background-color: #ebdbb2;"> </span>   40,
<span style="background-color: #ebdbb2;"> </span>   25,
<span style="background-color: #ebdbb2;"> </span>   21,
<span style="background-color: #ebdbb2;"> </span>   21,
<span style="background-color: #ebdbb2;"> </span>   19,
<span style="background-color: #ebdbb2;"> </span>   1,
]


<span style="color: #076678;">friend_counts</span> = Counter(num_friends)
<span style="color: #076678;">xs</span> = <span style="color: #af3a03;">range</span>(101)  <span style="color: #a89984;"># </span><span style="color: #a89984;">largest value is 100</span>
<span style="color: #076678;">ys</span> = [friend_counts[x] <span style="color: #9d0006;">for</span> x <span style="color: #9d0006;">in</span> xs]  <span style="color: #a89984;"># </span><span style="color: #a89984;">height is just # of friends</span>
plt.bar(xs, ys)
plt.axis([0, 101, 0, 25])
plt.title(<span style="color: #79740e;">"Histogram of Friend Counts"</span>)
plt.xlabel(<span style="color: #79740e;">"# of friends"</span>)
plt.ylabel(<span style="color: #79740e;">"# of people"</span>)
plt.show()
</pre>
</div></li>
<li><p>
输出如下
</p>

<div id="orgda860b1" class="figure">
<p><img src="https://raw.githubusercontent.com/harrifeng/image/master/ds/5-1.png" alt="5-1.png" />
</p>
<p><span class="figure-number">Figure 1: </span>ds/5-1.png</p>
</div></li>
</ul></li>
<li>上面的图很清楚,但是还是不容易在对话中表述,所以我们开始总结一下这个数据集里面的statistics信息:
<ul class="org-ul">
<li><p>
数据的总数如下
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #076678;">num_points</span> = <span style="color: #af3a03;">len</span>(num_friends)   <span style="color: #a89984;"># </span><span style="color: #a89984;">204</span>
</pre>
</div></li>
<li><p>
最大值为100,最小值为1
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #076678;">largest_value</span> = <span style="color: #af3a03;">max</span>(num_friends) <span style="color: #a89984;"># </span><span style="color: #a89984;">100</span>
<span style="color: #076678;">smallest_value</span> = <span style="color: #af3a03;">min</span>(num_friends) <span style="color: #a89984;"># </span><span style="color: #a89984;">1</span>
</pre>
</div></li>
<li><p>
排序后的信息
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #076678;">sorted_values</span> = <span style="color: #af3a03;">sorted</span>(num_friends)
<span style="color: #076678;">smallest_value</span> = sorted_values[0] <span style="color: #a89984;"># </span><span style="color: #a89984;">1</span>
<span style="color: #076678;">second_smallest_value</span> = sorted_values[1] <span style="color: #a89984;"># </span><span style="color: #a89984;">1</span>
<span style="color: #076678;">second_largest_value</span> = sorted_values[-2] <span style="color: #a89984;"># </span><span style="color: #a89984;">49</span>
</pre>
</div></li>
</ul></li>
</ul>
</div>
<div id="outline-container-org57ed77b" class="outline-4">
<h4 id="org57ed77b"><span class="section-number-4">5.1.1</span> Central Tendencies</h4>
<div class="outline-text-4" id="text-5-1-1">
<ul class="org-ul">
<li><p>
很多时候我们会在意数据在哪里centered,最能表达这个意思的数据是平均数(mean)
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">mean</span>(xs: List[<span style="color: #af3a03;">float</span>]) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> <span style="color: #af3a03;">sum</span>(xs) / <span style="color: #af3a03;">len</span>(xs)


mean(num_friends)  <span style="color: #a89984;"># </span><span style="color: #a89984;">7.33333</span>
</pre>
</div></li>
<li>另外一些时候,我们关注median(中位数), 也就是排序后最中间的那个数的值(或者最中间的两个的平均值)</li>
<li>和平均值不同,中位数不完全依赖数据中的每一个数值.比如你把最大值再提高一点,最中间位置的数字的地位
还是没有变,所以中位数也不会变</li>
<li><p>
计算中位数代码如下
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">_median_odd</span>(xs: List[<span style="color: #af3a03;">float</span>]) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""If len(xs) is odd, the median is the middle element"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> <span style="color: #af3a03;">sorted</span>(xs)[<span style="color: #af3a03;">len</span>(xs) // 2]

<span style="color: #9d0006;">def</span> <span style="color: #b57614;">_median_even</span>(xs: List[<span style="color: #af3a03;">float</span>]) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""If len(xs) is even, it's the average of the middle two elements"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">sorted_xs</span> = <span style="color: #af3a03;">sorted</span>(xs)
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">hi_midpoint</span> = <span style="color: #af3a03;">len</span>(xs) // 2  <span style="color: #a89984;"># </span><span style="color: #a89984;">e.g. length 4 =&gt; hi_midpoint 2</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> (sorted_xs[hi_midpoint - 1] + sorted_xs[hi_midpoint]) / 2

<span style="color: #9d0006;">def</span> <span style="color: #b57614;">median</span>(v: List[<span style="color: #af3a03;">float</span>]) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Finds the 'middle-most' value of v"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> _median_even(v) <span style="color: #9d0006;">if</span> <span style="color: #af3a03;">len</span>(v) % 2 == 0 <span style="color: #9d0006;">else</span> _median_odd(v)
</pre>
</div></li>
<li>实际上存在不sort就能计算median的方法,但是这个超出了我们本书的范畴</li>
<li>与此同时,平均数(mean)对于数据中的outlier特别的敏感,一个outlier可以大幅提高平均数</li>
<li>对于中位数进行泛化,就会得到分位数(quantile), 也就是在百分之X的位置的数是多少.</li>
<li><p>
中位数可以看成是50%的分位数
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">quantile</span>(xs: List[<span style="color: #af3a03;">float</span>], p: <span style="color: #af3a03;">float</span>) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Returns the pth-percentile value in x"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">p_index</span> = <span style="color: #af3a03;">int</span>(p * <span style="color: #af3a03;">len</span>(xs))
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> <span style="color: #af3a03;">sorted</span>(xs)[p_index]

<span style="color: #9d0006;">assert</span> quantile(num_friends, 0.10) == 1
<span style="color: #9d0006;">assert</span> quantile(num_friends, 0.25) == 3
<span style="color: #9d0006;">assert</span> quantile(num_friends, 0.75) == 9
<span style="color: #9d0006;">assert</span> quantile(num_friends, 0.90) == 13
</pre>
</div></li>
<li><p>
不太常用的是mode(众数),也就是整个数组中出现次数最多的数字
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">mode</span>(x: List[<span style="color: #af3a03;">float</span>]) -&gt; List[<span style="color: #af3a03;">float</span>]:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Returns a list, since there might be more than one mode"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">counts</span> = Counter(x)
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">max_count</span> = <span style="color: #af3a03;">max</span>(counts.values())
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> [x_i <span style="color: #9d0006;">for</span> x_i, count <span style="color: #9d0006;">in</span> counts.items()
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">if</span> count == max_count]

<span style="color: #9d0006;">assert</span> <span style="color: #af3a03;">set</span>(mode(num_friends)) == {1, 6}
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-org189ee62" class="outline-4">
<h4 id="org189ee62"><span class="section-number-4">5.1.2</span> Dispersion(离散)</h4>
<div class="outline-text-4" id="text-5-1-2">
<ul class="org-ul">
<li>Dispersion代表我们的data扩散(spread)的程度:
<ul class="org-ul">
<li>如果dispersion值为0,说明我们的value压根就没怎么扩散</li>
<li>如果dispersion值很大,说明我们的value扩散的很厉害</li>
</ul></li>
<li><p>
最简单的度量离散度的方法是使用range,也就是计算最大值和最小值之间的距离
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">data_range</span>(xs: List[<span style="color: #af3a03;">float</span>]) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> <span style="color: #af3a03;">max</span>(xs) - <span style="color: #af3a03;">min</span>(xs)

<span style="color: #9d0006;">assert</span> data_range(num_friends) == 99
</pre>
</div></li>
<li>如果range是0,那么说明最大值和最小值是一样的,这只会在所有值都一样的情况下发生,这说明data就完全没有离散</li>
<li><p>
一个更加复杂的度量离散度的做法是variance(方差),计算如下
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">de_mean</span>(xs: List[<span style="color: #af3a03;">float</span>]) -&gt; List[<span style="color: #af3a03;">float</span>]:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Translate xs by subtracting its mean (so the result has mean 0)"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">x_bar</span> = mean(xs)
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> [x - x_bar <span style="color: #9d0006;">for</span> x <span style="color: #9d0006;">in</span> xs]

<span style="color: #9d0006;">def</span> <span style="color: #b57614;">variance</span>(xs: List[<span style="color: #af3a03;">float</span>]) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Almost the average squared deviation from the mean"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">assert</span> <span style="color: #af3a03;">len</span>(xs) &gt;= 2, <span style="color: #79740e;">"variance requires at least two elements"</span>

<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">n</span> = <span style="color: #af3a03;">len</span>(xs)
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">deviations</span> = de_mean(xs)
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> sum_of_squares(deviations) / (n - 1)

<span style="color: #9d0006;">assert</span> 81.54 &lt; variance(num_friends) &lt; 81.55
</pre>
</div></li>
<li>注意,这里除以n-1是Unbiased estimation of standard deviation的要求,只在抽样调查时有效!</li>
<li><p>
由于使用了平方数,所以,方差的单位和原数据不一样了,为了能够拥有一样的单位,我们又引入了标准差
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">standard_deviation</span>(xs: List[<span style="color: #af3a03;">float</span>]) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""The standard deviation is the square root of the variance"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> math.sqrt(variance(xs))

<span style="color: #9d0006;">assert</span> 9.02 &lt; standard_deviation(num_friends) &lt; 9.04
</pre>
</div></li>
<li>和range一样,标准差也会受到outlier的影响比较大</li>
<li><p>
一个比较健壮的方法,是计算75%分位和25%分位的差值
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">interquartile_range</span>(xs: List[<span style="color: #af3a03;">float</span>]) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Returns the difference between the 75%-ile and the 25%-ile"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> quantile(xs, 0.75) - quantile(xs, 0.25)

<span style="color: #9d0006;">assert</span> interquartile_range(num_friends) == 6
</pre>
</div></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org74817df" class="outline-3">
<h3 id="org74817df"><span class="section-number-3">5.2</span> Correlation</h3>
<div class="outline-text-3" id="text-5-2">
<ul class="org-ul">
<li>VP有一个理论,那就是,用户在网站上花费的时间多少,和用户的朋友数目多少有关.如果你是数据分析,那么你如何来验证这些事情呢.</li>
<li>我们从线上日志获取到了每个用户在网站上花费的时间的数组daily_minutes,数组成员是按照num_friends排
序的.换句话说,daily_minutes的第ith位置的数据,和num_friends的第ith位置的数据指的是同一个人</li>
<li>对于这两个数据,我们首先计算他们的covariance(协方差),协方差是两个数据版本的方差:
<ul class="org-ul">
<li>方差是度量单个变量离散平均数的水平</li>
<li>协方差是度量两个变量离散平均数的水平</li>
</ul></li>
<li>代码如下:
<ul class="org-ul">
<li><p>
计算dot
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">dot</span>(v: Vector, w: Vector) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Computes v_1 * w_1 + ... + v_n * w_n"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">assert</span> <span style="color: #af3a03;">len</span>(v) == <span style="color: #af3a03;">len</span>(w), <span style="color: #79740e;">"vectors must be same length"</span>

<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> <span style="color: #af3a03;">sum</span>(v_i * w_i <span style="color: #9d0006;">for</span> v_i, w_i <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">zip</span>(v, w))
</pre>
</div></li>
<li><p>
计算de_mean
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">de_mean</span>(xs: List[<span style="color: #af3a03;">float</span>]) -&gt; List[<span style="color: #af3a03;">float</span>]:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Translate xs by subtracting its mean (so the result has mean 0)"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">x_bar</span> = mean(xs)
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> [x - x_bar <span style="color: #9d0006;">for</span> x <span style="color: #9d0006;">in</span> xs]
</pre>
</div></li>
<li><p>
计算协方差
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">covariance</span>(xs: List[<span style="color: #af3a03;">float</span>], ys: List[<span style="color: #af3a03;">float</span>]) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">assert</span> <span style="color: #af3a03;">len</span>(xs) == <span style="color: #af3a03;">len</span>(ys), <span style="color: #79740e;">"xs and ys must have same number of elements"</span>

<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> dot(de_mean(xs), de_mean(ys)) / (<span style="color: #af3a03;">len</span>(xs) - 1)

<span style="color: #9d0006;">assert</span> 22.42 &lt; covariance(num_friends, daily_minutes) &lt; 22.43
<span style="color: #9d0006;">assert</span> 22.42 / 60 &lt; covariance(num_friends, daily_hours) &lt; 22.43 / 60
</pre>
</div></li>
</ul></li>
<li>协方差的数据有三种:
<ul class="org-ul">
<li>如果协方差大于0,那么协方差越大说明: x会在y大的时候也跟着大,x也会在y小的时候,跟着小</li>
<li>如果协方差小于0,那么协方差越大说明: x会在y大的时候也变得小,x也会在y小的时候,变得大</li>
<li>如果协方差为0(或者约等于0),那么意味着两个数据之间没有关系</li>
</ul></li>
<li>协方差有如下两个问题:
<ul class="org-ul">
<li>单位是输入的平方,这个无法解释</li>
<li>如果每个用户的朋友都翻倍, 协方差也会翻倍, 但是其实两者的关系并没有改变.换句话说,对于协方差没有
一个范围(或者标准)说,超过0多少才是大,小于0多少才是小</li>
</ul></li>
<li><p>
所以我们引入了correlation(关联)的概念, correlation是协方差除以两个变量的平方差
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">correlation</span>(xs: List[<span style="color: #af3a03;">float</span>], ys: List[<span style="color: #af3a03;">float</span>]) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Measures how much xs and ys vary in tandem about their means"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">stdev_x</span> = standard_deviation(xs)
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">stdev_y</span> = standard_deviation(ys)
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">if</span> stdev_x &gt; 0 <span style="color: #9d0006;">and</span> stdev_y &gt; 0:
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> covariance(xs, ys) / stdev_x / stdev_y
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">else</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> 0    <span style="color: #a89984;"># </span><span style="color: #a89984;">if no variation, correlation is zero</span>

<span style="color: #9d0006;">assert</span> 0.24 &lt; correlation(num_friends, daily_minutes) &lt; 0.25
<span style="color: #9d0006;">assert</span> 0.24 &lt; correlation(num_friends, daily_hours) &lt; 0.25
</pre>
</div></li>
<li>correlation是在-1和1之间的实数,数据0.25代表是比较weak的正向关联</li>
<li>但是如果我们看下图会发现有一个outlier
<ul class="org-ul">
<li><p>
图5-2
</p>

<div id="org8dfcfa0" class="figure">
<p><img src="https://raw.githubusercontent.com/harrifeng/image/master/ds/5-2.png" alt="5-2.png" />
</p>
<p><span class="figure-number">Figure 2: </span>ds/5-2.png</p>
</div></li>
<li>拥有100个朋友的用户是一个巨大的outlier:他每天只花一分钟网站在线</li>
</ul></li>
<li><p>
我们去掉这个outlier之后得到一个比较强的关联(0.57)
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #076678;">outlier</span> = num_friends.index(100)    <span style="color: #a89984;"># </span><span style="color: #a89984;">index of outlier</span>

<span style="color: #076678;">num_friends_good</span> = [x
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">for</span> i, x <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">enumerate</span>(num_friends)
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">if</span> i != outlier]

<span style="color: #076678;">daily_minutes_good</span> = [x
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span> <span style="color: #9d0006;">for</span> i, x <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">enumerate</span>(daily_minutes)
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span> <span style="color: #9d0006;">if</span> i != outlier]

<span style="color: #076678;">daily_hours_good</span> = [dm / 60 <span style="color: #9d0006;">for</span> dm <span style="color: #9d0006;">in</span> daily_minutes_good]

<span style="color: #9d0006;">assert</span> 0.57 &lt; correlation(num_friends_good, daily_minutes_good) &lt; 0.58
<span style="color: #9d0006;">assert</span> 0.57 &lt; correlation(num_friends_good, daily_hours_good) &lt; 0.58
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-org736f70a" class="outline-3">
<h3 id="org736f70a"><span class="section-number-3">5.3</span> Simpson's Paradox</h3>
<div class="outline-text-3" id="text-5-3">
<ul class="org-ul">
<li><p>
数据分析的时候一个现象肯定会让人大吃一惊,那就是辛普森悖论,其核心思想是:当混淆变量不被忽略,那么关
联性可能会变得很具有迷惑性
</p>
<pre class="example" id="org464ae6b">
Correlations can be misleading when confounding variables are ignored.
</pre></li>
<li><p>
我们来举个例子,假设你把自己的注册用户分成两类要么是西海岸会员,要么是东海岸会员,那么我们看看哪个
海岸的会员有更加多个朋友,如下
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Coast</th>
<th scope="col" class="org-right"># of members</th>
<th scope="col" class="org-right">Avg. # of friends</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">West Coast</td>
<td class="org-right">101</td>
<td class="org-right">8.2</td>
</tr>

<tr>
<td class="org-left">East Coast</td>
<td class="org-right">103</td>
<td class="org-right">6.5</td>
</tr>
</tbody>
</table></li>
<li>统计结果很明显,西海岸的科学家平均下来有更多的朋友.</li>
<li>但是对数据深入挖掘后,你会发现很多特别奇怪的现象:
<ul class="org-ul">
<li><p>
如果你只看拥有PhD的人, 平均下来,东海岸有更多的朋友
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Coast</th>
<th scope="col" class="org-left">Degree</th>
<th scope="col" class="org-right"># of members</th>
<th scope="col" class="org-right">Avg. # of friends</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">West Coast</td>
<td class="org-left">PhD</td>
<td class="org-right">35</td>
<td class="org-right">3.1</td>
</tr>

<tr>
<td class="org-left">East Coast</td>
<td class="org-left">PhD</td>
<td class="org-right">70</td>
<td class="org-right">3.2</td>
</tr>
</tbody>
</table></li>
<li><p>
然后你看剩下的没有PhD的人,平均下来,东海岸还是有更多的朋友
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-right" />

<col  class="org-right" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Coast</th>
<th scope="col" class="org-left">Degree</th>
<th scope="col" class="org-right"># of members</th>
<th scope="col" class="org-right">Avg. # of friends</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">West Coast</td>
<td class="org-left">No PhD</td>
<td class="org-right">66</td>
<td class="org-right">10.9</td>
</tr>

<tr>
<td class="org-left">East Coast</td>
<td class="org-left">No PhD</td>
<td class="org-right">33</td>
<td class="org-right">13.4</td>
</tr>
</tbody>
</table></li>
</ul></li>
<li>一旦你考虑了用户的学位,分析结果就完全相反了.</li>
<li>问题的根源在于,把用户分成了东西海岸的科学家,但是这两份数据里面phd的比例不同:东海岸有更多比例的PhD</li>
</ul>
</div>
</div>
<div id="outline-container-org252503e" class="outline-3">
<h3 id="org252503e"><span class="section-number-3">5.4</span> Some Other Correlational Caveats</h3>
<div class="outline-text-3" id="text-5-4">
<ul class="org-ul">
<li>如果两个数据的correlation是zero,那么说明这两个数据没有linear relationship.</li>
<li><p>
但是没有linear relationship不代表两者没有其他关系,比如我们看如下数据
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #076678;">x</span> = [-1, -1, 0, 1, 2]
<span style="color: #076678;">y</span> = [2, 1, 0, 1, 2]
</pre>
</div></li>
<li>x和y的correlation为0,但是他们肯定有其他relationship: 每个y等于每个x的绝对值</li>
<li>也就是说,我们表达某个x和某个y没有关系,是指的:
<ul class="org-ul">
<li>知道了x_i和mean(x)有什么关系以后</li>
<li>无法提供帮助来了解y_i和mean(y)有什么关系</li>
<li>上面的关系也是correlation想要寻找的</li>
</ul></li>
<li>另外, correlation没有告诉你,你们之间的这个关系有多大</li>
</ul>
</div>
</div>
<div id="outline-container-orgb48c106" class="outline-3">
<h3 id="orgb48c106"><span class="section-number-3">5.5</span> Correlation and Causation</h3>
<div class="outline-text-3" id="text-5-5">
<ul class="org-ul">
<li>一旦两个variable是correlation的,那么就很难界定谁是错误的源头,因为:
<ul class="org-ul">
<li>如果x和y是strong correlated的,那么意味着</li>
<li>x的原因促成了y,y促成了x</li>
<li>另外第三个因素可能促成了x和y</li>
</ul></li>
<li>讨论真正原因的时候,可能就需要做AB实验:
<ul class="org-ul">
<li>randomly split你的用户到两个相同大小的组</li>
<li>给一个组稍微不同的体验</li>
<li>最后看看会产生什么不同的结果</li>
</ul></li>
<li>举个例子:
<ul class="org-ul">
<li>我们把所有的用户随机的抽取其中两个部分,变成两个小组</li>
<li>对小组A的展示规则不变.</li>
<li>对小组B的内容,不再展示用户所有朋友的信息,而是只展示用户部分朋友的信息</li>
<li>如果小组B的用户在网站上花费的时间越来越小,那么我们认为用户的朋友数目对于其使用时间是有影响的.</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgabfb383" class="outline-2">
<h2 id="orgabfb383"><span class="section-number-2">6</span> Chapter 6: Probability</h2>
<div class="outline-text-2" id="text-6">
<ul class="org-ul">
<li>对于 data science 来说,如果没有对于probability和数学的理解,那么他很难进步</li>
<li>你应该把probability想成对event的uncertainty的一种量化,event来自于universe of events,我们举个具体
的例子:
<ul class="org-ul">
<li>假设我们掷骰子,universe就是包含所有的结果</li>
<li>每个universe的subset就是一个event,比如下面两种描述都是一个event:
<ol class="org-ol">
<li>骰子得到1</li>
<li>骰子得到一个偶数值</li>
</ol></li>
</ul></li>
<li>一般来说,我们使用P(E)来标识"event E的probability"</li>
<li>probability theory可以用来:
<ul class="org-ul">
<li>创建model</li>
<li>evaluate model</li>
</ul></li>
</ul>
</div>
<div id="outline-container-org49f1ba0" class="outline-3">
<h3 id="org49f1ba0"><span class="section-number-3">6.1</span> Dependence and Independence</h3>
<div class="outline-text-3" id="text-6-1">
<ul class="org-ul">
<li>如果我们说两个event E和F是dependent的,那么也就是说:
<ul class="org-ul">
<li>如果知道了event E是否发生</li>
<li>就给我们提供了event F是否发生的一些提示(and vice versa)</li>
<li>举个例子,我们扔硬币两次,第一次是正面这个event A, 对于"两次是不是都是反面"这个event B,提供了提示
(如果eventA发生,那么eventB则不可能发生),这个就是典型的dependent</li>
</ul></li>
<li>如果我们说两个event E和F是independent的,那么也就是说:
<ul class="org-ul">
<li>如果知道了event E是否发生</li>
<li>没有给我们提供了event F是否发生的那么任何一点提示(and vice versa)</li>
<li>举个例子,我们扔硬币两次,第一次是正面这个event A, 对于第二次是不是正面这个event B,不会提供任何
提示,这就是个典型的independent</li>
</ul></li>
<li><p>
从数学上讲,两个event E和F是independent的,也就是说如下等式成立: 两个event同时发生的概率,等于两单
个event发生概率的乘积
</p>
<pre class="example" id="org3018d58">
P(E,F) = P(E)P(F)
</pre></li>
<li>这个公式可以从条件概率来理解:
<ul class="org-ul">
<li><p>
条件概率的定义:在F发生的情况下,E发生的概率,等于(E,F)同时发生的概率,除以(F)发生的概率
</p>
<pre class="example" id="org7ec92fe">
P(E|F) = P(E,F)/P(F)
</pre></li>
<li><p>
由于E和F是independent的,那么
</p>
<pre class="example" id="orgd4472b0">
P(E|F) = P(E)
</pre></li>
<li><p>
综合上面两条,得到
</p>
<pre class="example" id="orga2cf38d">
P(E) = P(E,F)/P(F)
</pre></li>
<li><p>
也就得到了最后的公式
</p>
<pre class="example" id="org9ff27f1">
P(E,F) = P(E)P(F)
</pre></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgcf307c9" class="outline-3">
<h3 id="orgcf307c9"><span class="section-number-3">6.2</span> Conditional Probability</h3>
<div class="outline-text-3" id="text-6-2">
<ul class="org-ul">
<li><p>
如果两个event E,F是independent的,那么我们上一节有定义:
</p>
<pre class="example" id="org81f2c9c">
P(E,F) = P(E)P(F)
</pre></li>
<li><p>
如果我们不强加这个independent,并且F的概率不是0,那么我们就有了probability of E conditional on F的
定义
</p>
<pre class="example" id="orgb928286">
P(E|F) = P(E,F)/P(F)
</pre></li>
<li>对于条件概率,有个非常有趣的问题:
<ul class="org-ul">
<li>我们假设一个家庭有两个孩子(性别未知)</li>
<li>每个孩子是男是女的概率相同</li>
<li>第二个孩子的性别和第一个孩子的性别是独立的</li>
</ul></li>
<li>针对上面的假设,我们可以得到如下的普通概率:
<ul class="org-ul">
<li>"没有女儿"这个event的概率是1/4</li>
<li>"一个女儿,一个儿子"这个event的概率是1/2</li>
<li>"两个女儿"这个event的概率是1/4</li>
</ul></li>
<li>我们再来看看条件概率,假设有如下两个event:
<ul class="org-ul">
<li>event B: 两个孩子都是女孩</li>
<li>event G: 年长的孩子是女孩</li>
</ul></li>
<li><p>
那么"已经知道年长的孩子是女孩"的情况下,两个孩子都是女孩的概率:
</p>
<pre class="example" id="orgd81f0bc">
P(B|G) = P(B,G)/P(G) = P(B)/P(G) = 1/2
</pre></li>
<li>上面的公式中,由于event B和event G同时发生的概率,就是event B的概率,所以总体结果计算起来很简单</li>
<li>我们再来看看第二个条件概率的例子,假设有如下两个event:
<ul class="org-ul">
<li>event B: 两个孩子都是女孩</li>
<li>event L: 最少一个孩子是女孩</li>
</ul></li>
<li><p>
那么"已经知道至少一个孩子是女孩"的情况下,两个孩子都是女孩的概率:
</p>
<pre class="example" id="orgaf819b9">
P(B|L) = P(B,L)/P(L) = P(B)/P(L) = 1/3
</pre></li>
<li>至少一个孩子是女孩的情况下,有两种可能:
<ul class="org-ul">
<li>两个孩子都是女孩,概率上面说了是1/3</li>
<li>一个是女孩,一个是男孩,概率就是1-1/3=2/3,竟然是上面概率的两倍!</li>
</ul></li>
<li>我们可以使用代码来验证我们之前的两个概率结果:
<ul class="org-ul">
<li><p>
代码如下
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">import</span> enum, random


<span style="color: #9d0006;">def</span> <span style="color: #b57614;">main</span>():

<span style="background-color: #ebdbb2;"> </span>   <span style="color: #a89984;"># </span><span style="color: #a89984;">An Enum is a typed set of enumerated values. We can use them</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #a89984;"># </span><span style="color: #a89984;">to make our code more descriptive and readable.</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">class</span> <span style="color: #8f3f71;">Kid</span>(enum.Enum):
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">BOY</span> = 0
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">GIRL</span> = 1

<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">def</span> <span style="color: #b57614;">random_kid</span>() -&gt; Kid:
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> random.choice([Kid.BOY, Kid.GIRL])

<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">both_girls</span> = 0
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">older_girl</span> = 0
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">either_girl</span> = 0

<span style="background-color: #ebdbb2;"> </span>   random.seed(0)

<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">for</span> _ <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">range</span>(10000):
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">younger</span> = random_kid()
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">older</span> = random_kid()
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">if</span> older == Kid.GIRL:
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">older_girl</span> += 1
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">if</span> older == Kid.GIRL <span style="color: #9d0006;">and</span> younger == Kid.GIRL:
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">both_girls</span> += 1
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">if</span> older == Kid.GIRL <span style="color: #9d0006;">or</span> younger == Kid.GIRL:
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">either_girl</span> += 1

<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">print</span>(<span style="color: #79740e;">"P(both | older):"</span>, both_girls / older_girl)  <span style="color: #a89984;"># </span><span style="color: #a89984;">0.514 ~ 1/2</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">print</span>(<span style="color: #79740e;">"P(both | either): "</span>, both_girls / either_girl)  <span style="color: #a89984;"># </span><span style="color: #a89984;">0.342 ~ 1/3</span>


<span style="color: #9d0006;">if</span> <span style="color: #af3a03;">__name__</span> == <span style="color: #79740e;">"__main__"</span>:
<span style="background-color: #ebdbb2;"> </span>   main()
</pre>
</div></li>
<li><p>
输出如下
</p>
<pre class="example" id="org24abcc7">
P(both | older): 0.5007089325501317
P(both | either):  0.3311897106109325
</pre></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-orgcd08f3f" class="outline-3">
<h3 id="orgcd08f3f"><span class="section-number-3">6.3</span> Bayes's Theorem</h3>
<div class="outline-text-3" id="text-6-3">
<ul class="org-ul">
<li>数据科学家最好的朋友之一,就是贝叶斯定律,其核心思想是reversing conditional probabilities:
<ul class="org-ul">
<li>假设我们想知道在event F发生的情况下, event E发生的概率</li>
<li>但是我们只知道在event E发生的情况下, event F发生的概率</li>
<li>由于P(E,F) = P(E|F)P(F)</li>
<li>又由于P(E,F) = P(F|E)P(E)</li>
<li>所以得到P(E|F)P(F) = P(F|E)P(E)</li>
<li><p>
最终我们得到下面的公式
</p>
<pre class="example" id="org11fa4af">
P(E|F) = P(F|E)P(E)/P(F)
</pre></li>
</ul></li>
<li>上面的式子并不是特别的常用,因为P(F)通常不是那么容易获得的
<ul class="org-ul">
<li>如果把 nE解释为not E (event E doesn't happend),</li>
<li><p>
那么P(F)就可以写作
</p>
<pre class="example" id="org70f64f2">
P(F) = P(F,E) + P(F,nE)
</pre></li>
<li><p>
又由于
</p>
<pre class="example" id="org5d3fd3c">
P(F,E) = P(F|E)P(E)
</pre></li>
<li><p>
于是贝叶斯定律最常见的写法就是如下了
</p>
<pre class="example" id="orgcab86d9">
P(E|F) = P(F|E)P(E)/[P(F|E)P(E) + P(F|nE)P(nE)]
</pre></li>
</ul></li>
<li>我们举个例子来看看贝叶斯定律的使用场景:
<ul class="org-ul">
<li>假设某种疾病每10000个人中有一个人感染</li>
<li>假设检测手段的正确率是99%</li>
<li>T表示你的测试结果是阳性(也就是感染了)</li>
<li>D表示你得了病</li>
</ul></li>
<li>在以上信息都知道的情况下,贝叶斯定律可以求:测试结果是正向的,但是其实还是得病的概率,也就是P(D|T)
<ul class="org-ul">
<li><p>
我们可以使用如下公式
</p>
<pre class="example" id="org7c00be0">
P(D|T) = P(T|D)P(D)/[P(T|D)P(D) + P(T|nD)P(nD)]
</pre></li>
<li>P(T|D) 概率,也就是得了病并且检测出来的概率是0.99</li>
<li>P(D) 任意一个人得病的概率0.0001</li>
<li>P(T|nD), 没有病,测出来是得病的概率,是0.01</li>
<li>P(nD)没有病的概率是0.9999</li>
<li>综合起来,概率是(0.99 * 0.0001) / (0.99 * 0.0001 + 0.01 * 0.9999) = 0.0098</li>
<li><p>
也就是说如果测试结果是阳性,但是也只有1%的人真的得了病
</p>
<pre class="example" id="orgf78c33a">
That is, less than 1% of the people who test positive actually ahve the disease
</pre></li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-org56f5d56" class="outline-3">
<h3 id="org56f5d56"><span class="section-number-3">6.4</span> Random Variables</h3>
<div class="outline-text-3" id="text-6-4">
<ul class="org-ul">
<li>random variable是一种variable,它的值和probability distribution有关</li>
<li>一个简单的random variable例子就是:如果硬币头向上就是1,否则就是0</li>
<li>一个复杂的random variable例子有:
<ul class="org-ul">
<li>当你扔十次硬币,头朝上的硬币个数(这个数字可能是0到10这十一种数字)</li>
<li>range(10)返回的数字(0到9这十个数字)</li>
</ul></li>
<li>有时候我们会讨论random variable的expected value,也就是考虑random variable的所有可能的值,和每个值
的概率的情况下,算的一个总数:
<ul class="org-ul">
<li>比如扔硬币的expected value是(0 * 1/2 + 1 * 1/2) = 1/2</li>
<li>range(10)的expected value是4.5</li>
</ul></li>
<li>Random Variable通常使用大写字母表示,比如,在两个孩子的例子中:
<ul class="org-ul">
<li>X是女孩子个数的random variable</li>
<li>X = 0的概率是1/4</li>
<li>X = 1的概率是1/2</li>
<li>X = 2的概率是1/4</li>
<li>X 的expected value是1/2 + 2 * 1/4 = 1</li>
</ul></li>
<li>Random Variable也是可以有condition的,比如,在两个孩子的例子中:
<ul class="org-ul">
<li>Z是女孩子的个数的random variable,但是前提是年长的孩子是女孩</li>
<li>Z = 0的概率是0</li>
<li>Z = 1的概率是1/2</li>
<li>Z = 2的概率是1/2</li>
<li>Z 的expected value是1/2 + 2 * 1/2 = 3/2</li>
</ul></li>
<li><p>
对于Random Variable 中出现的,所有可能的event.这些event的概率只和必须为1
</p>
\begin{equation}
\sum_{i=1}^np(a_i) = 1
\end{equation}</li>
<li>我们后面会看到,这个公式不仅适用于离散概率分布,也适用于连续概率分布</li>
</ul>
</div>
</div>
<div id="outline-container-org7517724" class="outline-3">
<h3 id="org7517724"><span class="section-number-3">6.5</span> Continuous Distributions</h3>
<div class="outline-text-3" id="text-6-5">
<ul class="org-ul">
<li>扔硬币其实是一种discrete distribution,这种概率的形式是:
<ul class="org-ul">
<li>有限个可能性(换种理解方式,就是可以用整数来标记完所有元素)</li>
<li>每个可能性对应一个概率值</li>
<li>所有多个概率加起来值为1</li>
</ul></li>
<li>比discrete distribution更加复杂的是continuous distribution,这种概率的形式:
<ul class="org-ul">
<li>无数可能性(换种理解方式,就是无法用整数下标标记完所有元素),比如在0到1之间的实数</li>
<li>每个概率值相等</li>
<li>但是由于有无数的可能性,落到单一个数字,比如3.14,其概率就是0</li>
</ul></li>
<li>连续概率分布里面,单个数字的概率是0,但是所有event概率的总和还必须是1.那么,在离散概率分布里面通过
counting来计算概率的方法,就不再管用了.我们要使用新的方法:</li>
<li>一个最直观的方法是使用面积来计算概率,如下图:
<ul class="org-ul">
<li>图6-1</li>
<li>有个长度和高度都是1,我们随机扔一个点在正方形里面,那么落到红色的概率是多少呢?</li>
<li><p>
应该很容易想到的是使用面积来计算概率,使用如下公式
</p>
\begin{equation}
\cfrac{Area \thinspace of \thinspace Red \thinspace Triangle}{Area \thinspace of \thinspace Square} = \cfrac{1}{2}
\end{equation}</li>
</ul></li>
<li>二维的面积特点是其是"平均"分配的,没有密度的概念,如果一个不规则的物体,其每个部分的密度不同,我们就不
能使用"面积"来理解.这个时候,我们要使用"质量"来理解:
<ul class="org-ul">
<li>也就是说所有event的密度乘以体积得到质量总和是1</li>
<li>这里的密度,就是我们的probability density function</li>
<li>这里的体积,就是我们random variable的相对值(注意是相对值)</li>
</ul></li>
<li>我们以一个例子来解释下上面的密度和体积:
<ul class="org-ul">
<li>假设我们有个函数:uniform distribution,这个函数的取值,在[a,b]内部,概率是相等的,平分的(这也叫uniform density).
在[a,b]外部,都是零</li>
<li>我们很容易得到,这些概率的和是1</li>
<li>那么体积,是个差值,也就是b-a</li>
<li><p>
密度呢?密度是一个probability density function(PDF),如下
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">uniform_a_b_pdf</span>(a: <span style="color: #af3a03;">float</span>, b: <span style="color: #af3a03;">float</span>, x: <span style="color: #af3a03;">float</span>) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> 1/(a-b) <span style="color: #9d0006;">if</span> a &lt;= x &lt; b <span style="color: #9d0006;">else</span> 0
</pre>
</div></li>
<li>我们看图会看的更清楚. 图6-2</li>
<li>上图的[a,b)和其上面的部分围城的面积就是1,也就是说虽然每个点的概率都是1/(a-b),但是每个点没有体
积,但是a-b这无数个点却能称之为有体积了</li>
</ul></li>
<li><p>
为了更容易理解,书中把a替换成0,b替换成1,pdf就很简单了
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">uniform_pdf</span>(x: <span style="color: #af3a03;">float</span>) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> 1 <span style="color: #9d0006;">if</span> 0 &lt;= x &lt; 1 <span style="color: #9d0006;">else</span> 0
</pre>
</div></li>
<li><p>
比pdf更加受欢迎的,是cdf(cumulative distribution function),也就是说小于等于某个值的random variable
的概率是多少
</p>
<pre class="example" id="org5c88053">
CDF gives the probability that a random variable is less than
or equal to a certain value.
</pre></li>
<li><p>
上面[0,1) uniform cdf的代码如下
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">uniform_cdf</span>(x: <span style="color: #af3a03;">float</span>) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">""" Returns the probability that a uniform random variable is &lt;= x"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">if</span> x &lt; 0:
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> 0
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">elif</span> x &lt; 1:
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> x
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">else</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> 1
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-orgc08a2d7" class="outline-3">
<h3 id="orgc08a2d7"><span class="section-number-3">6.6</span> The Normal Distribution</h3>
<div class="outline-text-3" id="text-6-6">
<ul class="org-ul">
<li>所谓正态分布(normal distribution),是经典的bell形状的分布,这种分布只取决于两个参数:
<ul class="org-ul">
<li>平均值 \(\mu\): 平均值决定了这个图形的中线在哪里</li>
<li>标准差 \(\sigma\): 标准差决定了图形有多宽</li>
</ul></li>
<li><p>
正态分布的PDF如下
</p>
\begin{equation}
f(x|\mu,\sigma) = \cfrac{1}{\sqrt{2\pi}\sigma}exp\big(-\cfrac{(x-\mu)^2}{2\sigma^2}\big)
\end{equation}</li>
<li>我们可以使用python来实现下:
<ul class="org-ul">
<li><p>
代码如下
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">import</span> math

<span style="color: #076678;">SQRT_TWO_PI</span> = math.sqrt(2 * math.pi)


<span style="color: #9d0006;">def</span> <span style="color: #b57614;">normal_pdf</span>(x: <span style="color: #af3a03;">float</span>, mu: <span style="color: #af3a03;">float</span> = 0, sigma: <span style="color: #af3a03;">float</span> = 1) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> math.exp(-((x - mu) ** 2) / 2 / sigma ** 2) / (SQRT_TWO_PI * sigma)


<span style="color: #9d0006;">import</span> matplotlib.pyplot <span style="color: #9d0006;">as</span> plt

<span style="color: #076678;">xs</span> = [x / 10.0 <span style="color: #9d0006;">for</span> x <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">range</span>(-50, 50)]
plt.plot(xs, [normal_pdf(x, sigma=1) <span style="color: #9d0006;">for</span> x <span style="color: #9d0006;">in</span> xs], <span style="color: #79740e;">"-"</span>, label=<span style="color: #79740e;">"mu=0,sigma=1"</span>)
plt.plot(xs, [normal_pdf(x, sigma=2) <span style="color: #9d0006;">for</span> x <span style="color: #9d0006;">in</span> xs], <span style="color: #79740e;">"--"</span>, label=<span style="color: #79740e;">"mu=0,sigma=2"</span>)
plt.plot(
<span style="background-color: #ebdbb2;"> </span>   xs, [normal_pdf(x, sigma=0.5) <span style="color: #9d0006;">for</span> x <span style="color: #9d0006;">in</span> xs], <span style="color: #79740e;">":"</span>, label=<span style="color: #79740e;">"mu=0,sigma=0.5"</span>
)
plt.plot(xs, [normal_pdf(x, mu=-1) <span style="color: #9d0006;">for</span> x <span style="color: #9d0006;">in</span> xs], <span style="color: #79740e;">"-."</span>, label=<span style="color: #79740e;">"mu=-1,sigma=1"</span>)
plt.legend()
plt.title(<span style="color: #79740e;">"Various Normal pdfs"</span>)
plt.show()
</pre>
</div></li>
<li><p>
输出如下
</p>

<div id="orgddf55d1" class="figure">
<p><img src="https://raw.githubusercontent.com/harrifeng/image/master/ds/6-2.png" alt="6-2.png" />
</p>
<p><span class="figure-number">Figure 3: </span>ds/6-2.png</p>
</div></li>
</ul></li>
<li>当 \(\mu = 0\) 并且 \(\sigma = 1\) 的情况下,正态分布被叫做标准正态分布(standard normal distribution)</li>
<li><p>
如果Z是一个标准正态分布的话,那么我们可以证明下面的X也是正态分布(mean是 \(\mu\) , standard deviation 是 \(\sigma\) )
</p>
\begin{equation}
X = \sigma Z + \mu
\end{equation}</li>
<li><p>
换句话说,如果X是一个普通的正态分布其mean是 \(\mu\) , standard deviation 是 \(\sigma\), 那么Z就是一个标准正态分布
</p>
\begin{equation}
Z = (X - \mu)/\sigma
\end{equation}</li>
<li><p>
对于normal distribution来说,其CDF的计算比较困难,我们可以使用python的erf来实现
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">normal_cdf</span>(x: <span style="color: #af3a03;">float</span>, mu: <span style="color: #af3a03;">float</span> = 0, sigma: <span style="color: #af3a03;">float</span> = 1) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> (1 + math.erf((x - mu) / math.sqrt(2) /sigma)) / 2
</pre>
</div></li>
<li>我们还可以plot出多个:
<ul class="org-ul">
<li><p>
代码
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">import</span> math
<span style="color: #9d0006;">import</span> matplotlib.pyplot <span style="color: #9d0006;">as</span> plt


<span style="color: #9d0006;">def</span> <span style="color: #b57614;">normal_cdf</span>(x: <span style="color: #af3a03;">float</span>, mu: <span style="color: #af3a03;">float</span> = 0, sigma: <span style="color: #af3a03;">float</span> = 1) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> (1 + math.erf((x - mu) / math.sqrt(2) / sigma)) / 2


<span style="color: #076678;">xs</span> = [x / 10.0 <span style="color: #9d0006;">for</span> x <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">range</span>(-50, 50)]
plt.plot(xs, [normal_cdf(x, sigma=1) <span style="color: #9d0006;">for</span> x <span style="color: #9d0006;">in</span> xs], <span style="color: #79740e;">"-"</span>, label=<span style="color: #79740e;">"mu=0,sigma=1"</span>)
plt.plot(xs, [normal_cdf(x, sigma=2) <span style="color: #9d0006;">for</span> x <span style="color: #9d0006;">in</span> xs], <span style="color: #79740e;">"--"</span>, label=<span style="color: #79740e;">"mu=0,sigma=2"</span>)
plt.plot(
<span style="background-color: #ebdbb2;"> </span>   xs, [normal_cdf(x, sigma=0.5) <span style="color: #9d0006;">for</span> x <span style="color: #9d0006;">in</span> xs], <span style="color: #79740e;">":"</span>, label=<span style="color: #79740e;">"mu=0,sigma=0.5"</span>
)
plt.plot(xs, [normal_cdf(x, mu=-1) <span style="color: #9d0006;">for</span> x <span style="color: #9d0006;">in</span> xs], <span style="color: #79740e;">"-."</span>, label=<span style="color: #79740e;">"mu=-1,sigma=1"</span>)
plt.legend(loc=4)  <span style="color: #a89984;"># </span><span style="color: #a89984;">bottom right</span>
plt.title(<span style="color: #79740e;">"Various Normal cdfs"</span>)
plt.show()
</pre>
</div></li>
<li><p>
输出
</p>

<div id="org5b7147b" class="figure">
<p><img src="https://raw.githubusercontent.com/harrifeng/image/master/ds/6-3.png" alt="6-3.png" />
</p>
<p><span class="figure-number">Figure 4: </span>ds/6-3.png</p>
</div></li>
</ul></li>
<li><p>
很多时候我们不是想看某个点的概率,而是想知道某个概率对应的点,那么我们就要invert normal_cdf.由于没
有特别好的办法inverse,所以我们使用binary search
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">inverse_normal_cdf</span>(
<span style="background-color: #ebdbb2;"> </span>   p: <span style="color: #af3a03;">float</span>, mu: <span style="color: #af3a03;">float</span> = 0, sigma: <span style="color: #af3a03;">float</span> = 1, tolerance: <span style="color: #af3a03;">float</span> = 0.00001
) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Find approximate inverse using binary search"""</span>

<span style="background-color: #ebdbb2;"> </span>   <span style="color: #a89984;"># </span><span style="color: #a89984;">if not standard, compute standard and rescale</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">if</span> mu != 0 <span style="color: #9d0006;">or</span> sigma != 1:
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> mu + sigma * inverse_normal_cdf(p, tolerance=tolerance)

<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">low_z</span> = -10.0  <span style="color: #a89984;"># </span><span style="color: #a89984;">normal_cdf(-10) is (very close to) 0</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">hi_z</span> = 10.0  <span style="color: #a89984;"># </span><span style="color: #a89984;">normal_cdf(10)  is (very close to) 1</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">while</span> hi_z - low_z &gt; tolerance:
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">mid_z</span> = (low_z + hi_z) / 2  <span style="color: #a89984;"># </span><span style="color: #a89984;">Consider the midpoint</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">mid_p</span> = normal_cdf(mid_z)  <span style="color: #a89984;"># </span><span style="color: #a89984;">and the cdf's value there</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">if</span> mid_p &lt; p:
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">low_z</span> = mid_z  <span style="color: #a89984;"># </span><span style="color: #a89984;">Midpoint too low, search above it</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">else</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">hi_z</span> = mid_z  <span style="color: #a89984;"># </span><span style="color: #a89984;">Midpoint too high, search below it</span>

<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> mid_z
</pre>
</div></li>
</ul>
</div>
</div>
<div id="outline-container-orgb6acdef" class="outline-3">
<h3 id="orgb6acdef"><span class="section-number-3">6.7</span> The Central Limit Theorem</h3>
<div class="outline-text-3" id="text-6-7">
<ul class="org-ul">
<li>normal distribution如此重要的原因是central limit theorem</li>
<li><p>
所谓central limit theorem,是指,某个random variable,如果它被定义为很多独立且同分布(同分布也就意味
着期望和方差相同)的random variable的平均值,那么这个random variable大体上满足正态分布
</p>
<pre class="example" id="org3048a2c">
Central Limit Theorem is a random variable, which is defined as the average of a
large number of independent and identically distributed random variables , is itself
approximately normally distributed.
</pre></li>
<li>我们可以把上面的定义翻译一下:
<ul class="org-ul">
<li>有n个random variable,分别是 \(x_1 \cdot\cdot\cdot x_n\)</li>
<li>这个n个random variable的平均值都是 \(\mu\) , 标准方差都是 \(\sigma\)(因为他们是同分布的)</li>
<li><p>
如果n非常大的情况下,下面这个random variable满足正态分布(平均值为 \(\mu\), 标准方差为 \(\sigma/\sqrt{n}\) )
</p>
\begin{equation}
\cfrac{1}{n}(x_1 + \cdot\cdot\cdot + x_n)
\end{equation}</li>
<li><p>
换句话说,就是下面的式子满足标准正态分布(平均值0 , 标准方差为1)
</p>
\begin{equation}
\cfrac{(x_1 + \cdot\cdot\cdot + x_n) - \mu n}{\sigma\sqrt{n}}
\end{equation}</li>
</ul></li>
<li>我们使用一个例子来看下中心极限定律:
<ul class="org-ul">
<li><p>
假设我们每个random variable 都是二项式随机变量: 等于1的概率为p, 等于0的概率为1-p,也就是Bernoulli(p)
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">bernoulli_trial</span>(p: <span style="color: #af3a03;">float</span>) -&gt; <span style="color: #af3a03;">int</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Returns 1 with probability p and 0 with probability 1-p"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> 1 <span style="color: #9d0006;">if</span> random.random() &lt; p <span style="color: #9d0006;">else</span> 0
</pre>
</div></li>
<li><p>
这n个random variable的和,我们设计成一个新的random variable: Binomial(n,p)
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">binomial</span>(n: <span style="color: #af3a03;">int</span>, p: <span style="color: #af3a03;">float</span>) -&gt; <span style="color: #af3a03;">int</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Returns the sum of n bernoulli(p) trials"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> <span style="color: #af3a03;">sum</span>(bernoulli_trial(p) <span style="color: #9d0006;">for</span> _ <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">range</span>(n))
</pre>
</div></li>
<li><p>
Bernoulli(p)的平均值(其实就是期望)是
</p>
\begin{equation}
E[X] = \sum_{i=0}^1x_if_X(x) = 0 * (1-p) + 1 * p = p
\end{equation}</li>
<li><p>
Bernoulli(p)的标准差是:
</p>
\begin{equation}
var[X] = \sum_{i=0}^1(x_i - E[X])^2f_X(x) = (0-p)^2(1-p) (1-p)^2p = p(1-p)
\end{equation}</li>
<li>central limit theorem就是说,当n非常大的时候, Binomail(n,p)大体上服从正态分布,是一个normal random
variable,并且其mean是 \(\mu = np\), standard deviation是 \(\sigma = \sqrt{np(1-p)}\)</li>
</ul></li>
<li>下面我们使用python来plot这段描述
<ul class="org-ul">
<li><p>
代码如下
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">import</span> random
<span style="color: #9d0006;">import</span> matplotlib.pyplot <span style="color: #9d0006;">as</span> plt
<span style="color: #9d0006;">import</span> math


<span style="color: #9d0006;">def</span> <span style="color: #b57614;">normal_cdf</span>(x: <span style="color: #af3a03;">float</span>, mu: <span style="color: #af3a03;">float</span> = 0, sigma: <span style="color: #af3a03;">float</span> = 1) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> (1 + math.erf((x - mu) / math.sqrt(2) / sigma)) / 2


<span style="color: #9d0006;">def</span> <span style="color: #b57614;">bernoulli_trial</span>(p: <span style="color: #af3a03;">float</span>) -&gt; <span style="color: #af3a03;">int</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Returns 1 with probability p and 0 with probability 1-p"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> 1 <span style="color: #9d0006;">if</span> random.random() &lt; p <span style="color: #9d0006;">else</span> 0


<span style="color: #9d0006;">def</span> <span style="color: #b57614;">binomial</span>(n: <span style="color: #af3a03;">int</span>, p: <span style="color: #af3a03;">float</span>) -&gt; <span style="color: #af3a03;">int</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Returns the sum of n bernoulli(p) trials"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> <span style="color: #af3a03;">sum</span>(bernoulli_trial(p) <span style="color: #9d0006;">for</span> _ <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">range</span>(n))


<span style="color: #9d0006;">from</span> collections <span style="color: #9d0006;">import</span> Counter


<span style="color: #9d0006;">def</span> <span style="color: #b57614;">binomial_histogram</span>(p: <span style="color: #af3a03;">float</span>, n: <span style="color: #af3a03;">int</span>, num_points: <span style="color: #af3a03;">int</span>) -&gt; <span style="color: #8f3f71;">None</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Picks points from a Binomial(n, p) and plots their histogram"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">data</span> = [binomial(n, p) <span style="color: #9d0006;">for</span> _ <span style="color: #9d0006;">in</span> <span style="color: #af3a03;">range</span>(num_points)]

<span style="background-color: #ebdbb2;"> </span>   <span style="color: #a89984;"># </span><span style="color: #a89984;">use a bar chart to show the actual binomial samples</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">histogram</span> = Counter(data)
<span style="background-color: #ebdbb2;"> </span>   plt.bar(
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   [x - 0.4 <span style="color: #9d0006;">for</span> x <span style="color: #9d0006;">in</span> histogram.keys()],
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   [v / num_points <span style="color: #9d0006;">for</span> v <span style="color: #9d0006;">in</span> histogram.values()],
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   0.8,
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   color=<span style="color: #79740e;">"0.75"</span>,
<span style="background-color: #ebdbb2;"> </span>   )

<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">mu</span> = p * n
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">sigma</span> = math.sqrt(n * p * (1 - p))

<span style="background-color: #ebdbb2;"> </span>   <span style="color: #a89984;"># </span><span style="color: #a89984;">use a line chart to show the normal approximation</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">xs</span> = <span style="color: #af3a03;">range</span>(<span style="color: #af3a03;">min</span>(data), <span style="color: #af3a03;">max</span>(data) + 1)
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">ys</span> = [
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   normal_cdf(i + 0.5, mu, sigma) - normal_cdf(i - 0.5, mu, sigma)
<span style="background-color: #ebdbb2;"> </span>   <span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">for</span> i <span style="color: #9d0006;">in</span> xs
<span style="background-color: #ebdbb2;"> </span>   ]
<span style="background-color: #ebdbb2;"> </span>   plt.plot(xs, ys)
<span style="background-color: #ebdbb2;"> </span>   plt.title(<span style="color: #79740e;">"Binomial Distribution vs. Normal Approximation"</span>)

<span style="background-color: #ebdbb2;"> </span>   plt.show()


<span style="color: #9d0006;">if</span> <span style="color: #af3a03;">__name__</span> == <span style="color: #79740e;">"__main__"</span>:
<span style="background-color: #ebdbb2;"> </span>   binomial_histogram(0.75, 100, 1000)
</pre>
</div></li>
<li><p>
输出如下:
</p>

<div id="org2a9735a" class="figure">
<p><img src="https://raw.githubusercontent.com/harrifeng/image/master/ds/6-4.png" alt="6-4.png" />
</p>
<p><span class="figure-number">Figure 5: </span>ds/6-4.png</p>
</div></li>
</ul></li>
<li>中心极限定律的一个作用是可以简化一些计算:
<ul class="org-ul">
<li>比如有一个正反两面出现概率都是0.5的硬币</li>
<li>你想算这个硬币在100次中,得到60次以上正面,这个event的概率.</li>
<li>最直接的方法是计算Binomial(100,0.5)的CDF,然后求输入0.6,求结果</li>
<li>但是有了中心极限定律以后,你可以计算Normal(50, 5),也就是平均值(期望)为50,标准方差为5的正态分布,
然后取大于60的部分</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orge5a71c8" class="outline-2">
<h2 id="orge5a71c8"><span class="section-number-2">7</span> Chapter 7: Hypothesis and Inference</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-orga4ab9c9" class="outline-3">
<h3 id="orga4ab9c9"><span class="section-number-3">7.1</span> Statistical Hypothesis Testing</h3>
<div class="outline-text-3" id="text-7-1">
<ul class="org-ul">
<li>作为数据工程师,我们很多时候都想去厕所某个hypothesis是否是true</li>
<li>一些常见的hypotheses是一些assertion,比如:
<ul class="org-ul">
<li>这个coin是对称的</li>
<li>相比于R,数据科学家更喜欢Python</li>
<li>如果我们弹窗一个不容易关闭的弹窗,用户更可能关闭这个页面</li>
</ul></li>
<li>上述hypotheses都可以转化为关于data的statistics</li>
<li><p>
在满足某些假设的情况下,这些statistics可以被看做是"从已知分布中,对于random variable的观察"
</p>
<pre class="example" id="orgfbbef01">
Observations of random variables from known distributions
</pre></li>
<li>在传统的setup中,我们会有:
<ul class="org-ul">
<li>一个null hypothesis: H0,代表default position</li>
<li>一些alternative hypothesis: H1,代表我们想用这个去比较和H0比较</li>
</ul></li>
<li>我们使用统计学来决定我们是否要reject H0</li>
</ul>
</div>
</div>
<div id="outline-container-org53961ae" class="outline-3">
<h3 id="org53961ae"><span class="section-number-3">7.2</span> Example: Flipping a Coin</h3>
<div class="outline-text-3" id="text-7-2">
<ul class="org-ul">
<li>假设我们有一个coin,我们想知道这个coin是不是均匀的,而且我们假设coin头朝上的概率是p:
<ul class="org-ul">
<li>那么我们的null hypothesis就是: coin是均匀的(也就是p=0.5)</li>
<li>alternative hypothesis: p 不等于 0.5</li>
</ul></li>
<li>具体来说,我们的test就是要扔硬币非常多次(n次),并且统计正面朝上的次数(H次)</li>
<li>由于扔硬币是一个Bernoulli trial,所以这意味着X就是一个Binomial(n,p)的random vairable(n次抛硬币得
到的总和,正面是1,背面是0)</li>
<li>这也就意味着我们可以使用normal distribution来估计结果</li>
<li><p>
比如我们可以使用如下的代码计算出某个正态分布的平均值和标准差
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">from</span> typing <span style="color: #9d0006;">import</span> Tuple
<span style="color: #9d0006;">import</span> math


<span style="color: #9d0006;">def</span> <span style="color: #b57614;">normal_approximation_to_binomial</span>(n: <span style="color: #af3a03;">int</span>, p: <span style="color: #af3a03;">float</span>) -&gt; Tuple[<span style="color: #af3a03;">float</span>, <span style="color: #af3a03;">float</span>]:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""Returns mu and sigma corresponding to a Binomial(n, p)"""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">mu</span> = p * n
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #076678;">sigma</span> = math.sqrt(p * (1 - p) * n)
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> mu, sigma
</pre>
</div></li>
<li>为了方便后面的求解,我们再设计几个函数,这几个函数计算:对于特定的正态分布,可以算出来在某个区间的概率:
<ul class="org-ul">
<li><p>
低于某个值的概率
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #9d0006;">def</span> <span style="color: #b57614;">normal_cdf</span>(x: <span style="color: #af3a03;">float</span>, mu: <span style="color: #af3a03;">float</span> = 0, sigma: <span style="color: #af3a03;">float</span> = 1) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> (1 + math.erf((x - mu) / math.sqrt(2) / sigma)) / 2


<span style="color: #a89984;"># </span><span style="color: #a89984;">The normal cdf _is_ the probability the variable is below a threshold</span>
<span style="color: #076678;">normal_probability_below</span> = normal_cdf
</pre>
</div></li>
<li><p>
高于某个值的概率
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a89984;"># </span><span style="color: #a89984;">It's above the threshold if it's not below the threshold</span>
<span style="color: #9d0006;">def</span> <span style="color: #b57614;">normal_probability_above</span>(
<span style="background-color: #ebdbb2;"> </span>   lo: <span style="color: #af3a03;">float</span>, mu: <span style="color: #af3a03;">float</span> = 0, sigma: <span style="color: #af3a03;">float</span> = 1
) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""The probability that a N(mu, sigma) is greater than lo."""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> 1 - normal_cdf(lo, mu, sigma)
</pre>
</div></li>
<li><p>
在某个区间的概率
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a89984;"># </span><span style="color: #a89984;">It's between if it's less than hi, but not less than lo.</span>
<span style="color: #9d0006;">def</span> <span style="color: #b57614;">normal_probability_between</span>(
<span style="background-color: #ebdbb2;"> </span>   lo: <span style="color: #af3a03;">float</span>, hi: <span style="color: #af3a03;">float</span>, mu: <span style="color: #af3a03;">float</span> = 0, sigma: <span style="color: #af3a03;">float</span> = 1
) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""The probability that a N(mu, sigma) is between lo and hi."""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> normal_cdf(hi, mu, sigma) - normal_cdf(lo, mu, sigma)
</pre>
</div></li>
<li><p>
在某个区间之外的概率
</p>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a89984;"># </span><span style="color: #a89984;">It's outside if it's not between</span>
<span style="color: #9d0006;">def</span> <span style="color: #b57614;">normal_probability_outside</span>(
<span style="background-color: #ebdbb2;"> </span>   lo: <span style="color: #af3a03;">float</span>, hi: <span style="color: #af3a03;">float</span>, mu: <span style="color: #af3a03;">float</span> = 0, sigma: <span style="color: #af3a03;">float</span> = 1
) -&gt; <span style="color: #af3a03;">float</span>:
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #79740e;">"""The probability that a N(mu, sigma) is not between lo and hi."""</span>
<span style="background-color: #ebdbb2;"> </span>   <span style="color: #9d0006;">return</span> 1 - normal_probability_between(lo, hi, mu, sigma)
</pre>
</div></li>
</ul></li>
<li>当然我们也可以反向操作:知道某个概率,那么看看哪两个区间(low, high)正好对应这个概率
<ul class="org-ul">
<li>比如,我们可能需要知道</li>
</ul></li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: harrifeng@outlook.com</p>
<p class="date">Created: 2021-10-02 Sat 23:53</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
